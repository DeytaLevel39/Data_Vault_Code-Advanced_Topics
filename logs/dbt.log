

============================== 2022-11-04 23:44:39.349014 | c93e7573-d937-4d0a-a097-d82008157639 ==============================
[0m23:44:39.349014 [info ] [MainThread]: Running with dbt=1.2.2
[0m23:44:39.349014 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m23:44:39.349014 [debug] [MainThread]: Tracking: tracking
[0m23:44:39.349014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1151DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1151D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1151D790>]}
[0m23:44:39.364643 [debug] [MainThread]: Set downloads directory='C:\Users\james\AppData\Local\Temp\dbt-downloads-q_wnryxl'
[0m23:44:39.364643 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:44:39.604835 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:44:39.604835 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
[0m23:44:39.775891 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
[0m23:44:39.791521 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:44:39.993700 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:44:40.171881 [info ] [MainThread]: Installing Datavault-UK/dbtvault
[0m23:44:40.985366 [info ] [MainThread]:   Installed from version 0.9.0
[0m23:44:40.985366 [info ] [MainThread]:   Up to date!
[0m23:44:40.985366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c93e7573-d937-4d0a-a097-d82008157639', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1151D8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1151D8E0>]}
[0m23:44:40.985366 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:44:42.572433 [info ] [MainThread]:   Installed from version 0.8.6
[0m23:44:42.588066 [info ] [MainThread]:   Updated version available: 0.9.2
[0m23:44:42.588066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c93e7573-d937-4d0a-a097-d82008157639', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1151D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1173FFA0>]}
[0m23:44:42.588066 [info ] [MainThread]: 
[0m23:44:42.588066 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:44:42.588066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC114B67C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC11733E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC117332B0>]}
[0m23:44:42.588066 [debug] [MainThread]: Flushing usage events


============================== 2022-11-04 23:45:34.295821 | a6520b34-fc75-418a-a317-4e47e8910616 ==============================
[0m23:45:34.295821 [info ] [MainThread]: Running with dbt=1.2.2
[0m23:45:34.295821 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m23:45:34.295821 [debug] [MainThread]: Tracking: tracking
[0m23:45:34.295821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021632E9F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021632E9F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021632E9F4F0>]}
[0m23:45:34.295821 [debug] [MainThread]: Set downloads directory='C:\Users\james\AppData\Local\Temp\dbt-downloads-yzwlpg50'
[0m23:45:34.295821 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:45:34.545895 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:45:34.545895 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json
[0m23:45:34.686561 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/dbtvault.json 200
[0m23:45:34.686561 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:45:34.952268 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:45:35.030416 [info ] [MainThread]: Installing Datavault-UK/dbtvault
[0m23:45:35.561826 [info ] [MainThread]:   Installed from version 0.9.0
[0m23:45:35.561826 [info ] [MainThread]:   Up to date!
[0m23:45:35.561826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a6520b34-fc75-418a-a317-4e47e8910616', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021632F13C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021632EBD460>]}
[0m23:45:35.561826 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:45:36.577759 [info ] [MainThread]:   Installed from version 0.8.6
[0m23:45:36.593389 [info ] [MainThread]:   Updated version available: 0.9.2
[0m23:45:36.593389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a6520b34-fc75-418a-a317-4e47e8910616', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021632EBD190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021632EBDE20>]}
[0m23:45:36.593389 [info ] [MainThread]: 
[0m23:45:36.593389 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:45:36.593389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002162D0A7F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021632EA46A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021632F13850>]}
[0m23:45:36.593389 [debug] [MainThread]: Flushing usage events


============================== 2022-11-04 23:47:00.651657 | 2fc88097-4f85-4cd9-ab16-e52de3a49725 ==============================
[0m23:47:00.651657 [info ] [MainThread]: Running with dbt=1.2.2
[0m23:47:00.651657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m23:47:00.651657 [debug] [MainThread]: Tracking: tracking
[0m23:47:00.651657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE8B1A4670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE8B1A4AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE8B1A4E50>]}
[0m23:47:00.667285 [debug] [MainThread]: Set downloads directory='C:\Users\james\AppData\Local\Temp\dbt-downloads-u0ip_0r5'
[0m23:47:00.667285 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/deytalytics/dbtvault.git d7a71488cd3f6476c9db65c48f4d05ba"
[0m23:47:01.964556 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:01.964556 [debug] [MainThread]: STDERR: "b"Cloning into 'd7a71488cd3f6476c9db65c48f4d05ba'...\n""
[0m23:47:01.964556 [debug] [MainThread]: Pulling new dependency d7a71488cd3f6476c9db65c48f4d05ba.
[0m23:47:01.964556 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:01.995815 [debug] [MainThread]: STDOUT: "b'62ff4f62ffb03cecaee57f8ce7fa46858d37ddf4\n'"
[0m23:47:01.995815 [debug] [MainThread]: STDERR: "b''"
[0m23:47:01.995815 [debug] [MainThread]:   Checking out revision HEAD.
[0m23:47:01.995815 [debug] [MainThread]: Executing "git remote set-branches origin HEAD"
[0m23:47:02.042703 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:02.042703 [debug] [MainThread]: STDERR: "b''"
[0m23:47:02.042703 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags HEAD"
[0m23:47:02.886710 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:02.886710 [debug] [MainThread]: STDERR: "b'From https://github.com/deytalytics/dbtvault\n * branch            HEAD       -> FETCH_HEAD\n'"
[0m23:47:02.886710 [debug] [MainThread]: Executing "git tag --list"
[0m23:47:02.933600 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:02.933600 [debug] [MainThread]: STDERR: "b''"
[0m23:47:02.933600 [debug] [MainThread]: Executing "git reset --hard origin/HEAD"
[0m23:47:03.027377 [debug] [MainThread]: STDOUT: "b'HEAD is now at 62ff4f6 Completed the build of the raw data vault\n'"
[0m23:47:03.027377 [debug] [MainThread]: STDERR: "b''"
[0m23:47:03.027377 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:03.058638 [debug] [MainThread]: STDOUT: "b'62ff4f62ffb03cecaee57f8ce7fa46858d37ddf4\n'"
[0m23:47:03.058638 [debug] [MainThread]: STDERR: "b''"
[0m23:47:03.058638 [debug] [MainThread]:   Checked out at 62ff4f6.
[0m23:47:03.058638 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/deytalytics/dbtvault.git" 
	is not pinned, using HEAD (default branch).
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m23:47:03.089897 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m23:47:04.309016 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:04.309016 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m23:47:04.309016 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m23:47:04.309016 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:04.340275 [debug] [MainThread]: STDOUT: "b'6a5dd1eb97700301eaeba14c23c3682ceac9fb2b\n'"
[0m23:47:04.340275 [debug] [MainThread]: STDERR: "b''"
[0m23:47:04.340275 [debug] [MainThread]:   Checking out revision HEAD.
[0m23:47:04.340275 [debug] [MainThread]: Executing "git remote set-branches origin HEAD"
[0m23:47:04.387165 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:04.387165 [debug] [MainThread]: STDERR: "b''"
[0m23:47:04.387165 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags HEAD"
[0m23:47:05.856363 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:05.856363 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            HEAD       -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n'"
[0m23:47:05.856363 [debug] [MainThread]: Executing "git tag --list"
[0m23:47:05.918879 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n1.0.0-b1\n1.0.0-b2\n'"
[0m23:47:05.918879 [debug] [MainThread]: STDERR: "b''"
[0m23:47:05.918879 [debug] [MainThread]: Executing "git reset --hard origin/HEAD"
[0m23:47:06.028288 [debug] [MainThread]: STDOUT: "b'HEAD is now at 6a5dd1e Revert "Feature/safe divide (#697)" (#702)\n'"
[0m23:47:06.028288 [debug] [MainThread]: STDERR: "b''"
[0m23:47:06.043918 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:06.075176 [debug] [MainThread]: STDOUT: "b'6a5dd1eb97700301eaeba14c23c3682ceac9fb2b\n'"
[0m23:47:06.075176 [debug] [MainThread]: STDERR: "b''"
[0m23:47:06.075176 [debug] [MainThread]:   Checked out at 6a5dd1e.
[0m23:47:06.075176 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/dbt-labs/dbt-utils.git" 
	is not pinned, using HEAD (default branch).
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m23:47:06.090809 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/deytalytics/dbtvault.git d7a71488cd3f6476c9db65c48f4d05ba"
[0m23:47:06.122067 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:06.122067 [debug] [MainThread]: STDERR: "b"fatal: destination path 'd7a71488cd3f6476c9db65c48f4d05ba' already exists and is not an empty directory.\n""
[0m23:47:06.122067 [debug] [MainThread]: command return code=128
[0m23:47:06.122067 [debug] [MainThread]: Updating existing dependency d7a71488cd3f6476c9db65c48f4d05ba.
[0m23:47:06.122067 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:06.168956 [debug] [MainThread]: STDOUT: "b'62ff4f62ffb03cecaee57f8ce7fa46858d37ddf4\n'"
[0m23:47:06.168956 [debug] [MainThread]: STDERR: "b''"
[0m23:47:06.168956 [debug] [MainThread]:   Checking out revision HEAD.
[0m23:47:06.168956 [debug] [MainThread]: Executing "git remote set-branches origin HEAD"
[0m23:47:06.200218 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:06.200218 [debug] [MainThread]: STDERR: "b''"
[0m23:47:06.200218 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags HEAD"
[0m23:47:07.075481 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:07.075481 [debug] [MainThread]: STDERR: "b'From https://github.com/deytalytics/dbtvault\n * branch            HEAD       -> FETCH_HEAD\n'"
[0m23:47:07.075481 [debug] [MainThread]: Executing "git tag --list"
[0m23:47:07.122371 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:07.122371 [debug] [MainThread]: STDERR: "b''"
[0m23:47:07.122371 [debug] [MainThread]: Executing "git reset --hard origin/HEAD"
[0m23:47:07.184892 [debug] [MainThread]: STDOUT: "b'HEAD is now at 62ff4f6 Completed the build of the raw data vault\n'"
[0m23:47:07.184892 [debug] [MainThread]: STDERR: "b''"
[0m23:47:07.184892 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:07.216152 [debug] [MainThread]: STDOUT: "b'62ff4f62ffb03cecaee57f8ce7fa46858d37ddf4\n'"
[0m23:47:07.216152 [debug] [MainThread]: STDERR: "b''"
[0m23:47:07.216152 [debug] [MainThread]: Already at 62ff4f6, nothing to do.
[0m23:47:07.216152 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/deytalytics/dbtvault.git" 
	is not pinned, using HEAD (default branch).
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m23:47:07.231780 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m23:47:07.284859 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:07.284859 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m23:47:07.284859 [debug] [MainThread]: command return code=128
[0m23:47:07.284859 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m23:47:07.284859 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:07.331747 [debug] [MainThread]: STDOUT: "b'6a5dd1eb97700301eaeba14c23c3682ceac9fb2b\n'"
[0m23:47:07.331747 [debug] [MainThread]: STDERR: "b''"
[0m23:47:07.331747 [debug] [MainThread]:   Checking out revision HEAD.
[0m23:47:07.331747 [debug] [MainThread]: Executing "git remote set-branches origin HEAD"
[0m23:47:07.378638 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:07.378638 [debug] [MainThread]: STDERR: "b''"
[0m23:47:07.378638 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags HEAD"
[0m23:47:08.316420 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:08.316420 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            HEAD       -> FETCH_HEAD\n'"
[0m23:47:08.316420 [debug] [MainThread]: Executing "git tag --list"
[0m23:47:08.363312 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n1.0.0-b1\n1.0.0-b2\n'"
[0m23:47:08.363312 [debug] [MainThread]: STDERR: "b''"
[0m23:47:08.363312 [debug] [MainThread]: Executing "git reset --hard origin/HEAD"
[0m23:47:08.425832 [debug] [MainThread]: STDOUT: "b'HEAD is now at 6a5dd1e Revert "Feature/safe divide (#697)" (#702)\n'"
[0m23:47:08.425832 [debug] [MainThread]: STDERR: "b''"
[0m23:47:08.441461 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:08.472719 [debug] [MainThread]: STDOUT: "b'6a5dd1eb97700301eaeba14c23c3682ceac9fb2b\n'"
[0m23:47:08.472719 [debug] [MainThread]: STDERR: "b''"
[0m23:47:08.472719 [debug] [MainThread]: Already at 6a5dd1e, nothing to do.
[0m23:47:08.472719 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/dbt-labs/dbt-utils.git" 
	is not pinned, using HEAD (default branch).
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m23:47:08.472719 [info ] [MainThread]: Installing https://github.com/deytalytics/dbtvault.git
[0m23:47:08.503979 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/deytalytics/dbtvault.git d7a71488cd3f6476c9db65c48f4d05ba"
[0m23:47:08.550869 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:08.550869 [debug] [MainThread]: STDERR: "b"fatal: destination path 'd7a71488cd3f6476c9db65c48f4d05ba' already exists and is not an empty directory.\n""
[0m23:47:08.550869 [debug] [MainThread]: command return code=128
[0m23:47:08.550869 [debug] [MainThread]: Updating existing dependency d7a71488cd3f6476c9db65c48f4d05ba.
[0m23:47:08.550869 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:08.582128 [debug] [MainThread]: STDOUT: "b'62ff4f62ffb03cecaee57f8ce7fa46858d37ddf4\n'"
[0m23:47:08.582128 [debug] [MainThread]: STDERR: "b''"
[0m23:47:08.582128 [debug] [MainThread]:   Checking out revision HEAD.
[0m23:47:08.582128 [debug] [MainThread]: Executing "git remote set-branches origin HEAD"
[0m23:47:08.629018 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:08.629018 [debug] [MainThread]: STDERR: "b''"
[0m23:47:08.629018 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags HEAD"
[0m23:47:09.535543 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:09.535543 [debug] [MainThread]: STDERR: "b'From https://github.com/deytalytics/dbtvault\n * branch            HEAD       -> FETCH_HEAD\n'"
[0m23:47:09.535543 [debug] [MainThread]: Executing "git tag --list"
[0m23:47:09.582433 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:09.582433 [debug] [MainThread]: STDERR: "b''"
[0m23:47:09.582433 [debug] [MainThread]: Executing "git reset --hard origin/HEAD"
[0m23:47:09.644951 [debug] [MainThread]: STDOUT: "b'HEAD is now at 62ff4f6 Completed the build of the raw data vault\n'"
[0m23:47:09.644951 [debug] [MainThread]: STDERR: "b''"
[0m23:47:09.644951 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:09.676208 [debug] [MainThread]: STDOUT: "b'62ff4f62ffb03cecaee57f8ce7fa46858d37ddf4\n'"
[0m23:47:09.676208 [debug] [MainThread]: STDERR: "b''"
[0m23:47:09.676208 [debug] [MainThread]: Already at 62ff4f6, nothing to do.
[0m23:47:09.691840 [info ] [MainThread]:   Installed from HEAD (default revision)
[0m23:47:09.691840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2fc88097-4f85-4cd9-ab16-e52de3a49725', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE88C063D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE88C06D60>]}
[0m23:47:09.691840 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m23:47:09.801251 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m23:47:09.848137 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:09.848137 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m23:47:09.848137 [debug] [MainThread]: command return code=128
[0m23:47:09.848137 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m23:47:09.848137 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:09.879398 [debug] [MainThread]: STDOUT: "b'6a5dd1eb97700301eaeba14c23c3682ceac9fb2b\n'"
[0m23:47:09.879398 [debug] [MainThread]: STDERR: "b''"
[0m23:47:09.879398 [debug] [MainThread]:   Checking out revision HEAD.
[0m23:47:09.879398 [debug] [MainThread]: Executing "git remote set-branches origin HEAD"
[0m23:47:09.926284 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:09.926284 [debug] [MainThread]: STDERR: "b''"
[0m23:47:09.926284 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags HEAD"
[0m23:47:10.785921 [debug] [MainThread]: STDOUT: "b''"
[0m23:47:10.785921 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            HEAD       -> FETCH_HEAD\n'"
[0m23:47:10.785921 [debug] [MainThread]: Executing "git tag --list"
[0m23:47:10.848441 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n1.0.0-b1\n1.0.0-b2\n'"
[0m23:47:10.848441 [debug] [MainThread]: STDERR: "b''"
[0m23:47:10.848441 [debug] [MainThread]: Executing "git reset --hard origin/HEAD"
[0m23:47:10.910960 [debug] [MainThread]: STDOUT: "b'HEAD is now at 6a5dd1e Revert "Feature/safe divide (#697)" (#702)\n'"
[0m23:47:10.910960 [debug] [MainThread]: STDERR: "b''"
[0m23:47:10.910960 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:47:10.957850 [debug] [MainThread]: STDOUT: "b'6a5dd1eb97700301eaeba14c23c3682ceac9fb2b\n'"
[0m23:47:10.957850 [debug] [MainThread]: STDERR: "b''"
[0m23:47:10.957850 [debug] [MainThread]: Already at 6a5dd1e, nothing to do.
[0m23:47:10.957850 [info ] [MainThread]:   Installed from HEAD (default revision)
[0m23:47:10.957850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2fc88097-4f85-4cd9-ab16-e52de3a49725', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE88BE5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE88BE5B80>]}
[0m23:47:10.957850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE8B1A4A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE88BE5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE88BE5B20>]}
[0m23:47:10.957850 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 07:31:25.521604 | 755505ee-563d-408b-bd4a-f1857f17b378 ==============================
[0m07:31:25.521604 [info ] [MainThread]: Running with dbt=1.2.2
[0m07:31:25.522974 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:31:25.522974 [debug] [MainThread]: Tracking: tracking
[0m07:31:25.524806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E284C910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E284CC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E284CFA0>]}
[0m07:31:25.618918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E283B580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E283B9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2E283BBB0>]}
[0m07:31:25.618918 [debug] [MainThread]: Flushing usage events
[0m07:31:26.324057 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =1.2.2
      Required version of dbt for 'dbt_utils': ['>=1.3.0-rc1', '<2.0.0']
    Check for a different version of the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\dbt_packages\dbt_utils\dbt_project.yml

Error encountered in C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\dbt_packages\dbt_utils
[0m07:31:26.394064 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\config\runtime.py", line 354, in load_projects
    project = self.new_project(str(path))
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\config\runtime.py", line 140, in new_project
    project = Project.from_project_root(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\config\project.py", line 653, in from_project_root
    return partial.render(renderer)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\config\project.py", line 286, in render
    return self.create_project(rendered)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\config\project.py", line 316, in create_project
    dbt_version = _get_required_version(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\config\project.py", line 231, in _get_required_version
    validate_version(dbt_version, project_dict["name"])
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\config\project.py", line 208, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =1.2.2
    Required version of dbt for 'dbt_utils': ['>=1.3.0-rc1', '<2.0.0']
  Check for a different version of the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\dbt_packages\dbt_utils\dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 131, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 193, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 240, in run_from_args
    results = task.run()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 451, in run
    self._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 216, in get_full_manifest
    projects = config.load_dependencies()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\config\runtime.py", line 335, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\config\runtime.py", line 356, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =1.2.2
      Required version of dbt for 'dbt_utils': ['>=1.3.0-rc1', '<2.0.0']
    Check for a different version of the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\dbt_packages\dbt_utils\dbt_project.yml

Error encountered in C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\dbt_packages\dbt_utils



============================== 2022-11-05 07:31:48.786185 | 879bbbc5-4382-4396-b8e8-d1af05040066 ==============================
[0m07:31:48.786185 [info ] [MainThread]: Running with dbt=1.2.2
[0m07:31:48.787186 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:31:48.787186 [debug] [MainThread]: Tracking: tracking
[0m07:31:48.788185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C8434640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C8434910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C8434A90>]}
[0m07:31:48.829809 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m07:31:48.830808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '879bbbc5-4382-4396-b8e8-d1af05040066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C845E760>]}
[0m07:31:50.406232 [debug] [MainThread]: Parsing macros\adapters.sql
[0m07:31:50.437233 [debug] [MainThread]: Parsing macros\catalog.sql
[0m07:31:50.444234 [debug] [MainThread]: Parsing macros\etc.sql
[0m07:31:50.446234 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m07:31:50.449236 [debug] [MainThread]: Parsing macros\materializations\copy.sql
[0m07:31:50.453234 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m07:31:50.473235 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m07:31:50.476236 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m07:31:50.478237 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m07:31:50.483236 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m07:31:50.487236 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m07:31:50.487236 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m07:31:50.488236 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m07:31:50.489237 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m07:31:50.490237 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m07:31:50.491237 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m07:31:50.491237 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m07:31:50.491237 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m07:31:50.492237 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m07:31:50.493237 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m07:31:50.494237 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m07:31:50.494237 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m07:31:50.495237 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m07:31:50.496237 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m07:31:50.514239 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m07:31:50.526239 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m07:31:50.530240 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m07:31:50.534241 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m07:31:50.543240 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m07:31:50.549243 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m07:31:50.569242 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m07:31:50.573242 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m07:31:50.583246 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m07:31:50.588244 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m07:31:50.590246 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m07:31:50.591245 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m07:31:50.592245 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m07:31:50.593244 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m07:31:50.595244 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m07:31:50.596245 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m07:31:50.600245 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m07:31:50.603245 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m07:31:50.607245 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m07:31:50.612246 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m07:31:50.623652 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m07:31:50.625652 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m07:31:50.643654 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m07:31:50.660655 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m07:31:50.664655 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m07:31:50.670656 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m07:31:50.674656 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m07:31:50.677658 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m07:31:50.678656 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m07:31:50.685657 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m07:31:50.706659 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m07:31:50.714659 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m07:31:50.728660 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m07:31:50.742661 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m07:31:50.744661 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m07:31:50.764662 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m07:31:50.766664 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m07:31:50.771663 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m07:31:50.774664 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m07:31:50.775664 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m07:31:50.776664 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m07:31:50.777664 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m07:31:50.778664 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m07:31:50.785665 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m07:31:50.786665 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m07:31:50.788665 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m07:31:50.789666 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m07:31:50.790665 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m07:31:50.791664 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m07:31:50.793665 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m07:31:50.794665 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m07:31:50.796665 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m07:31:50.797665 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m07:31:50.800665 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m07:31:50.801666 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m07:31:50.803665 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m07:31:50.804666 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m07:31:50.805668 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m07:31:50.807666 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m07:31:50.809666 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m07:31:50.812666 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m07:31:50.819667 [debug] [MainThread]: Parsing macros\internal\helpers\logging.sql
[0m07:31:50.822667 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m07:31:50.822667 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m07:31:50.840668 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m07:31:50.844669 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m07:31:50.847668 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m07:31:50.850669 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m07:31:50.852670 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m07:31:50.855670 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m07:31:50.871671 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m07:31:50.875671 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m07:31:50.881673 [debug] [MainThread]: Parsing macros\internal\metadata_processing\process_payload_column_excludes.sql
[0m07:31:50.886672 [debug] [MainThread]: Parsing macros\materialisations\drop_temporary.sql
[0m07:31:50.888672 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m07:31:50.894673 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m07:31:50.897673 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m07:31:50.909673 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m07:31:50.918674 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m07:31:50.920675 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m07:31:50.958677 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m07:31:50.987948 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m07:31:51.010950 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m07:31:51.023951 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m07:31:51.031955 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m07:31:51.037952 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m07:31:51.048955 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m07:31:51.052953 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m07:31:51.057954 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m07:31:51.070954 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m07:31:51.075955 [debug] [MainThread]: Parsing macros\staging\null_columns.sql
[0m07:31:51.090956 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m07:31:51.101957 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m07:31:51.102957 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m07:31:51.119957 [debug] [MainThread]: Parsing macros\supporting\as_of_date_window.sql
[0m07:31:51.126959 [debug] [MainThread]: Parsing macros\supporting\bridge_shared.sql
[0m07:31:51.138959 [debug] [MainThread]: Parsing macros\supporting\cast_binary.sql
[0m07:31:51.141960 [debug] [MainThread]: Parsing macros\supporting\cast_date.sql
[0m07:31:51.151961 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m07:31:51.153961 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m07:31:51.159960 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m07:31:51.162960 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m07:31:51.257968 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m07:31:51.260968 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m07:31:51.266970 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m07:31:51.268969 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m07:31:51.285971 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m07:31:51.296971 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m07:31:51.309972 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m07:31:51.324973 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m07:31:51.346975 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m07:31:51.347974 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m07:31:51.349975 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m07:31:51.350975 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
[0m07:31:51.351975 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
[0m07:31:51.352976 [debug] [MainThread]: Parsing macros\tables\databricks\sat.sql
[0m07:31:51.353976 [debug] [MainThread]: Parsing macros\tables\postgres\hub.sql
[0m07:31:51.364977 [debug] [MainThread]: Parsing macros\tables\postgres\link.sql
[0m07:31:51.378977 [debug] [MainThread]: Parsing macros\tables\postgres\sat.sql
[0m07:31:51.388978 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m07:31:51.401979 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m07:31:51.424981 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m07:31:51.440982 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m07:31:51.458984 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m07:31:51.477985 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m07:31:51.508986 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m07:31:51.524988 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m07:31:51.535988 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m07:31:51.555990 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m07:31:51.556990 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m07:31:51.574991 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m07:31:51.589992 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m07:31:51.604993 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m07:31:51.621994 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m07:31:51.622995 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m07:31:51.624994 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m07:31:51.625995 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m07:31:51.626995 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\xdb_deprecation_warning.sql
[0m07:31:51.627995 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m07:31:51.630995 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m07:31:51.633996 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m07:31:51.636995 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m07:31:51.640996 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m07:31:51.646996 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m07:31:51.649997 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m07:31:51.654997 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m07:31:51.666997 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m07:31:51.669998 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m07:31:51.672998 [debug] [MainThread]: Parsing macros\generic_tests\not_empty_string.sql
[0m07:31:51.674998 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m07:31:51.678998 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m07:31:51.683000 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m07:31:51.685999 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m07:31:51.690999 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m07:31:51.694000 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m07:31:51.696000 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m07:31:51.697000 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m07:31:51.699001 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m07:31:51.700001 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_ephemeral.sql
[0m07:31:51.703000 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_relation.sql
[0m07:31:51.704001 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m07:31:51.710001 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m07:31:51.715004 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m07:31:51.720002 [debug] [MainThread]: Parsing macros\sql\generate_surrogate_key.sql
[0m07:31:51.723002 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m07:31:51.731002 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m07:31:51.735003 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m07:31:51.738003 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m07:31:51.742003 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m07:31:51.746005 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m07:31:51.755004 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m07:31:51.757004 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m07:31:51.759004 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m07:31:51.761005 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m07:31:51.769650 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m07:31:51.771650 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m07:31:51.773650 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m07:31:51.778651 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m07:31:51.781653 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m07:31:51.787651 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m07:31:51.788652 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m07:31:51.805652 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m07:31:51.813653 [debug] [MainThread]: Parsing macros\sql\width_bucket.sql
[0m07:31:51.819654 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m07:31:51.821654 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m07:31:51.823654 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m07:31:52.814381 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m07:31:52.830382 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m07:31:52.834383 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m07:31:52.838384 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m07:31:52.844383 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m07:31:52.848385 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_order.sql
[0m07:31:52.853384 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m07:31:52.857384 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m07:31:52.861416 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m07:31:52.995466 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m07:31:52.997466 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m07:31:53.013468 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m07:31:53.015471 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m07:31:53.032471 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m07:31:53.034469 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m07:31:53.078472 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m07:31:53.080473 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m07:31:53.098476 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m07:31:53.100474 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m07:31:53.176480 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m07:31:53.177480 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order.sql
[0m07:31:53.208483 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order.sql
[0m07:31:53.210483 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m07:31:53.246489 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m07:31:53.248488 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m07:31:53.281489 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m07:31:53.283490 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m07:31:53.441154 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m07:31:53.443157 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_order.sql
[0m07:31:53.506159 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_order.sql
[0m07:31:53.507162 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m07:31:53.583362 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m07:31:53.585362 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m07:31:53.638366 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m07:31:53.871754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '879bbbc5-4382-4396-b8e8-d1af05040066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C87DA1F0>]}
[0m07:31:53.892867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '879bbbc5-4382-4396-b8e8-d1af05040066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C8896790>]}
[0m07:31:53.893866 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m07:31:53.893866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '879bbbc5-4382-4396-b8e8-d1af05040066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C842E850>]}
[0m07:31:53.896782 [info ] [MainThread]: 
[0m07:31:53.897781 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:31:53.900780 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m07:31:53.900780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:53.957700 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m07:31:53.958701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:53.958701 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m07:31:53.958701 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m07:31:53.960702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C87DA0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C8725370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9C8725DF0>]}
[0m07:31:53.960702 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 07:35:47.693673 | e20db58d-02a8-4e27-b1fe-3d6f389e0a78 ==============================
[0m07:35:47.693673 [info ] [MainThread]: Running with dbt=1.2.2
[0m07:35:47.693673 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:35:47.693673 [debug] [MainThread]: Tracking: tracking
[0m07:35:47.693673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794FAEEBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794FAEE610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794FAEE250>]}
[0m07:35:48.037526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:35:48.037526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:35:48.053154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e20db58d-02a8-4e27-b1fe-3d6f389e0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794FDD90D0>]}
[0m07:35:48.115677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e20db58d-02a8-4e27-b1fe-3d6f389e0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794FA26AF0>]}
[0m07:35:48.115677 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m07:35:48.115677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e20db58d-02a8-4e27-b1fe-3d6f389e0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794FA26850>]}
[0m07:35:48.115677 [info ] [MainThread]: 
[0m07:35:48.115677 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:35:48.131302 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m07:35:48.131302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:48.131302 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m07:35:48.131302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:35:48.131302 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m07:35:48.131302 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m07:35:48.131302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794F9E2D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794FA77FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794FA89CD0>]}
[0m07:35:48.131302 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 07:51:16.484697 | 860b93c3-ac67-4ea5-9652-1527db73f3ea ==============================
[0m07:51:16.484697 [info ] [MainThread]: Running with dbt=1.2.2
[0m07:51:16.485697 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:51:16.485697 [debug] [MainThread]: Tracking: tracking
[0m07:51:16.487129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B0A4B7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B0A4BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B0A4BF40>]}
[0m07:51:16.834588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:51:16.834588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:51:16.842588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '860b93c3-ac67-4ea5-9652-1527db73f3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B0D290A0>]}
[0m07:51:16.912594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '860b93c3-ac67-4ea5-9652-1527db73f3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B0976E20>]}
[0m07:51:16.912594 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m07:51:16.913594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '860b93c3-ac67-4ea5-9652-1527db73f3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B0976B80>]}
[0m07:51:16.916595 [info ] [MainThread]: 
[0m07:51:16.918602 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:51:16.922597 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m07:51:16.923598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:16.931525 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m07:51:16.932524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:51:16.932524 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m07:51:16.933524 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m07:51:16.935527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B0932EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B09D9D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264B09D9FD0>]}
[0m07:51:16.935527 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 07:51:59.159844 | f4b5ccb0-ce45-4580-a029-2c887df4fcb0 ==============================
[0m07:51:59.159844 [info ] [MainThread]: Running with dbt=1.2.2
[0m07:51:59.159844 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:51:59.160845 [debug] [MainThread]: Tracking: tracking
[0m07:51:59.161844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2D5DA190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2D5DA2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2D5DAF40>]}
[0m07:51:59.490573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:51:59.490573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:51:59.499575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4b5ccb0-ce45-4580-a029-2c887df4fcb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2D8D1EB0>]}
[0m07:51:59.576582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4b5ccb0-ce45-4580-a029-2c887df4fcb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2D516F40>]}
[0m07:51:59.576582 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m07:51:59.577580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4b5ccb0-ce45-4580-a029-2c887df4fcb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2D516CA0>]}
[0m07:51:59.581584 [info ] [MainThread]: 
[0m07:51:59.582585 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:51:59.586584 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m07:51:59.587582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:59.594581 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m07:51:59.595582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:51:59.596581 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m07:51:59.596581 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m07:51:59.598581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2D4E9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2D5816D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA2D581130>]}
[0m07:51:59.599583 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 07:53:05.205546 | 402b7a70-b5a0-4b52-9fc1-27dff637c240 ==============================
[0m07:53:05.205546 [info ] [MainThread]: Running with dbt=1.2.2
[0m07:53:05.206548 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:53:05.207549 [debug] [MainThread]: Tracking: tracking
[0m07:53:05.207549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC817ABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC817AFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC817ABE0>]}
[0m07:53:05.510859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:53:05.510859 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:53:05.518859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '402b7a70-b5a0-4b52-9fc1-27dff637c240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC845A0D0>]}
[0m07:53:05.587866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '402b7a70-b5a0-4b52-9fc1-27dff637c240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC80A6C40>]}
[0m07:53:05.588865 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m07:53:05.588865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '402b7a70-b5a0-4b52-9fc1-27dff637c240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC80A69A0>]}
[0m07:53:05.592867 [info ] [MainThread]: 
[0m07:53:05.593867 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:53:05.597872 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m07:53:05.597872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:05.604868 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m07:53:05.605869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:05.606867 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m07:53:05.606867 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m07:53:05.608866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC8064E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC81106D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEC8110220>]}
[0m07:53:05.608866 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 07:53:42.584173 | f4eea0e7-2fba-49e2-a4c0-135f6f3cb93f ==============================
[0m07:53:42.584173 [info ] [MainThread]: Running with dbt=1.2.2
[0m07:53:42.585174 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:53:42.586175 [debug] [MainThread]: Tracking: tracking
[0m07:53:42.587174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B953491C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B95349730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B95349520>]}
[0m07:53:42.888198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:53:42.888198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:53:42.897198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4eea0e7-2fba-49e2-a4c0-135f6f3cb93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B9562A0D0>]}
[0m07:53:42.969204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4eea0e7-2fba-49e2-a4c0-135f6f3cb93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B95277790>]}
[0m07:53:42.969204 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m07:53:42.970206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4eea0e7-2fba-49e2-a4c0-135f6f3cb93f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B952774F0>]}
[0m07:53:42.972204 [info ] [MainThread]: 
[0m07:53:42.973206 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:53:42.977206 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m07:53:42.977206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:42.985206 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m07:53:42.986204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:42.986204 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m07:53:42.986204 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m07:53:42.987204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B952359A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B952E04F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B952E03D0>]}
[0m07:53:42.988205 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 07:57:25.736433 | a4f81e19-137c-4298-8983-f431b5782619 ==============================
[0m07:57:25.736433 [info ] [MainThread]: Running with dbt=1.2.2
[0m07:57:25.737431 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:57:25.737431 [debug] [MainThread]: Tracking: tracking
[0m07:57:25.738433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AD88EB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AD88E8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AD88E910>]}
[0m07:57:26.058824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:57:26.058824 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:57:26.066825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4f81e19-137c-4298-8983-f431b5782619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182ADB7B0A0>]}
[0m07:57:26.136834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4f81e19-137c-4298-8983-f431b5782619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AD7C7E80>]}
[0m07:57:26.136834 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m07:57:26.137832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4f81e19-137c-4298-8983-f431b5782619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AD7C7BE0>]}
[0m07:57:26.140830 [info ] [MainThread]: 
[0m07:57:26.141830 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:57:26.144831 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m07:57:26.145830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:57:26.153831 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m07:57:26.154830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:57:26.154830 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m07:57:26.155832 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m07:57:26.156832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AD7991F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AD8290A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182AD829C10>]}
[0m07:57:26.157832 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 07:58:09.524781 | dd36d193-7816-4507-a7e5-bb63a718d99e ==============================
[0m07:58:09.524781 [info ] [MainThread]: Running with dbt=1.2.2
[0m07:58:09.525781 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:58:09.525781 [debug] [MainThread]: Tracking: tracking
[0m07:58:09.526783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D58A62DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D58A62DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D58A62D580>]}
[0m07:58:09.832122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:58:09.832122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:58:09.841123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd36d193-7816-4507-a7e5-bb63a718d99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D58A920F10>]}
[0m07:58:09.909522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd36d193-7816-4507-a7e5-bb63a718d99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D58A56F100>]}
[0m07:58:09.909522 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m07:58:09.910523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd36d193-7816-4507-a7e5-bb63a718d99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D58A565E20>]}
[0m07:58:09.913523 [info ] [MainThread]: 
[0m07:58:09.913523 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m07:58:09.917528 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m07:58:09.917528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:58:09.923527 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m07:58:09.924526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:58:09.925526 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m07:58:09.925526 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m07:58:09.926523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D58A536310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D58A5C75B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D58A5C7E20>]}
[0m07:58:09.926523 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:02:29.692679 | 60b16829-47f5-4a86-9aa4-4cb8fcf5ff43 ==============================
[0m08:02:29.692679 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:02:29.693679 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:02:29.693679 [debug] [MainThread]: Tracking: tracking
[0m08:02:29.694680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2796DA0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2796DA160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2796DA0A0>]}
[0m08:02:29.843689 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:02:29.844691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60b16829-47f5-4a86-9aa4-4cb8fcf5ff43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C279728EE0>]}
[0m08:02:30.027684 [debug] [MainThread]: Parsing macros\adapters.sql
[0m08:02:30.059686 [debug] [MainThread]: Parsing macros\catalog.sql
[0m08:02:30.066689 [debug] [MainThread]: Parsing macros\etc.sql
[0m08:02:30.068688 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:02:30.071688 [debug] [MainThread]: Parsing macros\materializations\copy.sql
[0m08:02:30.074688 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m08:02:30.093690 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m08:02:30.096690 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m08:02:30.098691 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m08:02:30.103690 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m08:02:30.106690 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:02:30.107690 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:02:30.108691 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:02:30.109691 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:02:30.110691 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:02:30.110691 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:02:30.111691 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:02:30.111691 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:02:30.112691 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:02:30.113693 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:02:30.114691 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:02:30.115691 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:02:30.116692 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:02:30.117691 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:02:30.139693 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m08:02:30.150695 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m08:02:30.154694 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m08:02:30.157694 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m08:02:30.165695 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m08:02:30.170695 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m08:02:30.187696 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m08:02:30.189697 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m08:02:30.199699 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m08:02:30.204698 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m08:02:30.206698 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m08:02:30.207698 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m08:02:30.208699 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m08:02:30.209698 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m08:02:30.210698 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m08:02:30.212698 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m08:02:30.215699 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m08:02:30.218699 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m08:02:30.223699 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m08:02:30.228700 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m08:02:30.289704 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m08:02:30.291704 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m08:02:30.309706 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m08:02:30.326707 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m08:02:30.329707 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m08:02:30.336709 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m08:02:30.340708 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m08:02:30.342708 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m08:02:30.344708 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m08:02:30.350708 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m08:02:30.370710 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m08:02:30.378711 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m08:02:30.393712 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m08:02:30.406713 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m08:02:30.408713 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m08:02:30.435714 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m08:02:30.438715 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m08:02:30.444714 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m08:02:30.446715 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:02:30.448717 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:02:30.449717 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m08:02:30.451715 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m08:02:30.452715 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m08:02:30.459402 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:02:30.461403 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:02:30.462403 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:02:30.463403 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:02:30.465404 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:02:30.466405 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:02:30.468403 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:02:30.468403 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:02:30.471403 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m08:02:30.472404 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:02:30.474403 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m08:02:30.476404 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:02:30.477404 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m08:02:30.478404 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:02:30.480405 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:02:30.481404 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:02:30.484404 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m08:02:30.487405 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m08:02:30.493405 [debug] [MainThread]: Parsing macros\internal\helpers\logging.sql
[0m08:02:30.497405 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m08:02:30.497405 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m08:02:30.515407 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m08:02:30.519407 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m08:02:30.522407 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m08:02:30.525407 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m08:02:30.527409 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m08:02:30.530408 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m08:02:30.545409 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m08:02:30.549412 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m08:02:30.555409 [debug] [MainThread]: Parsing macros\internal\metadata_processing\process_payload_column_excludes.sql
[0m08:02:30.562410 [debug] [MainThread]: Parsing macros\materialisations\drop_temporary.sql
[0m08:02:30.565411 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m08:02:30.573412 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m08:02:30.576412 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m08:02:30.582413 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m08:02:30.590413 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m08:02:30.591415 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m08:02:30.625717 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m08:02:30.646054 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m08:02:30.668055 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m08:02:30.676056 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m08:02:30.685057 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m08:02:30.694057 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m08:02:30.705058 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m08:02:30.709058 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m08:02:30.714059 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m08:02:30.727459 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m08:02:30.731463 [debug] [MainThread]: Parsing macros\staging\null_columns.sql
[0m08:02:30.748460 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m08:02:30.759842 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m08:02:30.761843 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m08:02:30.779844 [debug] [MainThread]: Parsing macros\supporting\as_of_date_window.sql
[0m08:02:30.787174 [debug] [MainThread]: Parsing macros\supporting\bridge_shared.sql
[0m08:02:30.800176 [debug] [MainThread]: Parsing macros\supporting\cast_binary.sql
[0m08:02:30.804175 [debug] [MainThread]: Parsing macros\supporting\cast_date.sql
[0m08:02:30.814176 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m08:02:30.817539 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m08:02:30.820539 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m08:02:30.822539 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m08:02:30.883347 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m08:02:30.889345 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m08:02:30.901351 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m08:02:30.903347 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m08:02:30.927346 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m08:02:30.942347 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m08:02:30.958349 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m08:02:30.976350 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m08:02:31.001352 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m08:02:31.002352 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m08:02:31.004352 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m08:02:31.005353 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
[0m08:02:31.006353 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
[0m08:02:31.007353 [debug] [MainThread]: Parsing macros\tables\databricks\sat.sql
[0m08:02:31.009354 [debug] [MainThread]: Parsing macros\tables\postgres\hub.sql
[0m08:02:31.021354 [debug] [MainThread]: Parsing macros\tables\postgres\link.sql
[0m08:02:31.036355 [debug] [MainThread]: Parsing macros\tables\postgres\sat.sql
[0m08:02:31.046355 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m08:02:31.060357 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m08:02:31.085359 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m08:02:31.103360 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m08:02:31.123361 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m08:02:31.144363 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m08:02:31.176365 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m08:02:31.192366 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m08:02:31.202367 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m08:02:31.221369 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m08:02:31.223369 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m08:02:31.242371 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m08:02:31.254372 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m08:02:31.267373 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m08:02:31.282374 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m08:02:31.284374 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m08:02:31.285374 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m08:02:31.286374 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m08:02:31.287374 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\xdb_deprecation_warning.sql
[0m08:02:31.288374 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m08:02:31.291374 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m08:02:31.293375 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m08:02:31.295375 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m08:02:31.300376 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m08:02:31.305376 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m08:02:31.307376 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m08:02:31.312378 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m08:02:31.323377 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m08:02:31.326377 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m08:02:31.328378 [debug] [MainThread]: Parsing macros\generic_tests\not_empty_string.sql
[0m08:02:31.330377 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m08:02:31.334377 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m08:02:31.338378 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m08:02:31.340378 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m08:02:31.345381 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m08:02:31.348379 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m08:02:31.350381 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m08:02:31.351379 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m08:02:31.353379 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m08:02:31.354379 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_ephemeral.sql
[0m08:02:31.356379 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_relation.sql
[0m08:02:31.357379 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m08:02:31.362379 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m08:02:31.367381 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m08:02:31.372380 [debug] [MainThread]: Parsing macros\sql\generate_surrogate_key.sql
[0m08:02:31.375381 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m08:02:31.381381 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m08:02:31.385381 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m08:02:31.388381 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m08:02:31.392384 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m08:02:31.396382 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m08:02:31.403383 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m08:02:31.406383 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m08:02:31.407383 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m08:02:31.409383 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m08:02:31.417385 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m08:02:31.419384 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m08:02:31.420384 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m08:02:31.425385 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m08:02:31.428385 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m08:02:31.433385 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m08:02:31.435387 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m08:02:31.454387 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m08:02:31.462388 [debug] [MainThread]: Parsing macros\sql\width_bucket.sql
[0m08:02:31.468387 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m08:02:31.471391 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m08:02:31.472388 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m08:02:32.420502 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m08:02:32.438504 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m08:02:32.444504 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m08:02:32.449507 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m08:02:32.454507 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m08:02:32.457507 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_order.sql
[0m08:02:32.461505 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m08:02:32.467506 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m08:02:32.473032 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m08:02:32.616096 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m08:02:32.618093 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m08:02:32.634095 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m08:02:32.636096 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m08:02:32.652097 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m08:02:32.653096 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m08:02:32.697099 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m08:02:32.699101 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m08:02:32.721101 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m08:02:32.723101 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m08:02:32.799107 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m08:02:32.801106 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order.sql
[0m08:02:32.834109 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order.sql
[0m08:02:32.836109 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m08:02:32.873112 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m08:02:32.875112 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m08:02:32.910114 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m08:02:32.911115 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m08:02:33.077127 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m08:02:33.079127 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_order.sql
[0m08:02:33.145148 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_order.sql
[0m08:02:33.147148 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m08:02:33.219154 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m08:02:33.221153 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m08:02:33.273160 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m08:02:33.497417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60b16829-47f5-4a86-9aa4-4cb8fcf5ff43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2797852E0>]}
[0m08:02:33.517419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60b16829-47f5-4a86-9aa4-4cb8fcf5ff43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C279ACCF10>]}
[0m08:02:33.518422 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:02:33.519421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60b16829-47f5-4a86-9aa4-4cb8fcf5ff43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2796CDDC0>]}
[0m08:02:33.521418 [info ] [MainThread]: 
[0m08:02:33.522420 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:02:33.527423 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:02:33.527423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:33.536419 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m08:02:33.538420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:33.538420 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:02:33.538420 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m08:02:33.539420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2799C9F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2799C9D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C279785EE0>]}
[0m08:02:33.539420 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:04:18.448637 | 28559134-bf94-4f41-af37-24bd6492ecc9 ==============================
[0m08:04:18.448637 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:04:18.448637 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:04:18.449637 [debug] [MainThread]: Tracking: tracking
[0m08:04:18.449637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F62AA100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F62AA940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F62AAAC0>]}
[0m08:04:18.789648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:04:18.789648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:04:18.797649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28559134-bf94-4f41-af37-24bd6492ecc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F658B0D0>]}
[0m08:04:18.872656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28559134-bf94-4f41-af37-24bd6492ecc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F61D7E50>]}
[0m08:04:18.872656 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:04:18.873656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28559134-bf94-4f41-af37-24bd6492ecc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F61D7BB0>]}
[0m08:04:18.876656 [info ] [MainThread]: 
[0m08:04:18.877657 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:04:18.881657 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:04:18.881657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:18.888657 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m08:04:18.889657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:18.889657 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:04:18.890658 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m08:04:18.891658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F61A8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F6238C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F62388E0>]}
[0m08:04:18.891658 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:05:01.544236 | 897c88e8-c5ed-4686-b803-148c60c5b933 ==============================
[0m08:05:01.544236 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:05:01.545237 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:05:01.546238 [debug] [MainThread]: Tracking: tracking
[0m08:05:01.546238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFB7ADCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFB7AD430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFB7ADD90>]}
[0m08:05:01.851261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:05:01.851261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:05:01.860261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '897c88e8-c5ed-4686-b803-148c60c5b933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFBA9A0D0>]}
[0m08:05:01.929268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '897c88e8-c5ed-4686-b803-148c60c5b933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFBA650D0>]}
[0m08:05:01.929268 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:05:01.930268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '897c88e8-c5ed-4686-b803-148c60c5b933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFB6E7AC0>]}
[0m08:05:01.932266 [info ] [MainThread]: 
[0m08:05:01.933268 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:05:01.938273 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:05:01.938273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:01.945270 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m08:05:01.946270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:05:01.947270 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:05:01.947270 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m08:05:01.948267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFB6A3CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFB7956A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023CFB7951F0>]}
[0m08:05:01.948267 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:07:05.911935 | aad7c3b2-2b02-4469-b109-eb05685f9bea ==============================
[0m08:07:05.911935 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:07:05.911935 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:07:05.911935 [debug] [MainThread]: Tracking: tracking
[0m08:07:05.911935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020957359310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020957359370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209573597F0>]}
[0m08:07:06.240160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:07:06.240160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:07:06.255791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aad7c3b2-2b02-4469-b109-eb05685f9bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095764A0D0>]}
[0m08:07:06.318308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aad7c3b2-2b02-4469-b109-eb05685f9bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209572979D0>]}
[0m08:07:06.318308 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:07:06.318308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aad7c3b2-2b02-4469-b109-eb05685f9bea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020957297730>]}
[0m08:07:06.318308 [info ] [MainThread]: 
[0m08:07:06.318308 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:07:06.333941 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:07:06.333941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:06.333941 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m08:07:06.333941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:06.333941 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:07:06.333941 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m08:07:06.333941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209572549D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209572F9A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209572F9DF0>]}
[0m08:07:06.333941 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:07:19.261202 | 38100d4f-bd9e-42ca-aa69-03f97135fa4a ==============================
[0m08:07:19.261202 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:07:19.261202 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:07:19.261202 [debug] [MainThread]: Tracking: tracking
[0m08:07:19.261202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963BF0DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963BF0D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963BF0D910>]}
[0m08:07:19.558165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:07:19.558165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:07:19.558165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38100d4f-bd9e-42ca-aa69-03f97135fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963C1FA0A0>]}
[0m08:07:19.636312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38100d4f-bd9e-42ca-aa69-03f97135fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963BE47E80>]}
[0m08:07:19.636312 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:07:19.636312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38100d4f-bd9e-42ca-aa69-03f97135fa4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963BE47BE0>]}
[0m08:07:19.636312 [info ] [MainThread]: 
[0m08:07:19.636312 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:07:19.636312 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:07:19.636312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:19.683202 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m08:07:19.683202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:19.683202 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:07:19.683202 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m08:07:19.683202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963BE02E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963BEA8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001963BEA89A0>]}
[0m08:07:19.683202 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:25:40.282509 | df80db7d-228f-42c5-bcda-31e153ab4304 ==============================
[0m08:25:40.282509 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:25:40.282509 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:25:40.282509 [debug] [MainThread]: Tracking: tracking
[0m08:25:40.282509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D110893D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D11089760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D110895E0>]}
[0m08:25:41.908002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:25:41.908002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:25:41.923633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df80db7d-228f-42c5-bcda-31e153ab4304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1137B0D0>]}
[0m08:25:41.986153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df80db7d-228f-42c5-bcda-31e153ab4304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D10FC79D0>]}
[0m08:25:41.986153 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:25:41.986153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df80db7d-228f-42c5-bcda-31e153ab4304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D10FC7730>]}
[0m08:25:42.001783 [info ] [MainThread]: 
[0m08:25:42.001783 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:25:42.001783 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:25:42.001783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:42.001783 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
  '
[0m08:25:42.001783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:42.017413 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:25:42.017413 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Could not automatically determine credentials. Please set GOOGLE_APPLICATION_CREDENTIALS or explicitly create credentials and re-run the application. For more information, please see https://cloud.google.com/docs/authentication/getting-started
    
[0m08:25:42.017413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D10F859D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D11029250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D11029CA0>]}
[0m08:25:42.017413 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:30:13.519328 | 2e4ae25d-c962-4bd9-8240-d66d555d8d09 ==============================
[0m08:30:13.519328 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:30:13.534958 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:30:13.534958 [debug] [MainThread]: Tracking: tracking
[0m08:30:13.534958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31129A370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31129AFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31129ACA0>]}
[0m08:30:13.847571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:30:13.847571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:30:13.847571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e4ae25d-c962-4bd9-8240-d66d555d8d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31157A0D0>]}
[0m08:30:13.925726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e4ae25d-c962-4bd9-8240-d66d555d8d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3111C7CD0>]}
[0m08:30:13.925726 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:30:13.925726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e4ae25d-c962-4bd9-8240-d66d555d8d09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3111C7AC0>]}
[0m08:30:13.925726 [info ] [MainThread]: 
[0m08:30:13.925726 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:30:13.925726 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:30:13.925726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:13.925726 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  File steadfast-task-363413-c36fd6845da9.json was not found.
  '
[0m08:30:13.925726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:13.925726 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:30:13.925726 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    File steadfast-task-363413-c36fd6845da9.json was not found.
    
[0m08:30:13.925726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C311182D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31122C310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31122CF40>]}
[0m08:30:13.925726 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:31:06.106863 | df63915c-3421-458d-a6a5-042f66c1b07c ==============================
[0m08:31:06.106863 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:31:06.106863 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:31:06.106863 [debug] [MainThread]: Tracking: tracking
[0m08:31:06.106863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A594178E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A594178B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A594178D90>]}
[0m08:31:06.247532 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:31:06.247532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df63915c-3421-458d-a6a5-042f66c1b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5941DE100>]}
[0m08:31:06.419457 [debug] [MainThread]: Parsing macros\adapters.sql
[0m08:31:06.435087 [debug] [MainThread]: Parsing macros\catalog.sql
[0m08:31:06.450717 [debug] [MainThread]: Parsing macros\etc.sql
[0m08:31:06.450717 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:31:06.450717 [debug] [MainThread]: Parsing macros\materializations\copy.sql
[0m08:31:06.450717 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m08:31:06.466346 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m08:31:06.481976 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m08:31:06.481976 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m08:31:06.481976 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m08:31:06.481976 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:31:06.481976 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:31:06.481976 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:31:06.481976 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:31:06.497606 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:31:06.497606 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:31:06.497606 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:31:06.497606 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:31:06.497606 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:31:06.497606 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:31:06.497606 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:31:06.497606 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:31:06.497606 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:31:06.497606 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:31:06.513235 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m08:31:06.528865 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m08:31:06.528865 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m08:31:06.528865 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m08:31:06.528865 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m08:31:06.544495 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m08:31:06.560124 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m08:31:06.560124 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m08:31:06.575754 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m08:31:06.575754 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m08:31:06.575754 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m08:31:06.575754 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m08:31:06.575754 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m08:31:06.575754 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m08:31:06.575754 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m08:31:06.575754 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m08:31:06.591384 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m08:31:06.591384 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m08:31:06.591384 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m08:31:06.591384 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m08:31:06.653905 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m08:31:06.653905 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m08:31:06.669533 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m08:31:06.685163 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m08:31:06.700792 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m08:31:06.700792 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m08:31:06.700792 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m08:31:06.716422 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m08:31:06.716422 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m08:31:06.716422 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m08:31:06.732052 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m08:31:06.747682 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m08:31:06.763312 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m08:31:06.763312 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m08:31:06.778942 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m08:31:06.794571 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m08:31:06.794571 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m08:31:06.794571 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m08:31:06.794571 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:31:06.794571 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:31:06.794571 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m08:31:06.810200 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m08:31:06.810200 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m08:31:06.810200 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:31:06.810200 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:31:06.825830 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m08:31:06.841462 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:31:06.841462 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:31:06.841462 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:31:06.841462 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m08:31:06.841462 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m08:31:06.841462 [debug] [MainThread]: Parsing macros\internal\helpers\logging.sql
[0m08:31:06.857091 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m08:31:06.857091 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m08:31:06.872721 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m08:31:06.872721 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m08:31:06.872721 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m08:31:06.872721 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m08:31:06.888350 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m08:31:06.888350 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m08:31:06.903981 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m08:31:06.903981 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m08:31:06.903981 [debug] [MainThread]: Parsing macros\internal\metadata_processing\process_payload_column_excludes.sql
[0m08:31:06.919610 [debug] [MainThread]: Parsing macros\materialisations\drop_temporary.sql
[0m08:31:06.919610 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m08:31:06.919610 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m08:31:06.919610 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m08:31:06.935242 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m08:31:06.935242 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m08:31:06.935242 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m08:31:06.966498 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m08:31:06.997758 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m08:31:07.013389 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m08:31:07.029018 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m08:31:07.029018 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m08:31:07.044649 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m08:31:07.044649 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m08:31:07.060279 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m08:31:07.060279 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m08:31:07.075908 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m08:31:07.075908 [debug] [MainThread]: Parsing macros\staging\null_columns.sql
[0m08:31:07.091539 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m08:31:07.107166 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m08:31:07.107166 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m08:31:07.122797 [debug] [MainThread]: Parsing macros\supporting\as_of_date_window.sql
[0m08:31:07.122797 [debug] [MainThread]: Parsing macros\supporting\bridge_shared.sql
[0m08:31:07.138427 [debug] [MainThread]: Parsing macros\supporting\cast_binary.sql
[0m08:31:07.138427 [debug] [MainThread]: Parsing macros\supporting\cast_date.sql
[0m08:31:07.154057 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m08:31:07.154057 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m08:31:07.154057 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m08:31:07.154057 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m08:31:07.200944 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m08:31:07.200944 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m08:31:07.216574 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m08:31:07.216574 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m08:31:07.232204 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m08:31:07.232204 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m08:31:07.248430 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m08:31:07.263486 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m08:31:07.279116 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m08:31:07.294744 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m08:31:07.294744 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m08:31:07.294744 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
[0m08:31:07.294744 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
[0m08:31:07.294744 [debug] [MainThread]: Parsing macros\tables\databricks\sat.sql
[0m08:31:07.294744 [debug] [MainThread]: Parsing macros\tables\postgres\hub.sql
[0m08:31:07.310504 [debug] [MainThread]: Parsing macros\tables\postgres\link.sql
[0m08:31:07.310504 [debug] [MainThread]: Parsing macros\tables\postgres\sat.sql
[0m08:31:07.326935 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m08:31:07.342047 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m08:31:07.357684 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m08:31:07.373299 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m08:31:07.388904 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m08:31:07.404697 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m08:31:07.435780 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m08:31:07.451417 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m08:31:07.466674 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m08:31:07.482745 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m08:31:07.482745 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m08:31:07.498310 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m08:31:07.513563 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m08:31:07.529192 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m08:31:07.544823 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m08:31:07.544823 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m08:31:07.544823 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m08:31:07.544823 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m08:31:07.544823 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\xdb_deprecation_warning.sql
[0m08:31:07.544823 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m08:31:07.544823 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m08:31:07.544823 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m08:31:07.544823 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m08:31:07.560520 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m08:31:07.560520 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m08:31:07.560520 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m08:31:07.560520 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m08:31:07.576459 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m08:31:07.576459 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m08:31:07.576459 [debug] [MainThread]: Parsing macros\generic_tests\not_empty_string.sql
[0m08:31:07.592076 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m08:31:07.592076 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m08:31:07.592076 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m08:31:07.592076 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m08:31:07.592076 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m08:31:07.607719 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m08:31:07.607719 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m08:31:07.607719 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m08:31:07.607719 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m08:31:07.607719 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_ephemeral.sql
[0m08:31:07.607719 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_relation.sql
[0m08:31:07.607719 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m08:31:07.622971 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m08:31:07.622971 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m08:31:07.622971 [debug] [MainThread]: Parsing macros\sql\generate_surrogate_key.sql
[0m08:31:07.622971 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m08:31:07.639140 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m08:31:07.639140 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m08:31:07.639140 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m08:31:07.639140 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m08:31:07.654610 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m08:31:07.654610 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m08:31:07.654610 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m08:31:07.654610 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m08:31:07.669978 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m08:31:07.669978 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m08:31:07.669978 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m08:31:07.669978 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m08:31:07.685864 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m08:31:07.685864 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m08:31:07.685864 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m08:31:07.685864 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m08:31:07.701494 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m08:31:07.701494 [debug] [MainThread]: Parsing macros\sql\width_bucket.sql
[0m08:31:07.717392 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m08:31:07.717392 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m08:31:07.717392 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m08:31:08.623649 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m08:31:08.638903 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m08:31:08.638903 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m08:31:08.638903 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m08:31:08.654534 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m08:31:08.654534 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_order.sql
[0m08:31:08.654534 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m08:31:08.654534 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m08:31:08.670164 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m08:31:08.795202 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m08:31:08.795202 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m08:31:08.810830 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m08:31:08.810830 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m08:31:08.826845 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m08:31:08.826845 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m08:31:08.873350 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m08:31:08.873350 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m08:31:08.888981 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m08:31:08.904608 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m08:31:08.967129 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m08:31:08.982758 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order.sql
[0m08:31:08.998387 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order.sql
[0m08:31:09.014017 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m08:31:09.045276 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m08:31:09.045276 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m08:31:09.076914 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m08:31:09.076914 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m08:31:09.217594 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m08:31:09.217594 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_order.sql
[0m08:31:09.279722 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_order.sql
[0m08:31:09.279722 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m08:31:09.342624 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m08:31:09.342624 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m08:31:09.389500 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m08:31:09.607942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df63915c-3421-458d-a6a5-042f66c1b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A594261FD0>]}
[0m08:31:09.623943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df63915c-3421-458d-a6a5-042f66c1b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5941DE400>]}
[0m08:31:09.623943 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:31:09.623943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df63915c-3421-458d-a6a5-042f66c1b07c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5941DE460>]}
[0m08:31:09.623943 [info ] [MainThread]: 
[0m08:31:09.623943 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:31:09.623943 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:31:09.623943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:09.639200 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  File steadfast-task-363413-c36fd6845da9.json was not found.
  '
[0m08:31:09.639200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:09.639200 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:31:09.639200 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    File steadfast-task-363413-c36fd6845da9.json was not found.
    
[0m08:31:09.639200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A594261640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5943C5D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5943C55B0>]}
[0m08:31:09.639200 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:31:34.252587 | 22b4eb4a-a820-4fb8-8c3c-16f80a7d86d6 ==============================
[0m08:31:34.252587 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:31:34.252587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:31:34.252587 [debug] [MainThread]: Tracking: tracking
[0m08:31:34.252587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B89DAB400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B89DABEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B89DAB850>]}
[0m08:31:34.408887 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:31:34.408887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '22b4eb4a-a820-4fb8-8c3c-16f80a7d86d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B89DEE850>]}
[0m08:31:34.580815 [debug] [MainThread]: Parsing macros\adapters.sql
[0m08:31:34.596445 [debug] [MainThread]: Parsing macros\catalog.sql
[0m08:31:34.612072 [debug] [MainThread]: Parsing macros\etc.sql
[0m08:31:34.612072 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:31:34.612072 [debug] [MainThread]: Parsing macros\materializations\copy.sql
[0m08:31:34.612072 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m08:31:34.627705 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:31:34.643335 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:31:34.658964 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:31:34.658964 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:31:34.658964 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:31:34.658964 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:31:34.658964 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:31:34.658964 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:31:34.674594 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m08:31:34.674594 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m08:31:34.690223 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m08:31:34.690223 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m08:31:34.690223 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m08:31:34.705851 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m08:31:34.721483 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m08:31:34.721483 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m08:31:34.721483 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m08:31:34.737113 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m08:31:34.737113 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m08:31:34.737113 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m08:31:34.737113 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m08:31:34.737113 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m08:31:34.737113 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m08:31:34.737113 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m08:31:34.737113 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m08:31:34.752742 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m08:31:34.752742 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m08:31:34.752742 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m08:31:34.815263 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m08:31:34.815263 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m08:31:34.830892 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m08:31:34.846520 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m08:31:34.846520 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m08:31:34.862151 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m08:31:34.862151 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m08:31:34.862151 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m08:31:34.862151 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m08:31:34.877780 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m08:31:34.893410 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m08:31:34.893410 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m08:31:34.924669 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m08:31:34.924669 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m08:31:34.940303 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m08:31:34.955929 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m08:31:34.955929 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m08:31:34.955929 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m08:31:34.955929 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:31:34.971558 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:31:34.971558 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m08:31:34.971558 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m08:31:34.971558 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m08:31:34.971558 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:31:34.971558 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:31:34.971558 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:31:34.971558 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:31:34.987188 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:31:35.002816 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:31:35.002816 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m08:31:35.002816 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m08:31:35.002816 [debug] [MainThread]: Parsing macros\internal\helpers\logging.sql
[0m08:31:35.002816 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m08:31:35.002816 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m08:31:35.034075 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m08:31:35.034075 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m08:31:35.034075 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m08:31:35.034075 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m08:31:35.034075 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m08:31:35.034075 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m08:31:35.049707 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m08:31:35.065334 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m08:31:35.065334 [debug] [MainThread]: Parsing macros\internal\metadata_processing\process_payload_column_excludes.sql
[0m08:31:35.080964 [debug] [MainThread]: Parsing macros\materialisations\drop_temporary.sql
[0m08:31:35.080964 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m08:31:35.080964 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m08:31:35.080964 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m08:31:35.096593 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m08:31:35.096593 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m08:31:35.096593 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m08:31:35.127852 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m08:31:35.159113 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m08:31:35.174742 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m08:31:35.190374 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m08:31:35.190374 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m08:31:35.206003 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m08:31:35.206003 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m08:31:35.221632 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m08:31:35.221632 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m08:31:35.237261 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m08:31:35.237261 [debug] [MainThread]: Parsing macros\staging\null_columns.sql
[0m08:31:35.252892 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m08:31:35.268523 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m08:31:35.268523 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m08:31:35.284152 [debug] [MainThread]: Parsing macros\supporting\as_of_date_window.sql
[0m08:31:35.284152 [debug] [MainThread]: Parsing macros\supporting\bridge_shared.sql
[0m08:31:35.299782 [debug] [MainThread]: Parsing macros\supporting\cast_binary.sql
[0m08:31:35.299782 [debug] [MainThread]: Parsing macros\supporting\cast_date.sql
[0m08:31:35.315413 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m08:31:35.315413 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m08:31:35.315413 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m08:31:35.315413 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m08:31:35.362299 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m08:31:35.362299 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m08:31:35.377932 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m08:31:35.377932 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m08:31:35.393562 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m08:31:35.409190 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m08:31:35.409190 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m08:31:35.440451 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m08:31:35.456081 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m08:31:35.456081 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m08:31:35.456081 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m08:31:35.456081 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
[0m08:31:35.456081 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
[0m08:31:35.471709 [debug] [MainThread]: Parsing macros\tables\databricks\sat.sql
[0m08:31:35.471709 [debug] [MainThread]: Parsing macros\tables\postgres\hub.sql
[0m08:31:35.471709 [debug] [MainThread]: Parsing macros\tables\postgres\link.sql
[0m08:31:35.487341 [debug] [MainThread]: Parsing macros\tables\postgres\sat.sql
[0m08:31:35.502970 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m08:31:35.518601 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m08:31:35.534229 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m08:31:35.549860 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m08:31:35.565490 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m08:31:35.581119 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m08:31:35.612379 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m08:31:35.628006 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m08:31:35.643638 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m08:31:35.659269 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m08:31:35.659269 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m08:31:35.674899 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m08:31:35.690527 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m08:31:35.690527 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m08:31:35.706158 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m08:31:35.706158 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m08:31:35.721787 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m08:31:35.721787 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m08:31:35.721787 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\xdb_deprecation_warning.sql
[0m08:31:35.721787 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m08:31:35.721787 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m08:31:35.721787 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m08:31:35.721787 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m08:31:35.721787 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m08:31:35.737418 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m08:31:35.737418 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m08:31:35.737418 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m08:31:35.753047 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m08:31:35.753047 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m08:31:35.753047 [debug] [MainThread]: Parsing macros\generic_tests\not_empty_string.sql
[0m08:31:35.753047 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m08:31:35.768676 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m08:31:35.768676 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m08:31:35.768676 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m08:31:35.768676 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m08:31:35.784306 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m08:31:35.784306 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m08:31:35.784306 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m08:31:35.784306 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m08:31:35.784306 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_ephemeral.sql
[0m08:31:35.784306 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_relation.sql
[0m08:31:35.784306 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m08:31:35.799936 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m08:31:35.799936 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m08:31:35.799936 [debug] [MainThread]: Parsing macros\sql\generate_surrogate_key.sql
[0m08:31:35.799936 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m08:31:35.815565 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m08:31:35.815565 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m08:31:35.815565 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m08:31:35.815565 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m08:31:35.831195 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m08:31:35.831195 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m08:31:35.831195 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m08:31:35.831195 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m08:31:35.846825 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m08:31:35.846825 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m08:31:35.846825 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m08:31:35.846825 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m08:31:35.862455 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m08:31:35.862455 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m08:31:35.862455 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m08:31:35.862455 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m08:31:35.878083 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m08:31:35.893715 [debug] [MainThread]: Parsing macros\sql\width_bucket.sql
[0m08:31:35.893715 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m08:31:35.893715 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m08:31:35.893715 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m08:31:36.800239 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m08:31:36.815869 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m08:31:36.815869 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m08:31:36.815869 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m08:31:36.815869 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m08:31:36.831498 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_order.sql
[0m08:31:36.831498 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m08:31:36.831498 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m08:31:36.831498 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m08:31:36.972164 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m08:31:36.972164 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m08:31:36.987795 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m08:31:36.987795 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m08:31:37.003423 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m08:31:37.003423 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m08:31:37.050313 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m08:31:37.050313 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m08:31:37.065943 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m08:31:37.065943 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m08:31:37.144094 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m08:31:37.144094 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order.sql
[0m08:31:37.175352 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order.sql
[0m08:31:37.175352 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m08:31:37.206613 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m08:31:37.206613 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m08:31:37.237872 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m08:31:37.237872 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m08:31:37.379206 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m08:31:37.379206 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_order.sql
[0m08:31:37.441464 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_order.sql
[0m08:31:37.441464 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m08:31:37.503975 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m08:31:37.503975 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m08:31:37.566114 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m08:31:37.769287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22b4eb4a-a820-4fb8-8c3c-16f80a7d86d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B89E33670>]}
[0m08:31:37.785299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22b4eb4a-a820-4fb8-8c3c-16f80a7d86d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8A157C40>]}
[0m08:31:37.785299 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:31:37.785299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b4eb4a-a820-4fb8-8c3c-16f80a7d86d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B89D9E220>]}
[0m08:31:37.785299 [info ] [MainThread]: 
[0m08:31:37.785299 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:31:37.800541 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:31:37.800541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:37.800541 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  File steadfast-task-363413-c36fd6845da9.json was not found.
  '
[0m08:31:37.800541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:37.800541 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:31:37.800541 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    File steadfast-task-363413-c36fd6845da9.json was not found.
    
[0m08:31:37.800541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B89E336D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B89E4BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B89E50280>]}
[0m08:31:37.800541 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:32:27.038907 | a16a9053-f9a8-4480-827c-f6d0e0d19cc8 ==============================
[0m08:32:27.038907 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:32:27.038907 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:32:27.038907 [debug] [MainThread]: Tracking: tracking
[0m08:32:27.054537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10092A370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10092A700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10092A670>]}
[0m08:32:27.351500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:32:27.351500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:32:27.367129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a16a9053-f9a8-4480-827c-f6d0e0d19cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F100C0A0D0>]}
[0m08:32:27.430015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a16a9053-f9a8-4480-827c-f6d0e0d19cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F10085F130>]}
[0m08:32:27.430015 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:32:27.430015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a16a9053-f9a8-4480-827c-f6d0e0d19cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F100855E50>]}
[0m08:32:27.430015 [info ] [MainThread]: 
[0m08:32:27.430015 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:32:27.445280 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:32:27.445280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:32:27.445280 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  File steadfast-task-363413-c36fd6845da9.json was not found.
  '
[0m08:32:27.445280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:32:27.445280 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:32:27.445280 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    File steadfast-task-363413-c36fd6845da9.json was not found.
    
[0m08:32:27.445280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F100825340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1008C0B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1008C0FA0>]}
[0m08:32:27.445280 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:33:47.634865 | 2b086de6-a335-4ecd-b331-0a1262dcbd74 ==============================
[0m08:33:47.634865 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:33:47.634865 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:33:47.634865 [debug] [MainThread]: Tracking: tracking
[0m08:33:47.634865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735F590A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735F592B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735F59EE0>]}
[0m08:33:47.932463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:33:47.932463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:33:47.932463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B73624A0D0>]}
[0m08:33:48.010321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735E969D0>]}
[0m08:33:48.010321 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:33:48.010321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735E96730>]}
[0m08:33:48.010321 [info ] [MainThread]: 
[0m08:33:48.010321 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:33:48.010321 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:33:48.010321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:48.854010 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m08:33:48.854010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:49.260364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735E53B80>]}
[0m08:33:49.260364 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:33:49.260364 [info ] [MainThread]: 
[0m08:33:49.307248 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:33:49.307248 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:33:49.307248 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:33:49.307248 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_order
[0m08:33:49.307248 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m08:33:49.307248 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m08:33:49.307248 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m08:33:49.307248 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_order ................................ [RUN]
[0m08:33:49.307248 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:33:49.307248 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:33:49.307248 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:33:49.307248 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:33:49.307248 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:33:49.307248 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:33:49.307248 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:33:49.307248 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:33:49.307248 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:33:49.307248 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:33:49.307248 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_order
[0m08:33:49.307248 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:33:49.322878 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:33:49.322878 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_order
[0m08:33:49.322878 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:33:49.322878 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:33:49.338510 [debug] [Thread-3  ]: finished collecting timing info
[0m08:33:49.338510 [debug] [Thread-4  ]: finished collecting timing info
[0m08:33:49.338510 [debug] [Thread-2  ]: finished collecting timing info
[0m08:33:49.338510 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:33:49.338510 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_order
[0m08:33:49.338510 [debug] [Thread-1  ]: finished collecting timing info
[0m08:33:49.338510 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:33:49.369768 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:33:49.385397 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:33:49.385397 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:33:49.385397 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:33:49.401027 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:33:49.401027 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:33:49.401027 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m08:33:49.401027 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:33:49.401027 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:33:49.401027 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:33:49.401027 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m08:33:49.401027 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m08:33:49.401027 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m08:33:50.948803 [debug] [Thread-3  ]: finished collecting timing info
[0m08:33:50.948803 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735F2E850>]}
[0m08:33:50.948803 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.64s]
[0m08:33:50.948803 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:33:50.948803 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:33:50.948803 [info ] [Thread-6  ]: 5 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m08:33:50.948803 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m08:33:50.948803 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:33:50.948803 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:33:50.995283 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m08:33:51.026533 [debug] [Thread-4  ]: finished collecting timing info
[0m08:33:51.026533 [debug] [Thread-1  ]: finished collecting timing info
[0m08:33:51.026533 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735F345B0>]}
[0m08:33:51.026533 [debug] [Thread-2  ]: finished collecting timing info
[0m08:33:51.026533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735F2E310>]}
[0m08:33:51.026533 [info ] [Thread-4  ]: 4 of 21 OK created view model data_vault.v_raw_order ........................... [[32mOK[0m in 1.72s]
[0m08:33:51.026533 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735F2E190>]}
[0m08:33:51.026533 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.72s]
[0m08:33:51.026533 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.72s]
[0m08:33:51.042162 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_order
[0m08:33:51.042162 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_order
[0m08:33:51.042162 [info ] [Thread-8  ]: 6 of 21 START view model data_vault.v_stg_order ................................ [RUN]
[0m08:33:51.042162 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:33:51.042162 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:33:51.042162 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:33:51.042162 [info ] [Thread-3  ]: 7 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m08:33:51.042162 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_order"
[0m08:33:51.042162 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:33:51.042162 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_order
[0m08:33:51.042162 [info ] [Thread-4  ]: 8 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m08:33:51.042162 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m08:33:51.042162 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_order
[0m08:33:51.042162 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m08:33:51.042162 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:33:51.057804 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m08:33:51.057804 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:33:51.057804 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:33:51.057804 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:33:51.073410 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:33:51.089041 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:33:52.261271 [debug] [Thread-6  ]: finished collecting timing info
[0m08:33:52.261271 [debug] [Thread-6  ]: Compilation Error in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_customer_wealth_bracket = {
      "hash": "SHA",
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
  > called by model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
[0m08:33:52.261271 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B737484BB0>]}
[0m08:33:52.276900 [error] [Thread-6  ]: 5 of 21 ERROR creating view model data_vault.v_stg_customer_wealth_bracket ..... [[31mERROR[0m in 1.31s]
[0m08:33:52.276900 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:33:52.292530 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:33:52.276900 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:33:52.292530 [info ] [Thread-7  ]: 10 of 21 SKIP relation data_vault.sat_customer_wealth_bracket .................. [[33mSKIP[0m]
[0m08:33:52.292530 [info ] [Thread-1  ]: 9 of 21 SKIP relation data_vault.hub_customer_wealth_bracket ................... [[33mSKIP[0m]
[0m08:33:52.292530 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:33:52.292530 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:33:52.355050 [debug] [Thread-4  ]: finished collecting timing info
[0m08:33:52.355050 [debug] [Thread-4  ]: Compilation Error in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_US_customer = {
      "hash": "SHA",
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
  > called by model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
[0m08:33:52.355050 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B736403040>]}
[0m08:33:52.355050 [error] [Thread-4  ]: 8 of 21 ERROR creating view model data_vault.v_stg_US_customer ................. [[31mERROR[0m in 1.31s]
[0m08:33:52.355050 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:33:52.370678 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:33:52.370678 [info ] [Thread-5  ]: 11 of 21 SKIP relation data_vault.sat_US_customer .............................. [[33mSKIP[0m]
[0m08:33:52.386312 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:33:52.401938 [debug] [Thread-8  ]: finished collecting timing info
[0m08:33:52.417567 [debug] [Thread-8  ]: Compilation Error in model v_stg_order (models\stage\v_stg_order.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_order = {
      "hash": "SHA",
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_order (models\stage\v_stg_order.sql)
  > called by model v_stg_order (models\stage\v_stg_order.sql)
[0m08:33:52.417567 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7374A3940>]}
[0m08:33:52.417567 [error] [Thread-8  ]: 6 of 21 ERROR creating view model data_vault.v_stg_order ....................... [[31mERROR[0m in 1.38s]
[0m08:33:52.433197 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_order
[0m08:33:52.433197 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m08:33:52.433197 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m08:33:52.433197 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.sat_order
[0m08:33:52.433197 [info ] [Thread-2  ]: 12 of 21 SKIP relation data_vault.hub_order .................................... [[33mSKIP[0m]
[0m08:33:52.433197 [info ] [Thread-7  ]: 13 of 21 SKIP relation data_vault.link_customer_order .......................... [[33mSKIP[0m]
[0m08:33:52.433197 [info ] [Thread-1  ]: 14 of 21 SKIP relation data_vault.sat_order .................................... [[33mSKIP[0m]
[0m08:33:52.448827 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m08:33:52.448827 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m08:33:52.448827 [debug] [Thread-3  ]: finished collecting timing info
[0m08:33:52.464456 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.sat_order
[0m08:33:52.464456 [debug] [Thread-3  ]: Compilation Error in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_UK_customer = {
      "hash": "SHA",
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
  > called by model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
[0m08:33:52.464456 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b086de6-a335-4ecd-b331-0a1262dcbd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7373F0340>]}
[0m08:33:52.464456 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:33:52.464456 [error] [Thread-3  ]: 7 of 21 ERROR creating view model data_vault.v_stg_UK_customer ................. [[31mERROR[0m in 1.42s]
[0m08:33:52.464456 [info ] [Thread-6  ]: 15 of 21 SKIP relation data_vault.v_comp_orders_as_is .......................... [[33mSKIP[0m]
[0m08:33:52.464456 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:33:52.464456 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m08:33:52.464456 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:33:52.464456 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:33:52.464456 [info ] [Thread-8  ]: 16 of 21 SKIP relation data_vault.hub_customer ................................. [[33mSKIP[0m]
[0m08:33:52.464456 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:33:52.464456 [info ] [Thread-4  ]: 17 of 21 SKIP relation data_vault.link_customer_wealth_bracket_customer ........ [[33mSKIP[0m]
[0m08:33:52.464456 [info ] [Thread-2  ]: 18 of 21 SKIP relation data_vault.sat_UK_customer .............................. [[33mSKIP[0m]
[0m08:33:52.464456 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m08:33:52.464456 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:33:52.464456 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:33:52.464456 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:33:52.464456 [info ] [Thread-1  ]: 19 of 21 SKIP relation data_vault.v_comp_customer_history ...................... [[33mSKIP[0m]
[0m08:33:52.464456 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:33:52.464456 [info ] [Thread-5  ]: 20 of 21 SKIP relation data_vault.v_comp_customers_as_is ....................... [[33mSKIP[0m]
[0m08:33:52.464456 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:33:52.464456 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:33:52.464456 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:33:52.464456 [info ] [Thread-7  ]: 21 of 21 SKIP relation data_vault.v_comp_customer_orders_as_is ................. [[33mSKIP[0m]
[0m08:33:52.480088 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:33:52.480088 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:33:52.480088 [info ] [MainThread]: 
[0m08:33:52.480088 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m08:33:52.480088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:33:52.480088 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:33:52.480088 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m08:33:52.480088 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_raw_UK_customer' was properly closed.
[0m08:33:52.480088 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_raw_US_customer' was properly closed.
[0m08:33:52.480088 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_UK_customer' was properly closed.
[0m08:33:52.480088 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_US_customer' was properly closed.
[0m08:33:52.480088 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket' was properly closed.
[0m08:33:52.480088 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_order' was properly closed.
[0m08:33:52.495717 [info ] [MainThread]: 
[0m08:33:52.495717 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m08:33:52.495717 [info ] [MainThread]: 
[0m08:33:52.511346 [error] [MainThread]: [33mCompilation Error in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)[0m
[0m08:33:52.511346 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m08:33:52.511346 [error] [MainThread]:   Vars supplied to v_stg_customer_wealth_bracket = {
[0m08:33:52.511346 [error] [MainThread]:       "hash": "SHA",
[0m08:33:52.511346 [error] [MainThread]:       "null_key_optional": "-2",
[0m08:33:52.511346 [error] [MainThread]:       "null_key_required": "-1"
[0m08:33:52.511346 [error] [MainThread]:   }
[0m08:33:52.511346 [error] [MainThread]:   
[0m08:33:52.511346 [error] [MainThread]:   > in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
[0m08:33:52.511346 [error] [MainThread]:   > called by model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
[0m08:33:52.511346 [info ] [MainThread]: 
[0m08:33:52.511346 [error] [MainThread]: [33mCompilation Error in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)[0m
[0m08:33:52.511346 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m08:33:52.511346 [error] [MainThread]:   Vars supplied to v_stg_US_customer = {
[0m08:33:52.511346 [error] [MainThread]:       "hash": "SHA",
[0m08:33:52.511346 [error] [MainThread]:       "null_key_optional": "-2",
[0m08:33:52.511346 [error] [MainThread]:       "null_key_required": "-1"
[0m08:33:52.511346 [error] [MainThread]:   }
[0m08:33:52.511346 [error] [MainThread]:   
[0m08:33:52.511346 [error] [MainThread]:   > in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
[0m08:33:52.511346 [error] [MainThread]:   > called by model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
[0m08:33:52.511346 [info ] [MainThread]: 
[0m08:33:52.511346 [error] [MainThread]: [33mCompilation Error in model v_stg_order (models\stage\v_stg_order.sql)[0m
[0m08:33:52.526977 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m08:33:52.526977 [error] [MainThread]:   Vars supplied to v_stg_order = {
[0m08:33:52.526977 [error] [MainThread]:       "hash": "SHA",
[0m08:33:52.526977 [error] [MainThread]:       "null_key_optional": "-2",
[0m08:33:52.526977 [error] [MainThread]:       "null_key_required": "-1"
[0m08:33:52.526977 [error] [MainThread]:   }
[0m08:33:52.526977 [error] [MainThread]:   
[0m08:33:52.526977 [error] [MainThread]:   > in model v_stg_order (models\stage\v_stg_order.sql)
[0m08:33:52.526977 [error] [MainThread]:   > called by model v_stg_order (models\stage\v_stg_order.sql)
[0m08:33:52.526977 [info ] [MainThread]: 
[0m08:33:52.526977 [error] [MainThread]: [33mCompilation Error in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)[0m
[0m08:33:52.526977 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m08:33:52.526977 [error] [MainThread]:   Vars supplied to v_stg_UK_customer = {
[0m08:33:52.526977 [error] [MainThread]:       "hash": "SHA",
[0m08:33:52.526977 [error] [MainThread]:       "null_key_optional": "-2",
[0m08:33:52.526977 [error] [MainThread]:       "null_key_required": "-1"
[0m08:33:52.526977 [error] [MainThread]:   }
[0m08:33:52.526977 [error] [MainThread]:   
[0m08:33:52.526977 [error] [MainThread]:   > in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
[0m08:33:52.526977 [error] [MainThread]:   > called by model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
[0m08:33:52.526977 [info ] [MainThread]: 
[0m08:33:52.526977 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=13 TOTAL=21
[0m08:33:52.526977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735EF91C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B735A303D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7373F0970>]}
[0m08:33:52.526977 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:38:25.303930 | 10683c5a-69b1-4a43-a348-a33cc084c12c ==============================
[0m08:38:25.303930 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:38:25.303930 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': "{key:value, load_date: '2009-11-05 08:36.000000'}", 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:38:25.303930 [debug] [MainThread]: Tracking: tracking
[0m08:38:25.303930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EE8E250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EE8EDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EE8E610>]}
[0m08:38:25.443348 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:38:25.443348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EEBBDF0>]}
[0m08:38:25.646557 [debug] [MainThread]: Parsing macros\adapters.sql
[0m08:38:25.677814 [debug] [MainThread]: Parsing macros\catalog.sql
[0m08:38:25.693442 [debug] [MainThread]: Parsing macros\etc.sql
[0m08:38:25.693442 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:38:25.693442 [debug] [MainThread]: Parsing macros\materializations\copy.sql
[0m08:38:25.693442 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m08:38:25.709074 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m08:38:25.709074 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m08:38:25.709074 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:38:25.725056 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:38:25.740717 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:38:25.756347 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m08:38:25.756347 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m08:38:25.756347 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m08:38:25.771966 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m08:38:25.771966 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m08:38:25.771966 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m08:38:25.787219 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m08:38:25.803228 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m08:38:25.803228 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m08:38:25.803228 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m08:38:25.818870 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m08:38:25.818870 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m08:38:25.818870 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m08:38:25.818870 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m08:38:25.818870 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m08:38:25.818870 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m08:38:25.818870 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m08:38:25.818870 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m08:38:25.834108 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m08:38:25.834108 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m08:38:25.897007 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m08:38:25.897007 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m08:38:25.912628 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m08:38:25.928263 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m08:38:25.928263 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m08:38:25.928263 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m08:38:25.943906 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m08:38:25.943906 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m08:38:25.943906 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m08:38:25.943906 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m08:38:25.959526 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m08:38:25.975162 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m08:38:25.990777 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m08:38:26.006448 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m08:38:26.006448 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m08:38:26.021668 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m08:38:26.021668 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m08:38:26.021668 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m08:38:26.037691 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:38:26.037691 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:38:26.037691 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m08:38:26.037691 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m08:38:26.037691 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m08:38:26.037691 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:38:26.037691 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:38:26.037691 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m08:38:26.053347 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:38:26.068554 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:38:26.068554 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:38:26.068554 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m08:38:26.068554 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m08:38:26.068554 [debug] [MainThread]: Parsing macros\internal\helpers\logging.sql
[0m08:38:26.068554 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m08:38:26.084186 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m08:38:26.099814 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m08:38:26.099814 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m08:38:26.099814 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m08:38:26.099814 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m08:38:26.099814 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m08:38:26.099814 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m08:38:26.115897 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m08:38:26.131075 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m08:38:26.131075 [debug] [MainThread]: Parsing macros\internal\metadata_processing\process_payload_column_excludes.sql
[0m08:38:26.131075 [debug] [MainThread]: Parsing macros\materialisations\drop_temporary.sql
[0m08:38:26.131075 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m08:38:26.147080 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m08:38:26.147080 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m08:38:26.147080 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m08:38:26.162716 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m08:38:26.162716 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m08:38:26.193967 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m08:38:26.209589 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m08:38:26.240855 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m08:38:26.240855 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m08:38:26.256110 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m08:38:26.256110 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m08:38:26.272105 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m08:38:26.272105 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m08:38:26.272105 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m08:38:26.287368 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m08:38:26.302998 [debug] [MainThread]: Parsing macros\staging\null_columns.sql
[0m08:38:26.302998 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m08:38:26.319006 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m08:38:26.319006 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m08:38:26.334259 [debug] [MainThread]: Parsing macros\supporting\as_of_date_window.sql
[0m08:38:26.349887 [debug] [MainThread]: Parsing macros\supporting\bridge_shared.sql
[0m08:38:26.349887 [debug] [MainThread]: Parsing macros\supporting\cast_binary.sql
[0m08:38:26.365517 [debug] [MainThread]: Parsing macros\supporting\cast_date.sql
[0m08:38:26.365517 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m08:38:26.365517 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m08:38:26.381152 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m08:38:26.381152 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m08:38:26.412786 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m08:38:26.428406 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m08:38:26.428406 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m08:38:26.428406 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m08:38:26.444056 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m08:38:26.459300 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m08:38:26.475305 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m08:38:26.490942 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m08:38:26.506188 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m08:38:26.506188 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m08:38:26.506188 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m08:38:26.506188 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
[0m08:38:26.506188 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
[0m08:38:26.506188 [debug] [MainThread]: Parsing macros\tables\databricks\sat.sql
[0m08:38:26.506188 [debug] [MainThread]: Parsing macros\tables\postgres\hub.sql
[0m08:38:26.522202 [debug] [MainThread]: Parsing macros\tables\postgres\link.sql
[0m08:38:26.537899 [debug] [MainThread]: Parsing macros\tables\postgres\sat.sql
[0m08:38:26.553457 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m08:38:26.553457 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m08:38:26.584811 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m08:38:26.599963 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m08:38:26.615594 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m08:38:26.631228 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m08:38:26.662860 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m08:38:26.678504 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m08:38:26.678504 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m08:38:26.709760 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m08:38:26.709760 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m08:38:26.725386 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m08:38:26.725386 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m08:38:26.741037 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m08:38:26.756648 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m08:38:26.756648 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m08:38:26.756648 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m08:38:26.756648 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m08:38:26.756648 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\xdb_deprecation_warning.sql
[0m08:38:26.772269 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m08:38:26.772269 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m08:38:26.772269 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m08:38:26.772269 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m08:38:26.772269 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m08:38:26.787902 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m08:38:26.787902 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m08:38:26.787902 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m08:38:26.803545 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m08:38:26.803545 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m08:38:26.803545 [debug] [MainThread]: Parsing macros\generic_tests\not_empty_string.sql
[0m08:38:26.803545 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m08:38:26.803545 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m08:38:26.818908 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m08:38:26.818908 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m08:38:26.818908 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m08:38:26.818908 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m08:38:26.818908 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m08:38:26.818908 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m08:38:26.818908 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m08:38:26.818908 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_ephemeral.sql
[0m08:38:26.834411 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_relation.sql
[0m08:38:26.834411 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m08:38:26.834411 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m08:38:26.834411 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m08:38:26.850042 [debug] [MainThread]: Parsing macros\sql\generate_surrogate_key.sql
[0m08:38:26.850042 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m08:38:26.850042 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m08:38:26.850042 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m08:38:26.850042 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m08:38:26.865671 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m08:38:26.865671 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m08:38:26.865671 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m08:38:26.881302 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m08:38:26.881302 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m08:38:26.881302 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m08:38:26.881302 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m08:38:26.881302 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m08:38:26.881302 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m08:38:26.897352 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m08:38:26.897352 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m08:38:26.897352 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m08:38:26.897352 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m08:38:26.912953 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m08:38:26.928192 [debug] [MainThread]: Parsing macros\sql\width_bucket.sql
[0m08:38:26.928192 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m08:38:26.928192 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m08:38:26.928192 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m08:38:27.819474 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m08:38:27.835187 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m08:38:27.835187 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m08:38:27.835187 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m08:38:27.850331 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m08:38:27.850331 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_order.sql
[0m08:38:27.850331 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m08:38:27.865958 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m08:38:27.865958 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m08:38:27.991392 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m08:38:27.991392 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m08:38:28.007031 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m08:38:28.007031 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m08:38:28.022656 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m08:38:28.022656 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m08:38:28.069540 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m08:38:28.069540 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m08:38:28.085180 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m08:38:28.085180 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m08:38:28.163373 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m08:38:28.163373 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order.sql
[0m08:38:28.194579 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order.sql
[0m08:38:28.194579 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m08:38:28.225902 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m08:38:28.241072 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m08:38:28.272334 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m08:38:28.272334 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m08:38:28.429031 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m08:38:28.429031 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_order.sql
[0m08:38:28.491164 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_order.sql
[0m08:38:28.491164 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m08:38:28.553670 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m08:38:28.553670 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m08:38:28.600573 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m08:38:28.819766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EF4AAC0>]}
[0m08:38:28.835007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EE8E610>]}
[0m08:38:28.835007 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:38:28.835007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EE8A940>]}
[0m08:38:28.835007 [info ] [MainThread]: 
[0m08:38:28.835007 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:38:28.835007 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:38:28.835007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:29.524961 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m08:38:29.524961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:29.930961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EEBB040>]}
[0m08:38:29.946569 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:38:29.946569 [info ] [MainThread]: 
[0m08:38:29.946569 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:38:29.946569 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:38:29.946569 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:38:29.946569 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_order
[0m08:38:29.946569 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m08:38:29.946569 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m08:38:29.946569 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m08:38:29.946569 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_order ................................ [RUN]
[0m08:38:29.962198 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:38:29.962198 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:38:29.962198 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:38:29.962198 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:38:29.962198 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:38:29.962198 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:38:29.962198 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:38:29.962198 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:38:29.962198 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:38:29.962198 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:38:29.962198 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:38:29.962198 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:38:29.977830 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_order
[0m08:38:29.977830 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:38:29.977830 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_order
[0m08:38:29.977830 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:29.977830 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:29.977830 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:38:29.977830 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:38:29.977830 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:38:29.977830 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:30.024717 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:38:30.040348 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:38:30.040348 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:38:30.040348 [debug] [Thread-4  ]: finished collecting timing info
[0m08:38:30.040348 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:38:30.040348 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_order
[0m08:38:30.040348 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:38:30.040348 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:38:30.040348 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m08:38:30.040348 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:38:30.040348 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m08:38:30.055976 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:38:30.055976 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m08:38:30.055976 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:38:30.055976 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m08:38:31.400152 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:31.400152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EFE1610>]}
[0m08:38:31.400152 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.45s]
[0m08:38:31.415779 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:31.415779 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EFE7B80>]}
[0m08:38:31.415779 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.45s]
[0m08:38:31.415779 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:38:31.415779 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:38:31.415779 [info ] [Thread-6  ]: 5 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m08:38:31.415779 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:38:31.415779 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m08:38:31.415779 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:38:31.415779 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:38:31.415779 [info ] [Thread-8  ]: 6 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m08:38:31.415779 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:38:31.431401 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m08:38:31.431401 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m08:38:31.431401 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:38:31.431401 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:38:31.447027 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m08:38:31.478284 [debug] [Thread-4  ]: finished collecting timing info
[0m08:38:31.478284 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EF1FF70>]}
[0m08:38:31.478284 [info ] [Thread-4  ]: 4 of 21 OK created view model data_vault.v_raw_order ........................... [[32mOK[0m in 1.52s]
[0m08:38:31.478284 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_order
[0m08:38:31.478284 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_stg_order
[0m08:38:31.478284 [info ] [Thread-1  ]: 7 of 21 START view model data_vault.v_stg_order ................................ [RUN]
[0m08:38:31.478284 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_order"
[0m08:38:31.478284 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_order
[0m08:38:31.478284 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_stg_order
[0m08:38:31.493913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:38:32.228536 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:32.228536 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EF1F880>]}
[0m08:38:32.228536 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 2.27s]
[0m08:38:32.228536 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:38:32.228536 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:38:32.228536 [info ] [Thread-2  ]: 8 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m08:38:32.228536 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m08:38:32.228536 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:38:32.244142 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:38:32.244142 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:38:32.353551 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m08:38:32.369182 [debug] [Thread-8  ]: finished collecting timing info
[0m08:38:32.369182 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:38:32.369182 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m08:38:32.369182 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_stg_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_US_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    CUSTOMER_NUMBER AS `US_CUSTOMER_KEY`,
    '101' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`US_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:38:32.509849 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_order"
[0m08:38:32.525479 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:32.525479 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_order
[0m08:38:32.525479 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_order"
[0m08:38:32.541110 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_stg_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_order`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_order`
),

derived_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    ORDER_NUMBER AS `ORDER_KEY`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    '2' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), '')))) AS STRING) AS `ORDER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_ORDER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_PRICE` AS STRING))), ''), '^^')
    )))) AS `ORDER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `ORDER_HK`,
    `CUSTOMER_HK`,
    `CUSTOMER_ORDER_HK`,
    `ORDER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:38:32.556737 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m08:38:32.556737 [debug] [Thread-6  ]: finished collecting timing info
[0m08:38:32.556737 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:38:32.572369 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m08:38:32.572369 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_stg_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '1' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`TITLE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`WEALTH_BRACKET` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:38:33.056888 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m08:38:33.056888 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:33.056888 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:38:33.056888 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m08:38:33.056888 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
),

derived_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '3' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`DESCRIPTION` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`NAME` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:38:33.541434 [debug] [Thread-8  ]: finished collecting timing info
[0m08:38:33.541434 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175F2AC970>]}
[0m08:38:33.541434 [info ] [Thread-8  ]: 6 of 21 OK created view model data_vault.v_stg_US_customer ..................... [[32mOK[0m in 2.11s]
[0m08:38:33.541434 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:38:33.557041 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:38:33.557041 [info ] [Thread-4  ]: 9 of 21 START incremental model data_vault.sat_US_customer ..................... [RUN]
[0m08:38:33.557041 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_US_customer"
[0m08:38:33.557041 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:38:33.557041 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.sat_US_customer
[0m08:38:33.588301 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m08:38:33.588301 [debug] [Thread-4  ]: finished collecting timing info
[0m08:38:33.588301 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:38:33.635190 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:38:33.650818 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:33.650818 [debug] [Thread-6  ]: finished collecting timing info
[0m08:38:33.650818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217603FBF40>]}
[0m08:38:33.650818 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EFE7B80>]}
[0m08:38:33.650818 [info ] [Thread-1  ]: 7 of 21 OK created view model data_vault.v_stg_order ........................... [[32mOK[0m in 2.17s]
[0m08:38:33.650818 [info ] [Thread-6  ]: 5 of 21 OK created view model data_vault.v_stg_UK_customer ..................... [[32mOK[0m in 2.24s]
[0m08:38:33.650818 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_order
[0m08:38:33.666448 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m08:38:33.666448 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m08:38:33.666448 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.sat_order
[0m08:38:33.666448 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:38:33.666448 [info ] [Thread-3  ]: 10 of 21 START incremental model data_vault.hub_order .......................... [RUN]
[0m08:38:33.666448 [info ] [Thread-5  ]: 11 of 21 START incremental model data_vault.link_customer_order ................ [RUN]
[0m08:38:33.666448 [info ] [Thread-8  ]: 12 of 21 START incremental model data_vault.sat_order .......................... [RUN]
[0m08:38:33.666448 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m08:38:33.666448 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:38:33.666448 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:38:33.666448 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_order"
[0m08:38:33.666448 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_order"
[0m08:38:33.666448 [info ] [Thread-1  ]: 13 of 21 START incremental model data_vault.hub_customer ....................... [RUN]
[0m08:38:33.666448 [info ] [Thread-7  ]: 14 of 21 START incremental model data_vault.link_customer_wealth_bracket_customer  [RUN]
[0m08:38:33.666448 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_order"
[0m08:38:33.666448 [info ] [Thread-6  ]: 15 of 21 START incremental model data_vault.sat_UK_customer .................... [RUN]
[0m08:38:33.666448 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.hub_order
[0m08:38:33.666448 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_order
[0m08:38:33.666448 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer"
[0m08:38:33.666448 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.sat_order
[0m08:38:33.666448 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m08:38:33.666448 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.hub_order
[0m08:38:33.666448 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.link_customer_order
[0m08:38:33.666448 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m08:38:33.666448 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer
[0m08:38:33.666448 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.sat_order
[0m08:38:33.666448 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:38:33.697708 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:38:33.697708 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.hub_customer
[0m08:38:33.713337 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:38:33.713337 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:38:33.744598 [info ] [Thread-3  ]: 08:38:33 + Loading steadfast-task-363413.data_vault.hub_order from 1 source(s)
[0m08:38:33.854006 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m08:38:33.854006 [info ] [Thread-1  ]: 08:38:33 + Loading steadfast-task-363413.data_vault.hub_customer from 2 source(s)
[0m08:38:33.854006 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:33.854006 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.hub_order
[0m08:38:33.869636 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:38:33.885264 [info ] [Thread-7  ]: 08:38:33 + Loading steadfast-task-363413.data_vault.link_customer_wealth_bracket_customer from 1 source(s)
[0m08:38:33.900894 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m08:38:33.916525 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m08:38:33.916525 [debug] [Thread-7  ]: finished collecting timing info
[0m08:38:33.916525 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:38:33.947787 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m08:38:33.932159 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_order"
[0m08:38:33.947787 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:33.947787 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer
[0m08:38:33.963412 [info ] [Thread-5  ]: 08:38:33 + Loading steadfast-task-363413.data_vault.link_customer_order from 1 source(s)
[0m08:38:33.963412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:38:33.979044 [debug] [Thread-8  ]: finished collecting timing info
[0m08:38:33.994675 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.sat_order
[0m08:38:34.010304 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m08:38:34.010304 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m08:38:34.041566 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m08:38:34.072823 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m08:38:34.072823 [debug] [Thread-5  ]: finished collecting timing info
[0m08:38:34.088451 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_order
[0m08:38:34.088451 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m08:38:34.088451 [debug] [Thread-6  ]: finished collecting timing info
[0m08:38:34.088451 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:38:34.088451 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.sat_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_US_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_US_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_US_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:38:34.104081 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m08:38:34.338527 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:34.338527 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021760423F70>]}
[0m08:38:34.338527 [info ] [Thread-2  ]: 8 of 21 OK created view model data_vault.v_stg_customer_wealth_bracket ......... [[32mOK[0m in 2.11s]
[0m08:38:34.338527 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:38:34.338527 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:38:34.338527 [info ] [Thread-2  ]: 16 of 21 START incremental model data_vault.hub_customer_wealth_bracket ........ [RUN]
[0m08:38:34.338527 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m08:38:34.338527 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:38:34.338527 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:38:34.354156 [info ] [Thread-2  ]: 08:38:34 + Loading steadfast-task-363413.data_vault.hub_customer_wealth_bracket from 1 source(s)
[0m08:38:34.369785 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m08:38:34.369785 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:34.369785 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:38:34.369785 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:38:34.447935 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m08:38:34.447935 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`ORDER_HK`, rr.`ORDER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_order` AS rr
    WHERE rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`ORDER_HK`, a.`ORDER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_order` AS d
    ON a.`ORDER_HK` = d.`ORDER_HK`
    WHERE d.`ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:38:34.463564 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m08:38:34.463564 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m08:38:34.463564 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`CUSTOMER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NOT NULL
    AND rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` = d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:38:34.463564 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.`CUSTOMER_HK`
               ORDER BY ru.`LOAD_DATE`, ru.`RECORD_SOURCE` ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_union AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer` AS d
    ON a.`CUSTOMER_HK` = d.`CUSTOMER_HK`
    WHERE d.`CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:38:34.479194 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m08:38:34.479194 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.sat_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_UK_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`TITLE`, a.`WEALTH_BRACKET`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_UK_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`TITLE`, stage.`WEALTH_BRACKET`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:38:34.541715 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_order"
[0m08:38:34.541715 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m08:38:34.557342 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_order` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_ORDER_HK`, rr.`CUSTOMER_HK`, rr.`ORDER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_order` AS rr
    WHERE rr.`CUSTOMER_ORDER_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    AND rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_ORDER_HK`, a.`CUSTOMER_HK`, a.`ORDER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_order` AS d
    ON a.`CUSTOMER_ORDER_HK` = d.`CUSTOMER_ORDER_HK`
    WHERE d.`CUSTOMER_ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:38:34.557342 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.sat_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`ORDER_ID`, a.`ORDER_PRICE`, a.`CUSTOMER_ID`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_order` AS a
    WHERE a.`ORDER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`ORDER_HK`, current_records.`ORDER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`ORDER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_order` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`ORDER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`ORDER_HK` = source_records.`ORDER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`ORDER_HK`, stage.`ORDER_HASHDIFF`, stage.`ORDER_ID`, stage.`ORDER_PRICE`, stage.`CUSTOMER_ID`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`ORDER_HK` = stage.`ORDER_HK`
        AND latest_records.`ORDER_HASHDIFF` = stage.`ORDER_HASHDIFF`
    WHERE latest_records.`ORDER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_HASHDIFF`, `ORDER_ID`, `ORDER_PRICE`, `CUSTOMER_ID`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_HASHDIFF`, `ORDER_ID`, `ORDER_PRICE`, `CUSTOMER_ID`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:38:34.791809 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m08:38:34.791809 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.hub_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`ID`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`ID`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_HK` = d.`CUSTOMER_WEALTH_BRACKET_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:38:37.761453 [debug] [Thread-4  ]: finished collecting timing info
[0m08:38:37.761453 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175F37E5E0>]}
[0m08:38:37.761453 [info ] [Thread-4  ]: 9 of 21 OK created incremental model data_vault.sat_US_customer ................ [[32mMERGE (0.0 rows, 441.0 Bytes processed)[0m in 4.20s]
[0m08:38:37.761453 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:38:37.761453 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:38:37.761453 [info ] [Thread-4  ]: 17 of 21 START incremental model data_vault.sat_customer_wealth_bracket ........ [RUN]
[0m08:38:37.761453 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m08:38:37.761453 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:38:37.761453 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:38:37.793167 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m08:38:37.793167 [debug] [Thread-4  ]: finished collecting timing info
[0m08:38:37.793167 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:38:37.808332 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:38:37.823980 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:37.823980 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217603FD3A0>]}
[0m08:38:37.823980 [info ] [Thread-3  ]: 10 of 21 OK created incremental model data_vault.hub_order ..................... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 4.16s]
[0m08:38:37.823980 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m08:38:38.230354 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:38.230354 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m08:38:38.230354 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002176042B7F0>]}
[0m08:38:38.245975 [info ] [Thread-2  ]: 16 of 21 OK created incremental model data_vault.hub_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 870.0 Bytes processed)[0m in 3.89s]
[0m08:38:38.245975 [debug] [Thread-7  ]: finished collecting timing info
[0m08:38:38.245975 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217604B1700>]}
[0m08:38:38.245975 [info ] [Thread-7  ]: 14 of 21 OK created incremental model data_vault.link_customer_wealth_bracket_customer  [[32mMERGE (0.0 rows, 870.0 Bytes processed)[0m in 4.58s]
[0m08:38:38.245975 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.sat_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`NAME`, a.`DESCRIPTION`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS a
    WHERE a.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_WEALTH_BRACKET_HK`, current_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_WEALTH_BRACKET_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_WEALTH_BRACKET_HK` = source_records.`CUSTOMER_WEALTH_BRACKET_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_WEALTH_BRACKET_HK`, stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, stage.`NAME`, stage.`DESCRIPTION`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_WEALTH_BRACKET_HK` = stage.`CUSTOMER_WEALTH_BRACKET_HK`
        AND latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` = stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`
    WHERE latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:38:38.245975 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:38:38.245975 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:38:38.339742 [debug] [Thread-5  ]: finished collecting timing info
[0m08:38:38.339742 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217603FDE50>]}
[0m08:38:38.339742 [info ] [Thread-5  ]: 11 of 21 OK created incremental model data_vault.link_customer_order ........... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 4.67s]
[0m08:38:38.339742 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m08:38:38.558559 [debug] [Thread-1  ]: finished collecting timing info
[0m08:38:38.558559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021760485D90>]}
[0m08:38:38.558559 [info ] [Thread-1  ]: 13 of 21 OK created incremental model data_vault.hub_customer .................. [[32mMERGE (0.0 rows, 1.4 KB processed)[0m in 4.89s]
[0m08:38:38.558559 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m08:38:38.761763 [debug] [Thread-6  ]: finished collecting timing info
[0m08:38:38.761763 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217604B1CD0>]}
[0m08:38:38.761763 [info ] [Thread-6  ]: 15 of 21 OK created incremental model data_vault.sat_UK_customer ............... [[32mMERGE (0.0 rows, 2.6 KB processed)[0m in 5.10s]
[0m08:38:38.761763 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:38:38.761763 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:38:38.761763 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:38:38.761763 [info ] [Thread-3  ]: 18 of 21 START view model data_vault.v_comp_customer_history ................... [RUN]
[0m08:38:38.761763 [info ] [Thread-2  ]: 19 of 21 START view model data_vault.v_comp_customers_as_is .................... [RUN]
[0m08:38:38.761763 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m08:38:38.761763 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:38:38.761763 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m08:38:38.761763 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:38:38.761763 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:38:38.777374 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m08:38:38.777374 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:38:38.777374 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m08:38:38.777374 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:38.777374 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:38.777374 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:38:38.777374 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:38:38.793003 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m08:38:38.793003 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m08:38:38.793003 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:38:38.793003 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_comp_customer_history: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_history"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_history`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.customer_id, s_uk.first_name,
        s_uk.last_name, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
        s_uk.effective_from, s_uk.crud_flag, s_uk.load_date
        from h, s_uk
        where s_uk.customer_hk = h.customer_hk
        union all
        select h.customer_hk, h.customer_number, s_us.customer_id, s_us.first_name,
        s_us.last_name, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
        s_us.effective_from, s_us.crud_flag, s_us.load_date
        from h, s_us
        where s_us.customer_hk = h.customer_hk)
select * from joined;


[0m08:38:38.793003 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:38:38.793003 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_comp_customers_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customers_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number, record_source
        from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.crud_flag, s_uk.customer_id,
                s_uk.title, s_uk.first_name, s_uk.last_name, s_uk.wealth_bracket, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
                s_uk.effective_from, s_uk.load_date, h.record_source,
                row_number() over(partition by s_uk.customer_hk order by s_uk.applieddate desc) as rn
         from h, s_uk
         where s_uk.customer_hk = h.customer_hk
         union all
         select h.customer_hk, h.customer_number, s_us.crud_flag, s_us.customer_id,
                '' as title, s_us.first_name, s_us.last_name, null as wealth_bracket, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
                s_us.effective_from, s_us.load_date, h.record_source,
                row_number() over(partition by s_us.customer_hk order by s_us.applieddate desc) as rn
         from h, s_us
         )
select customer_hk, customer_id, customer_number, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate, applieddate, effective_from, load_date, record_source from joined
where rn = 1 and crud_flag <> 'D';


[0m08:38:39.980876 [debug] [Thread-2  ]: finished collecting timing info
[0m08:38:39.980876 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021760485BB0>]}
[0m08:38:39.980876 [info ] [Thread-2  ]: 19 of 21 OK created view model data_vault.v_comp_customers_as_is ............... [[32mOK[0m in 1.22s]
[0m08:38:39.980876 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:38:40.090296 [debug] [Thread-3  ]: finished collecting timing info
[0m08:38:40.090296 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217605DE970>]}
[0m08:38:40.090296 [info ] [Thread-3  ]: 18 of 21 OK created view model data_vault.v_comp_customer_history .............. [[32mOK[0m in 1.33s]
[0m08:38:40.090296 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:38:42.169042 [debug] [Thread-4  ]: finished collecting timing info
[0m08:38:42.169042 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EF29F40>]}
[0m08:38:42.169042 [info ] [Thread-4  ]: 17 of 21 OK created incremental model data_vault.sat_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 1.3 KB processed)[0m in 4.41s]
[0m08:38:42.169042 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:38:52.687866 [debug] [Thread-8  ]: finished collecting timing info
[0m08:38:52.687866 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217605E1250>]}
[0m08:38:52.687866 [info ] [Thread-8  ]: 12 of 21 OK created incremental model data_vault.sat_order ..................... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 19.02s]
[0m08:38:52.687866 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.sat_order
[0m08:38:52.687866 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:38:52.687866 [info ] [Thread-5  ]: 20 of 21 START view model data_vault.v_comp_orders_as_is ....................... [RUN]
[0m08:38:52.687866 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m08:38:52.687866 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:38:52.687866 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:38:52.703492 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m08:38:52.703492 [debug] [Thread-5  ]: finished collecting timing info
[0m08:38:52.703492 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:38:52.703492 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m08:38:52.703492 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m08:38:52.703492 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.v_comp_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`
  OPTIONS()
  as with
    h as
        (select order_hk, order_number, record_source from `steadfast-task-363413`.`data_vault`.`hub_order`),
    s as
        (select order_hk, order_id, order_price, lastmodifieddate, createddate, effective_from, load_date,
         crud_flag, row_number() over(partition by order_hk order by lastmodifieddate desc) as rn
         from `steadfast-task-363413`.`data_vault`.`sat_order`),
    co as
        (select order_hk, customer_hk from `steadfast-task-363413`.`data_vault`.`link_customer_order` ),
    joined as
        (select h.order_hk, h.order_number,
            co.customer_hk,
            s.order_id, s.order_price, s.lastmodifieddate, s.createddate, h.record_source, s.effective_from,
            s.load_date, s.crud_flag, s.rn
         from h, s, co
        where s.order_hk = h.order_hk
        and co.order_hk = h.order_hk)
select order_hk, customer_hk, order_id, order_number, order_price, lastmodifieddate, createddate,
effective_from, load_date
from joined
where rn = 1 and crud_flag <> 'D';


[0m08:38:54.110163 [debug] [Thread-5  ]: finished collecting timing info
[0m08:38:54.110163 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175F2A0490>]}
[0m08:38:54.110163 [info ] [Thread-5  ]: 20 of 21 OK created view model data_vault.v_comp_orders_as_is .................. [[32mOK[0m in 1.42s]
[0m08:38:54.110163 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:38:54.110163 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:38:54.110163 [info ] [Thread-6  ]: 21 of 21 START view model data_vault.v_comp_customer_orders_as_is .............. [RUN]
[0m08:38:54.110163 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m08:38:54.110163 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:38:54.110163 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:38:54.110163 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m08:38:54.125788 [debug] [Thread-6  ]: finished collecting timing info
[0m08:38:54.125788 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:38:54.125788 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m08:38:54.125788 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m08:38:54.125788 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_orders_as_is`
  OPTIONS()
  as with
    c as
        (select customer_hk, customer_number, first_name, last_name
         from `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`),
    o as
        (select customer_hk, order_number, order_price, createddate, lastmodifieddate
         from `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`),
    joined as
        (select c.customer_number, c.first_name, c.last_name, o.order_number, o.order_price,
         o.createddate, o.lastmodifieddate
         from c, o
         where o.customer_hk = c.customer_hk)
select * from joined;


[0m08:38:55.329295 [debug] [Thread-6  ]: finished collecting timing info
[0m08:38:55.329295 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10683c5a-69b1-4a43-a348-a33cc084c12c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217603F4FA0>]}
[0m08:38:55.329295 [info ] [Thread-6  ]: 21 of 21 OK created view model data_vault.v_comp_customer_orders_as_is ......... [[32mOK[0m in 1.22s]
[0m08:38:55.329295 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:38:55.344903 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:38:55.344903 [info ] [MainThread]: 
[0m08:38:55.344903 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 26.51 seconds (26.51s).
[0m08:38:55.344903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:55.344903 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:38:55.344903 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m08:38:55.344903 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_customer' was properly closed.
[0m08:38:55.344903 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customers_as_is' was properly closed.
[0m08:38:55.344903 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_history' was properly closed.
[0m08:38:55.344903 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_customer_wealth_bracket' was properly closed.
[0m08:38:55.344903 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is' was properly closed.
[0m08:38:55.344903 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_order' was properly closed.
[0m08:38:55.344903 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_orders_as_is' was properly closed.
[0m08:38:55.344903 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer' was properly closed.
[0m08:38:55.360530 [info ] [MainThread]: 
[0m08:38:55.360530 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:38:55.360530 [info ] [MainThread]: 
[0m08:38:55.360530 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m08:38:55.360530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217606C7EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175EF4A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002175F19BBE0>]}
[0m08:38:55.360530 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:41:19.576643 | c94d038a-e7b7-43f4-a75c-b9babc9ef037 ==============================
[0m08:41:19.576643 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:41:19.576643 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': "{key:value, load_date: '2009-11-05 08:36.000000'}", 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:41:19.576643 [debug] [MainThread]: Tracking: tracking
[0m08:41:19.576643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76683D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76683D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76683D790>]}
[0m08:41:19.917213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:41:19.917213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:41:19.932840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766B2A0D0>]}
[0m08:41:20.026625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766AF7130>]}
[0m08:41:20.026625 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:41:20.026625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766776D30>]}
[0m08:41:20.026625 [info ] [MainThread]: 
[0m08:41:20.026625 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:41:20.057880 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:41:20.057880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:20.948794 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m08:41:20.948794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:21.292626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766776AF0>]}
[0m08:41:21.292626 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:41:21.292626 [info ] [MainThread]: 
[0m08:41:21.308258 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:41:21.308258 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:41:21.308258 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:41:21.308258 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_order
[0m08:41:21.308258 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m08:41:21.308258 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m08:41:21.308258 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m08:41:21.308258 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_order ................................ [RUN]
[0m08:41:21.308258 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:41:21.308258 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:41:21.308258 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:41:21.308258 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:41:21.308258 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:41:21.308258 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:41:21.308258 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:41:21.308258 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:41:21.308258 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:41:21.323889 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:41:21.323889 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:41:21.323889 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_order
[0m08:41:21.323889 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:41:21.323889 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_order
[0m08:41:21.323889 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:41:21.339516 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:41:21.339516 [debug] [Thread-1  ]: finished collecting timing info
[0m08:41:21.339516 [debug] [Thread-2  ]: finished collecting timing info
[0m08:41:21.339516 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:41:21.339516 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:41:21.370777 [debug] [Thread-3  ]: finished collecting timing info
[0m08:41:21.417664 [debug] [Thread-4  ]: finished collecting timing info
[0m08:41:21.417664 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:41:21.433298 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:41:21.433298 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:41:21.433298 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_order
[0m08:41:21.433298 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:41:21.433298 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:41:21.448924 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:41:21.448924 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:41:21.448924 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m08:41:21.448924 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m08:41:21.448924 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:41:21.448924 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:41:21.448924 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m08:41:21.448924 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m08:41:22.423289 [debug] [Thread-2  ]: finished collecting timing info
[0m08:41:22.423289 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766AEF910>]}
[0m08:41:22.423289 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.12s]
[0m08:41:22.423289 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:41:22.423289 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:41:22.423289 [info ] [Thread-6  ]: 5 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m08:41:22.423289 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m08:41:22.423289 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:41:22.423289 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:41:22.470171 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m08:41:22.610840 [debug] [Thread-4  ]: finished collecting timing info
[0m08:41:22.610840 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766AEF880>]}
[0m08:41:22.610840 [info ] [Thread-4  ]: 4 of 21 OK created view model data_vault.v_raw_order ........................... [[32mOK[0m in 1.30s]
[0m08:41:22.610840 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_order
[0m08:41:22.610840 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_order
[0m08:41:22.610840 [info ] [Thread-8  ]: 6 of 21 START view model data_vault.v_stg_order ................................ [RUN]
[0m08:41:22.610840 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_order"
[0m08:41:22.610840 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_order
[0m08:41:22.610840 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_order
[0m08:41:22.626471 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m08:41:22.688988 [debug] [Thread-3  ]: finished collecting timing info
[0m08:41:22.688988 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766AEF850>]}
[0m08:41:22.688988 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.38s]
[0m08:41:22.688988 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:41:22.688988 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:41:22.688988 [info ] [Thread-2  ]: 7 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m08:41:22.688988 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m08:41:22.688988 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:41:22.688988 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:41:22.704624 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:41:22.792518 [debug] [Thread-1  ]: finished collecting timing info
[0m08:41:22.792518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766B8DE80>]}
[0m08:41:22.792518 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.48s]
[0m08:41:22.792518 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:41:22.792518 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:41:22.792518 [info ] [Thread-4  ]: 8 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m08:41:22.792518 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m08:41:22.792518 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:41:22.792518 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:41:22.808148 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:41:23.433338 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m08:41:23.433338 [debug] [Thread-6  ]: finished collecting timing info
[0m08:41:23.433338 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:41:23.448966 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m08:41:23.448966 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_stg_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_US_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    CUSTOMER_NUMBER AS `US_CUSTOMER_KEY`,
    '101' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`US_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:41:23.574008 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m08:41:23.574008 [debug] [Thread-2  ]: finished collecting timing info
[0m08:41:23.574008 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:41:23.574008 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m08:41:23.589640 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
),

derived_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '3' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`DESCRIPTION` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`NAME` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:41:23.636528 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_order"
[0m08:41:23.636528 [debug] [Thread-8  ]: finished collecting timing info
[0m08:41:23.636528 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_order
[0m08:41:23.652155 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_order"
[0m08:41:23.652155 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_stg_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_order`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_order`
),

derived_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    ORDER_NUMBER AS `ORDER_KEY`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    '2' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), '')))) AS STRING) AS `ORDER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_ORDER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_PRICE` AS STRING))), ''), '^^')
    )))) AS `ORDER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `ORDER_HK`,
    `CUSTOMER_HK`,
    `CUSTOMER_ORDER_HK`,
    `ORDER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:41:23.902232 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m08:41:23.902232 [debug] [Thread-4  ]: finished collecting timing info
[0m08:41:23.902232 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:41:23.902232 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m08:41:23.902232 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_stg_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '1' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`TITLE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`WEALTH_BRACKET` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:41:24.464902 [debug] [Thread-2  ]: finished collecting timing info
[0m08:41:24.464902 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766CA4E50>]}
[0m08:41:24.464902 [info ] [Thread-2  ]: 7 of 21 OK created view model data_vault.v_stg_customer_wealth_bracket ......... [[32mOK[0m in 1.78s]
[0m08:41:24.464902 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:41:24.464902 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:41:24.464902 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:41:24.464902 [info ] [Thread-3  ]: 9 of 21 START incremental model data_vault.hub_customer_wealth_bracket ......... [RUN]
[0m08:41:24.464902 [info ] [Thread-7  ]: 10 of 21 START incremental model data_vault.sat_customer_wealth_bracket ........ [RUN]
[0m08:41:24.464902 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m08:41:24.464902 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:41:24.464902 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:41:24.464902 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m08:41:24.480533 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:41:24.480533 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:41:24.543049 [info ] [Thread-3  ]: 08:41:24 + Loading steadfast-task-363413.data_vault.hub_customer_wealth_bracket from 1 source(s)
[0m08:41:24.621201 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m08:41:24.636831 [debug] [Thread-3  ]: finished collecting timing info
[0m08:41:24.636831 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:41:24.730628 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m08:41:24.730628 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:41:24.746240 [debug] [Thread-7  ]: finished collecting timing info
[0m08:41:24.746240 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:41:24.746240 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m08:41:24.746240 [debug] [Thread-6  ]: finished collecting timing info
[0m08:41:24.761866 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767E7C2E0>]}
[0m08:41:24.761866 [info ] [Thread-6  ]: 5 of 21 OK created view model data_vault.v_stg_US_customer ..................... [[32mOK[0m in 2.32s]
[0m08:41:24.761866 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:41:24.761866 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:41:24.761866 [info ] [Thread-5  ]: 11 of 21 START incremental model data_vault.sat_US_customer .................... [RUN]
[0m08:41:24.761866 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_US_customer"
[0m08:41:24.761866 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:41:24.761866 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.sat_US_customer
[0m08:41:24.793127 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m08:41:24.793127 [debug] [Thread-5  ]: finished collecting timing info
[0m08:41:24.793127 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:41:24.808754 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m08:41:24.965074 [debug] [Thread-8  ]: finished collecting timing info
[0m08:41:24.965074 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767ECA220>]}
[0m08:41:24.965074 [info ] [Thread-8  ]: 6 of 21 OK created view model data_vault.v_stg_order ........................... [[32mOK[0m in 2.35s]
[0m08:41:24.965074 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_order
[0m08:41:24.965074 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m08:41:24.965074 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m08:41:24.965074 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.sat_order
[0m08:41:24.980694 [info ] [Thread-1  ]: 12 of 21 START incremental model data_vault.hub_order .......................... [RUN]
[0m08:41:24.980694 [info ] [Thread-6  ]: 13 of 21 START incremental model data_vault.link_customer_order ................ [RUN]
[0m08:41:24.980694 [info ] [Thread-2  ]: 14 of 21 START incremental model data_vault.sat_order .......................... [RUN]
[0m08:41:24.980694 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_order"
[0m08:41:24.980694 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.hub_order
[0m08:41:24.980694 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_order"
[0m08:41:24.980694 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.hub_order
[0m08:41:24.980694 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_order
[0m08:41:24.980694 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_order"
[0m08:41:25.043203 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.link_customer_order
[0m08:41:25.043203 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.sat_order
[0m08:41:25.058830 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.sat_order
[0m08:41:25.105720 [debug] [Thread-4  ]: finished collecting timing info
[0m08:41:25.105720 [info ] [Thread-6  ]: 08:41:25 + Loading steadfast-task-363413.data_vault.link_customer_order from 1 source(s)
[0m08:41:25.105720 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767DB2D00>]}
[0m08:41:25.105720 [info ] [Thread-4  ]: 8 of 21 OK created view model data_vault.v_stg_UK_customer ..................... [[32mOK[0m in 2.31s]
[0m08:41:25.152609 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:41:25.152609 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m08:41:25.152609 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m08:41:25.152609 [info ] [Thread-8  ]: 15 of 21 START incremental model data_vault.hub_customer ....................... [RUN]
[0m08:41:25.152609 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:41:25.152609 [info ] [Thread-1  ]: 08:41:25 + Loading steadfast-task-363413.data_vault.hub_order from 1 source(s)
[0m08:41:25.152609 [info ] [Thread-4  ]: 16 of 21 START incremental model data_vault.link_customer_wealth_bracket_customer  [RUN]
[0m08:41:25.168241 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer"
[0m08:41:25.168241 [debug] [Thread-6  ]: finished collecting timing info
[0m08:41:25.168241 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer
[0m08:41:25.168241 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m08:41:25.168241 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m08:41:25.168241 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_order
[0m08:41:25.183873 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.hub_customer
[0m08:41:25.183873 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:41:25.199502 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_order"
[0m08:41:25.230759 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m08:41:25.246389 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m08:41:25.262023 [debug] [Thread-1  ]: finished collecting timing info
[0m08:41:25.262023 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m08:41:25.262023 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:41:25.262023 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m08:41:25.262023 [info ] [Thread-8  ]: 08:41:25 + Loading steadfast-task-363413.data_vault.hub_customer from 2 source(s)
[0m08:41:25.262023 [debug] [Thread-2  ]: finished collecting timing info
[0m08:41:25.262023 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.hub_order
[0m08:41:25.277651 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.sat_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`NAME`, a.`DESCRIPTION`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS a
    WHERE a.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_WEALTH_BRACKET_HK`, current_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_WEALTH_BRACKET_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_WEALTH_BRACKET_HK` = source_records.`CUSTOMER_WEALTH_BRACKET_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_WEALTH_BRACKET_HK`, stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, stage.`NAME`, stage.`DESCRIPTION`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_WEALTH_BRACKET_HK` = stage.`CUSTOMER_WEALTH_BRACKET_HK`
        AND latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` = stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`
    WHERE latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:41:25.277651 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.hub_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`ID`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`ID`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_HK` = d.`CUSTOMER_WEALTH_BRACKET_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:41:25.277651 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.sat_order
[0m08:41:25.293282 [info ] [Thread-4  ]: 08:41:25 + Loading steadfast-task-363413.data_vault.link_customer_wealth_bracket_customer from 1 source(s)
[0m08:41:25.293282 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.sat_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_US_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_US_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_US_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:41:25.293282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:41:25.308910 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m08:41:25.308910 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:41:25.324538 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m08:41:25.340167 [debug] [Thread-8  ]: finished collecting timing info
[0m08:41:25.340167 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer
[0m08:41:25.340167 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m08:41:25.340167 [debug] [Thread-4  ]: finished collecting timing info
[0m08:41:25.340167 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:41:25.355797 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:41:25.684022 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_order"
[0m08:41:25.684022 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.sat_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`ORDER_ID`, a.`ORDER_PRICE`, a.`CUSTOMER_ID`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_order` AS a
    WHERE a.`ORDER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`ORDER_HK`, current_records.`ORDER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`ORDER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_order` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`ORDER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`ORDER_HK` = source_records.`ORDER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`ORDER_HK`, stage.`ORDER_HASHDIFF`, stage.`ORDER_ID`, stage.`ORDER_PRICE`, stage.`CUSTOMER_ID`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`ORDER_HK` = stage.`ORDER_HK`
        AND latest_records.`ORDER_HASHDIFF` = stage.`ORDER_HASHDIFF`
    WHERE latest_records.`ORDER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_HASHDIFF`, `ORDER_ID`, `ORDER_PRICE`, `CUSTOMER_ID`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_HASHDIFF`, `ORDER_ID`, `ORDER_PRICE`, `CUSTOMER_ID`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:41:25.762169 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m08:41:25.762169 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m08:41:25.762169 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m08:41:25.762169 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m08:41:25.762169 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`ORDER_HK`, rr.`ORDER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_order` AS rr
    WHERE rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`ORDER_HK`, a.`ORDER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_order` AS d
    ON a.`ORDER_HK` = d.`ORDER_HK`
    WHERE d.`ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:41:25.762169 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`CUSTOMER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NOT NULL
    AND rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` = d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:41:25.777802 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_order` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_ORDER_HK`, rr.`CUSTOMER_HK`, rr.`ORDER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_order` AS rr
    WHERE rr.`CUSTOMER_ORDER_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    AND rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_ORDER_HK`, a.`CUSTOMER_HK`, a.`ORDER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_order` AS d
    ON a.`CUSTOMER_ORDER_HK` = d.`CUSTOMER_ORDER_HK`
    WHERE d.`CUSTOMER_ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:41:25.777802 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.`CUSTOMER_HK`
               ORDER BY ru.`LOAD_DATE`, ru.`RECORD_SOURCE` ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_union AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer` AS d
    ON a.`CUSTOMER_HK` = d.`CUSTOMER_HK`
    WHERE d.`CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:41:28.954188 [debug] [Thread-3  ]: finished collecting timing info
[0m08:41:28.954188 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767DB3700>]}
[0m08:41:28.954188 [info ] [Thread-3  ]: 9 of 21 OK created incremental model data_vault.hub_customer_wealth_bracket .... [[32mMERGE (0.0 rows, 870.0 Bytes processed)[0m in 4.49s]
[0m08:41:28.954188 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:41:28.954188 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:41:28.954188 [info ] [Thread-3  ]: 17 of 21 START incremental model data_vault.sat_UK_customer .................... [RUN]
[0m08:41:28.954188 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m08:41:28.954188 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:41:28.954188 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:41:29.001079 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m08:41:29.001079 [debug] [Thread-3  ]: finished collecting timing info
[0m08:41:29.001079 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:41:29.016709 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:41:29.141738 [debug] [Thread-8  ]: finished collecting timing info
[0m08:41:29.141738 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767CE6B50>]}
[0m08:41:29.141738 [info ] [Thread-8  ]: 15 of 21 OK created incremental model data_vault.hub_customer .................. [[32mMERGE (0.0 rows, 1.4 KB processed)[0m in 3.97s]
[0m08:41:29.141738 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m08:41:29.235526 [debug] [Thread-4  ]: finished collecting timing info
[0m08:41:29.251144 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767D076A0>]}
[0m08:41:29.251144 [info ] [Thread-4  ]: 16 of 21 OK created incremental model data_vault.link_customer_wealth_bracket_customer  [[32mMERGE (0.0 rows, 870.0 Bytes processed)[0m in 4.07s]
[0m08:41:29.251144 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:41:29.266771 [debug] [Thread-1  ]: finished collecting timing info
[0m08:41:29.266771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767EC7880>]}
[0m08:41:29.266771 [info ] [Thread-1  ]: 12 of 21 OK created incremental model data_vault.hub_order ..................... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 4.29s]
[0m08:41:29.266771 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m08:41:29.344912 [debug] [Thread-5  ]: finished collecting timing info
[0m08:41:29.344912 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767EC5EB0>]}
[0m08:41:29.344912 [info ] [Thread-5  ]: 11 of 21 OK created incremental model data_vault.sat_US_customer ............... [[32mMERGE (0.0 rows, 441.0 Bytes processed)[0m in 4.58s]
[0m08:41:29.344912 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:41:29.376172 [debug] [Thread-2  ]: finished collecting timing info
[0m08:41:29.376172 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767ECC640>]}
[0m08:41:29.376172 [debug] [Thread-7  ]: finished collecting timing info
[0m08:41:29.376172 [info ] [Thread-2  ]: 14 of 21 OK created incremental model data_vault.sat_order ..................... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 4.40s]
[0m08:41:29.376172 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767E7BFA0>]}
[0m08:41:29.376172 [info ] [Thread-7  ]: 10 of 21 OK created incremental model data_vault.sat_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 1.3 KB processed)[0m in 4.91s]
[0m08:41:29.376172 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.sat_order
[0m08:41:29.376172 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:41:29.391801 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m08:41:29.391801 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.sat_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_UK_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`TITLE`, a.`WEALTH_BRACKET`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_UK_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`TITLE`, stage.`WEALTH_BRACKET`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:41:29.673154 [debug] [Thread-6  ]: finished collecting timing info
[0m08:41:29.673154 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767EC7820>]}
[0m08:41:29.673154 [info ] [Thread-6  ]: 13 of 21 OK created incremental model data_vault.link_customer_order ........... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 4.69s]
[0m08:41:29.673154 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m08:41:29.673154 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:41:29.673154 [info ] [Thread-8  ]: 18 of 21 START view model data_vault.v_comp_orders_as_is ....................... [RUN]
[0m08:41:29.673154 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m08:41:29.673154 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:41:29.673154 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:41:29.673154 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m08:41:29.673154 [debug] [Thread-8  ]: finished collecting timing info
[0m08:41:29.673154 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:41:29.688772 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m08:41:29.688772 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m08:41:29.688772 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_comp_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`
  OPTIONS()
  as with
    h as
        (select order_hk, order_number, record_source from `steadfast-task-363413`.`data_vault`.`hub_order`),
    s as
        (select order_hk, order_id, order_price, lastmodifieddate, createddate, effective_from, load_date,
         crud_flag, row_number() over(partition by order_hk order by lastmodifieddate desc) as rn
         from `steadfast-task-363413`.`data_vault`.`sat_order`),
    co as
        (select order_hk, customer_hk from `steadfast-task-363413`.`data_vault`.`link_customer_order` ),
    joined as
        (select h.order_hk, h.order_number,
            co.customer_hk,
            s.order_id, s.order_price, s.lastmodifieddate, s.createddate, h.record_source, s.effective_from,
            s.load_date, s.crud_flag, s.rn
         from h, s, co
        where s.order_hk = h.order_hk
        and co.order_hk = h.order_hk)
select order_hk, customer_hk, order_id, order_number, order_price, lastmodifieddate, createddate,
effective_from, load_date
from joined
where rn = 1 and crud_flag <> 'D';


[0m08:41:30.907899 [debug] [Thread-8  ]: finished collecting timing info
[0m08:41:30.907899 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766B574C0>]}
[0m08:41:30.907899 [info ] [Thread-8  ]: 18 of 21 OK created view model data_vault.v_comp_orders_as_is .................. [[32mOK[0m in 1.23s]
[0m08:41:30.907899 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:41:33.389970 [debug] [Thread-3  ]: finished collecting timing info
[0m08:41:33.389970 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767D8F6D0>]}
[0m08:41:33.389970 [info ] [Thread-3  ]: 17 of 21 OK created incremental model data_vault.sat_UK_customer ............... [[32mMERGE (0.0 rows, 2.6 KB processed)[0m in 4.44s]
[0m08:41:33.389970 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:41:33.389970 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:41:33.389970 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:41:33.389970 [info ] [Thread-1  ]: 19 of 21 START view model data_vault.v_comp_customer_history ................... [RUN]
[0m08:41:33.389970 [info ] [Thread-5  ]: 20 of 21 START view model data_vault.v_comp_customers_as_is .................... [RUN]
[0m08:41:33.389970 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m08:41:33.389970 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:41:33.389970 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:41:33.389970 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m08:41:33.389970 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m08:41:33.389970 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:41:33.405577 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:41:33.405577 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m08:41:33.405577 [debug] [Thread-1  ]: finished collecting timing info
[0m08:41:33.405577 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:41:33.405577 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m08:41:33.405577 [debug] [Thread-5  ]: finished collecting timing info
[0m08:41:33.405577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:41:33.405577 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:41:33.405577 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_comp_customer_history: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_history"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_history`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.customer_id, s_uk.first_name,
        s_uk.last_name, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
        s_uk.effective_from, s_uk.crud_flag, s_uk.load_date
        from h, s_uk
        where s_uk.customer_hk = h.customer_hk
        union all
        select h.customer_hk, h.customer_number, s_us.customer_id, s_us.first_name,
        s_us.last_name, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
        s_us.effective_from, s_us.crud_flag, s_us.load_date
        from h, s_us
        where s_us.customer_hk = h.customer_hk)
select * from joined;


[0m08:41:33.421208 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m08:41:33.421208 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m08:41:33.421208 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.v_comp_customers_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customers_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number, record_source
        from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.crud_flag, s_uk.customer_id,
                s_uk.title, s_uk.first_name, s_uk.last_name, s_uk.wealth_bracket, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
                s_uk.effective_from, s_uk.load_date, h.record_source,
                row_number() over(partition by s_uk.customer_hk order by s_uk.applieddate desc) as rn
         from h, s_uk
         where s_uk.customer_hk = h.customer_hk
         union all
         select h.customer_hk, h.customer_number, s_us.crud_flag, s_us.customer_id,
                '' as title, s_us.first_name, s_us.last_name, null as wealth_bracket, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
                s_us.effective_from, s_us.load_date, h.record_source,
                row_number() over(partition by s_us.customer_hk order by s_us.applieddate desc) as rn
         from h, s_us
         )
select customer_hk, customer_id, customer_number, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate, applieddate, effective_from, load_date, record_source from joined
where rn = 1 and crud_flag <> 'D';


[0m08:41:34.671607 [debug] [Thread-1  ]: finished collecting timing info
[0m08:41:34.671607 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766BF0AC0>]}
[0m08:41:34.671607 [info ] [Thread-1  ]: 19 of 21 OK created view model data_vault.v_comp_customer_history .............. [[32mOK[0m in 1.28s]
[0m08:41:34.671607 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:41:34.687237 [debug] [Thread-5  ]: finished collecting timing info
[0m08:41:34.702847 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766BF0520>]}
[0m08:41:34.702847 [info ] [Thread-5  ]: 20 of 21 OK created view model data_vault.v_comp_customers_as_is ............... [[32mOK[0m in 1.31s]
[0m08:41:34.702847 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:41:34.702847 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:41:34.702847 [info ] [Thread-7  ]: 21 of 21 START view model data_vault.v_comp_customer_orders_as_is .............. [RUN]
[0m08:41:34.702847 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m08:41:34.702847 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:41:34.702847 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:41:34.702847 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m08:41:34.702847 [debug] [Thread-7  ]: finished collecting timing info
[0m08:41:34.702847 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:41:34.718480 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m08:41:34.718480 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m08:41:34.718480 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_orders_as_is`
  OPTIONS()
  as with
    c as
        (select customer_hk, customer_number, first_name, last_name
         from `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`),
    o as
        (select customer_hk, order_number, order_price, createddate, lastmodifieddate
         from `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`),
    joined as
        (select c.customer_number, c.first_name, c.last_name, o.order_number, o.order_price,
         o.createddate, o.lastmodifieddate
         from c, o
         where o.customer_hk = c.customer_hk)
select * from joined;


[0m08:41:36.015766 [debug] [Thread-7  ]: finished collecting timing info
[0m08:41:36.015766 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94d038a-e7b7-43f4-a75c-b9babc9ef037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F767EA8F10>]}
[0m08:41:36.015766 [info ] [Thread-7  ]: 21 of 21 OK created view model data_vault.v_comp_customer_orders_as_is ......... [[32mOK[0m in 1.31s]
[0m08:41:36.015766 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:41:36.015766 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:41:36.015766 [info ] [MainThread]: 
[0m08:41:36.015766 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 15.99 seconds (15.99s).
[0m08:41:36.015766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:36.015766 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:41:36.015766 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m08:41:36.015766 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_history' was properly closed.
[0m08:41:36.015766 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_order' was properly closed.
[0m08:41:36.015766 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_UK_customer' was properly closed.
[0m08:41:36.015766 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer' was properly closed.
[0m08:41:36.015766 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.link_customer_order' was properly closed.
[0m08:41:36.015766 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_orders_as_is' was properly closed.
[0m08:41:36.015766 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is' was properly closed.
[0m08:41:36.015766 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customers_as_is' was properly closed.
[0m08:41:36.031853 [info ] [MainThread]: 
[0m08:41:36.031853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:41:36.031853 [info ] [MainThread]: 
[0m08:41:36.031853 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m08:41:36.047018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766825CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76684A3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7668213D0>]}
[0m08:41:36.047018 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 08:54:28.801170 | 8602cc72-8159-4974-b49a-d0bbfe454a6c ==============================
[0m08:54:28.801170 [info ] [MainThread]: Running with dbt=1.2.2
[0m08:54:28.801170 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:54:28.801170 [debug] [MainThread]: Tracking: tracking
[0m08:54:28.801170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298714CAEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298714CA0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298714CAF70>]}
[0m08:54:28.973113 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:54:28.973113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298714BD700>]}
[0m08:54:29.223188 [debug] [MainThread]: Parsing macros\adapters.sql
[0m08:54:29.270077 [debug] [MainThread]: Parsing macros\catalog.sql
[0m08:54:29.270077 [debug] [MainThread]: Parsing macros\etc.sql
[0m08:54:29.285708 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:54:29.285708 [debug] [MainThread]: Parsing macros\materializations\copy.sql
[0m08:54:29.285708 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m08:54:29.316965 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m08:54:29.316965 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m08:54:29.316965 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m08:54:29.316965 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:54:29.332597 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:54:29.348227 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:54:29.363856 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m08:54:29.363856 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m08:54:29.379486 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m08:54:29.379486 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m08:54:29.379486 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m08:54:29.395115 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m08:54:29.410746 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m08:54:29.410746 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m08:54:29.426375 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m08:54:29.426375 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m08:54:29.426375 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m08:54:29.426375 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m08:54:29.426375 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m08:54:29.426375 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m08:54:29.426375 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m08:54:29.442003 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m08:54:29.442003 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m08:54:29.442003 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m08:54:29.442003 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m08:54:29.457635 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m08:54:29.520153 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m08:54:29.520153 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m08:54:29.535782 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m08:54:29.551414 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m08:54:29.567041 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m08:54:29.567041 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m08:54:29.567041 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m08:54:29.582670 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m08:54:29.582670 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m08:54:29.582670 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m08:54:29.598300 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m08:54:29.613930 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m08:54:29.629560 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m08:54:29.645189 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m08:54:29.645189 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m08:54:29.660819 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m08:54:29.660819 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m08:54:29.676449 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m08:54:29.676449 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:54:29.676449 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:54:29.676449 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m08:54:29.676449 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m08:54:29.676449 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:54:29.692079 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m08:54:29.707708 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:54:29.707708 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m08:54:29.707708 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:54:29.707708 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:54:29.707708 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:54:29.707708 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m08:54:29.707708 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m08:54:29.723338 [debug] [MainThread]: Parsing macros\internal\helpers\logging.sql
[0m08:54:29.723338 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m08:54:29.723338 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m08:54:29.738968 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m08:54:29.738968 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m08:54:29.754598 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m08:54:29.754598 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m08:54:29.754598 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m08:54:29.754598 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m08:54:29.770228 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m08:54:29.770228 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m08:54:29.785859 [debug] [MainThread]: Parsing macros\internal\metadata_processing\process_payload_column_excludes.sql
[0m08:54:29.785859 [debug] [MainThread]: Parsing macros\materialisations\drop_temporary.sql
[0m08:54:29.785859 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m08:54:29.801487 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m08:54:29.801487 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m08:54:29.801487 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m08:54:29.817117 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m08:54:29.817117 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m08:54:29.848376 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m08:54:29.879635 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m08:54:29.895265 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m08:54:29.910896 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m08:54:29.910896 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m08:54:29.910896 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m08:54:29.926525 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m08:54:29.926525 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m08:54:29.942155 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m08:54:29.957786 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m08:54:29.957786 [debug] [MainThread]: Parsing macros\staging\null_columns.sql
[0m08:54:29.973415 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m08:54:29.989047 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m08:54:29.989047 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m08:54:30.004674 [debug] [MainThread]: Parsing macros\supporting\as_of_date_window.sql
[0m08:54:30.004674 [debug] [MainThread]: Parsing macros\supporting\bridge_shared.sql
[0m08:54:30.020304 [debug] [MainThread]: Parsing macros\supporting\cast_binary.sql
[0m08:54:30.020304 [debug] [MainThread]: Parsing macros\supporting\cast_date.sql
[0m08:54:30.035936 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m08:54:30.035936 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m08:54:30.035936 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m08:54:30.051565 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m08:54:30.098454 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m08:54:30.098454 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m08:54:30.098454 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m08:54:30.098454 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m08:54:30.129713 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m08:54:30.129713 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m08:54:30.145342 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m08:54:30.160974 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m08:54:30.192230 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m08:54:30.192230 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m08:54:30.192230 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m08:54:30.192230 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
[0m08:54:30.192230 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
[0m08:54:30.192230 [debug] [MainThread]: Parsing macros\tables\databricks\sat.sql
[0m08:54:30.192230 [debug] [MainThread]: Parsing macros\tables\postgres\hub.sql
[0m08:54:30.207860 [debug] [MainThread]: Parsing macros\tables\postgres\link.sql
[0m08:54:30.223491 [debug] [MainThread]: Parsing macros\tables\postgres\sat.sql
[0m08:54:30.223491 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m08:54:30.239120 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m08:54:30.270379 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m08:54:30.286010 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m08:54:30.308101 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m08:54:30.339369 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m08:54:30.370630 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m08:54:30.386260 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m08:54:30.401888 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m08:54:30.417517 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m08:54:30.417517 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m08:54:30.433148 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m08:54:30.448778 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m08:54:30.464407 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m08:54:30.480037 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m08:54:30.480037 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m08:54:30.480037 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m08:54:30.480037 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m08:54:30.480037 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\xdb_deprecation_warning.sql
[0m08:54:30.480037 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m08:54:30.495669 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m08:54:30.495669 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m08:54:30.495669 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m08:54:30.495669 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m08:54:30.511297 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m08:54:30.511297 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m08:54:30.511297 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m08:54:30.526925 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m08:54:30.526925 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m08:54:30.526925 [debug] [MainThread]: Parsing macros\generic_tests\not_empty_string.sql
[0m08:54:30.542558 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m08:54:30.542558 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m08:54:30.542558 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m08:54:30.542558 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m08:54:30.558185 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m08:54:30.558185 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m08:54:30.558185 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m08:54:30.558185 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m08:54:30.558185 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m08:54:30.558185 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_ephemeral.sql
[0m08:54:30.558185 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_relation.sql
[0m08:54:30.573816 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m08:54:30.573816 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m08:54:30.573816 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m08:54:30.589445 [debug] [MainThread]: Parsing macros\sql\generate_surrogate_key.sql
[0m08:54:30.589445 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m08:54:30.589445 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m08:54:30.605075 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m08:54:30.605075 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m08:54:30.605075 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m08:54:30.605075 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m08:54:30.620704 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m08:54:30.620704 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m08:54:30.620704 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m08:54:30.620704 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m08:54:30.636334 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m08:54:30.636334 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m08:54:30.636334 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m08:54:30.636334 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m08:54:30.651966 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m08:54:30.651966 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m08:54:30.651966 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m08:54:30.667594 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m08:54:30.683224 [debug] [MainThread]: Parsing macros\sql\width_bucket.sql
[0m08:54:30.683224 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m08:54:30.683224 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m08:54:30.683224 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m08:54:31.647651 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m08:54:31.663281 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m08:54:31.663281 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m08:54:31.678912 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m08:54:31.678912 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m08:54:31.678912 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_order.sql
[0m08:54:31.694538 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m08:54:31.694538 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m08:54:31.694538 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m08:54:31.832312 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m08:54:31.832312 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m08:54:31.847956 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m08:54:31.847956 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m08:54:31.863587 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m08:54:31.879217 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m08:54:31.926109 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m08:54:31.926109 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m08:54:31.941734 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m08:54:31.941734 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m08:54:32.019885 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m08:54:32.019885 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_order.sql
[0m08:54:32.051144 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_order.sql
[0m08:54:32.051144 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m08:54:32.098032 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m08:54:32.098032 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m08:54:32.129293 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m08:54:32.129293 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m08:54:32.301220 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m08:54:32.301220 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_order.sql
[0m08:54:32.379368 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_order.sql
[0m08:54:32.379368 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m08:54:32.473143 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m08:54:32.473143 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m08:54:32.520036 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m08:54:32.785741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298717C31F0>]}
[0m08:54:32.801372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987187CBB0>]}
[0m08:54:32.801372 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 2 seed files, 4 sources, 0 exposures, 0 metrics
[0m08:54:32.801372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987151C940>]}
[0m08:54:32.801372 [info ] [MainThread]: 
[0m08:54:32.801372 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:54:32.801372 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m08:54:32.816998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:33.632872 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m08:54:33.632872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:33.976725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298717C36A0>]}
[0m08:54:33.976725 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:54:33.976725 [info ] [MainThread]: 
[0m08:54:33.992356 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:54:33.992356 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:54:33.992356 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:54:33.992356 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_order
[0m08:54:33.992356 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m08:54:33.992356 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m08:54:33.992356 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m08:54:33.992356 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_order ................................ [RUN]
[0m08:54:33.992356 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:54:33.992356 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:54:33.992356 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:54:33.992356 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:54:33.992356 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:54:33.992356 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:54:33.992356 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:54:33.992356 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:54:33.992356 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:54:33.992356 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:54:34.007984 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:54:34.007984 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_order
[0m08:54:34.007984 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:54:34.007984 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_order
[0m08:54:34.007984 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:54:34.023616 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:54:34.023616 [debug] [Thread-2  ]: finished collecting timing info
[0m08:54:34.023616 [debug] [Thread-1  ]: finished collecting timing info
[0m08:54:34.023616 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:54:34.023616 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:54:34.070506 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m08:54:34.086133 [debug] [Thread-4  ]: finished collecting timing info
[0m08:54:34.086133 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m08:54:34.086133 [debug] [Thread-3  ]: finished collecting timing info
[0m08:54:34.086133 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_order
[0m08:54:34.086133 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:54:34.086133 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_order"
[0m08:54:34.101764 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m08:54:34.101764 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:54:34.101764 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:54:34.101764 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m08:54:34.101764 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m08:54:34.101764 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:54:34.101764 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:54:34.101764 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m08:54:34.101764 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m08:54:35.311475 [debug] [Thread-3  ]: finished collecting timing info
[0m08:54:35.311475 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029871556430>]}
[0m08:54:35.311475 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.32s]
[0m08:54:35.311475 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m08:54:35.311475 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:54:35.327107 [info ] [Thread-6  ]: 5 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m08:54:35.327107 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m08:54:35.327107 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:54:35.327107 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:54:35.327107 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m08:54:35.483403 [debug] [Thread-2  ]: finished collecting timing info
[0m08:54:35.483403 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029871884EB0>]}
[0m08:54:35.483403 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.49s]
[0m08:54:35.483403 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m08:54:35.483403 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:54:35.483403 [info ] [Thread-8  ]: 6 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m08:54:35.483403 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m08:54:35.483403 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:54:35.483403 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:54:35.499033 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m08:54:35.577182 [debug] [Thread-1  ]: finished collecting timing info
[0m08:54:35.592811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029871668220>]}
[0m08:54:35.592811 [debug] [Thread-4  ]: finished collecting timing info
[0m08:54:35.592811 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.60s]
[0m08:54:35.592811 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029871556970>]}
[0m08:54:35.592811 [info ] [Thread-4  ]: 4 of 21 OK created view model data_vault.v_raw_order ........................... [[32mOK[0m in 1.60s]
[0m08:54:35.592811 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m08:54:35.592811 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:54:35.592811 [info ] [Thread-3  ]: 7 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m08:54:35.592811 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_order
[0m08:54:35.592811 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m08:54:35.592811 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_stg_order
[0m08:54:35.592811 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:54:35.592811 [info ] [Thread-2  ]: 8 of 21 START view model data_vault.v_stg_order ................................ [RUN]
[0m08:54:35.592811 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:54:35.608442 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_order"
[0m08:54:35.608442 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:54:35.608442 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_order
[0m08:54:35.608442 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_stg_order
[0m08:54:35.624071 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:54:36.249262 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m08:54:36.249262 [debug] [Thread-6  ]: finished collecting timing info
[0m08:54:36.249262 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:54:36.249262 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m08:54:36.249262 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
),

derived_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '3' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`DESCRIPTION` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`NAME` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:54:36.358672 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m08:54:36.358672 [debug] [Thread-8  ]: finished collecting timing info
[0m08:54:36.358672 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:54:36.374302 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m08:54:36.374302 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_stg_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_US_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    CUSTOMER_NUMBER AS `US_CUSTOMER_KEY`,
    '101' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`US_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:54:36.686892 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_order"
[0m08:54:36.686892 [debug] [Thread-2  ]: finished collecting timing info
[0m08:54:36.686892 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_order
[0m08:54:36.702523 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_order"
[0m08:54:36.718153 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_stg_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_order`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_order`
),

derived_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    ORDER_NUMBER AS `ORDER_KEY`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    '2' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), '')))) AS STRING) AS `ORDER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_ORDER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_PRICE` AS STRING))), ''), '^^')
    )))) AS `ORDER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `ORDER_HK`,
    `CUSTOMER_HK`,
    `CUSTOMER_ORDER_HK`,
    `ORDER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:54:36.733783 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m08:54:36.733783 [debug] [Thread-3  ]: finished collecting timing info
[0m08:54:36.733783 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:54:36.733783 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m08:54:36.733783 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_stg_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '1' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`TITLE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`WEALTH_BRACKET` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m08:54:37.265195 [debug] [Thread-8  ]: finished collecting timing info
[0m08:54:37.265195 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872A1AE50>]}
[0m08:54:37.265195 [info ] [Thread-8  ]: 6 of 21 OK created view model data_vault.v_stg_US_customer ..................... [[32mOK[0m in 1.78s]
[0m08:54:37.265195 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m08:54:37.265195 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:54:37.265195 [info ] [Thread-1  ]: 9 of 21 START incremental model data_vault.sat_US_customer ..................... [RUN]
[0m08:54:37.265195 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_US_customer"
[0m08:54:37.265195 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:54:37.265195 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.sat_US_customer
[0m08:54:37.312085 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m08:54:37.312085 [debug] [Thread-1  ]: finished collecting timing info
[0m08:54:37.312085 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:54:37.343344 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:54:37.452750 [debug] [Thread-6  ]: finished collecting timing info
[0m08:54:37.452750 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872A06FD0>]}
[0m08:54:37.452750 [info ] [Thread-6  ]: 5 of 21 OK created view model data_vault.v_stg_customer_wealth_bracket ......... [[32mOK[0m in 2.13s]
[0m08:54:37.452750 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m08:54:37.452750 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:54:37.452750 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:54:37.452750 [info ] [Thread-4  ]: 10 of 21 START incremental model data_vault.hub_customer_wealth_bracket ........ [RUN]
[0m08:54:37.452750 [info ] [Thread-5  ]: 11 of 21 START incremental model data_vault.sat_customer_wealth_bracket ........ [RUN]
[0m08:54:37.452750 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m08:54:37.452750 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:54:37.468381 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m08:54:37.452750 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:54:37.468381 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:54:37.468381 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:54:37.499642 [info ] [Thread-4  ]: 08:54:37 + Loading steadfast-task-363413.data_vault.hub_customer_wealth_bracket from 1 source(s)
[0m08:54:37.515271 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m08:54:37.530899 [debug] [Thread-4  ]: finished collecting timing info
[0m08:54:37.530899 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:54:37.546530 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m08:54:37.546530 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:54:37.546530 [debug] [Thread-5  ]: finished collecting timing info
[0m08:54:37.546530 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:54:37.562159 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m08:54:37.640328 [debug] [Thread-2  ]: finished collecting timing info
[0m08:54:37.640328 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029871987BB0>]}
[0m08:54:37.640328 [info ] [Thread-2  ]: 8 of 21 OK created view model data_vault.v_stg_order ........................... [[32mOK[0m in 2.03s]
[0m08:54:37.640328 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_order
[0m08:54:37.640328 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m08:54:37.640328 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m08:54:37.640328 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.sat_order
[0m08:54:37.640328 [info ] [Thread-7  ]: 12 of 21 START incremental model data_vault.hub_order .......................... [RUN]
[0m08:54:37.640328 [info ] [Thread-6  ]: 13 of 21 START incremental model data_vault.link_customer_order ................ [RUN]
[0m08:54:37.640328 [info ] [Thread-8  ]: 14 of 21 START incremental model data_vault.sat_order .......................... [RUN]
[0m08:54:37.640328 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_order"
[0m08:54:37.640328 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_order"
[0m08:54:37.640328 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.hub_order
[0m08:54:37.655939 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_order"
[0m08:54:37.655939 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_order
[0m08:54:37.655939 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.hub_order
[0m08:54:37.655939 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.sat_order
[0m08:54:37.655939 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.link_customer_order
[0m08:54:37.655939 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.sat_order
[0m08:54:37.734090 [info ] [Thread-7  ]: 08:54:37 + Loading steadfast-task-363413.data_vault.hub_order from 1 source(s)
[0m08:54:37.749719 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m08:54:37.765349 [debug] [Thread-7  ]: finished collecting timing info
[0m08:54:37.765349 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.hub_order
[0m08:54:37.765349 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m08:54:37.827865 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_order"
[0m08:54:37.859126 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m08:54:37.874755 [info ] [Thread-6  ]: 08:54:37 + Loading steadfast-task-363413.data_vault.link_customer_order from 1 source(s)
[0m08:54:37.874755 [debug] [Thread-8  ]: finished collecting timing info
[0m08:54:37.874755 [debug] [Thread-3  ]: finished collecting timing info
[0m08:54:37.874755 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.sat_order
[0m08:54:37.874755 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.sat_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_US_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_US_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_US_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:54:37.890384 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m08:54:37.874755 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872A135E0>]}
[0m08:54:37.890384 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m08:54:37.906013 [info ] [Thread-3  ]: 7 of 21 OK created view model data_vault.v_stg_UK_customer ..................... [[32mOK[0m in 2.28s]
[0m08:54:37.906013 [debug] [Thread-6  ]: finished collecting timing info
[0m08:54:37.906013 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_order
[0m08:54:37.906013 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m08:54:37.906013 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m08:54:37.906013 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m08:54:37.906013 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:54:37.906013 [info ] [Thread-2  ]: 15 of 21 START incremental model data_vault.hub_customer ....................... [RUN]
[0m08:54:37.921644 [info ] [Thread-3  ]: 16 of 21 START incremental model data_vault.link_customer_wealth_bracket_customer  [RUN]
[0m08:54:37.921644 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer"
[0m08:54:37.921644 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer
[0m08:54:37.921644 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m08:54:37.921644 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.hub_customer
[0m08:54:37.921644 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:54:37.921644 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:54:37.937273 [info ] [Thread-2  ]: 08:54:37 + Loading steadfast-task-363413.data_vault.hub_customer from 2 source(s)
[0m08:54:37.952903 [info ] [Thread-3  ]: 08:54:37 + Loading steadfast-task-363413.data_vault.link_customer_wealth_bracket_customer from 1 source(s)
[0m08:54:37.968533 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m08:54:37.968533 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m08:54:37.984163 [debug] [Thread-2  ]: finished collecting timing info
[0m08:54:37.984163 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer
[0m08:54:37.984163 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:54:37.984163 [debug] [Thread-3  ]: finished collecting timing info
[0m08:54:37.984163 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:54:37.999793 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:54:38.031053 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m08:54:38.046680 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m08:54:38.046680 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.sat_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`NAME`, a.`DESCRIPTION`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS a
    WHERE a.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_WEALTH_BRACKET_HK`, current_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_WEALTH_BRACKET_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_WEALTH_BRACKET_HK` = source_records.`CUSTOMER_WEALTH_BRACKET_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_WEALTH_BRACKET_HK`, stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, stage.`NAME`, stage.`DESCRIPTION`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_WEALTH_BRACKET_HK` = stage.`CUSTOMER_WEALTH_BRACKET_HK`
        AND latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` = stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`
    WHERE latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:54:38.046680 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.hub_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`ID`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`ID`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_HK` = d.`CUSTOMER_WEALTH_BRACKET_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:54:38.249869 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m08:54:38.249869 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`ORDER_HK`, rr.`ORDER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_order` AS rr
    WHERE rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`ORDER_HK`, a.`ORDER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_order` AS d
    ON a.`ORDER_HK` = d.`ORDER_HK`
    WHERE d.`ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:54:38.343648 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_order"
[0m08:54:38.359275 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.sat_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`ORDER_ID`, a.`ORDER_PRICE`, a.`CUSTOMER_ID`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_order` AS a
    WHERE a.`ORDER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`ORDER_HK`, current_records.`ORDER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`ORDER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_order` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`ORDER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`ORDER_HK` = source_records.`ORDER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`ORDER_HK`, stage.`ORDER_HASHDIFF`, stage.`ORDER_ID`, stage.`ORDER_PRICE`, stage.`CUSTOMER_ID`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`ORDER_HK` = stage.`ORDER_HK`
        AND latest_records.`ORDER_HASHDIFF` = stage.`ORDER_HASHDIFF`
    WHERE latest_records.`ORDER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_HASHDIFF`, `ORDER_ID`, `ORDER_PRICE`, `CUSTOMER_ID`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_HASHDIFF`, `ORDER_ID`, `ORDER_PRICE`, `CUSTOMER_ID`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:54:38.374907 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m08:54:38.374907 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_order` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_ORDER_HK`, rr.`CUSTOMER_HK`, rr.`ORDER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_order` AS rr
    WHERE rr.`CUSTOMER_ORDER_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    AND rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_ORDER_HK`, a.`CUSTOMER_HK`, a.`ORDER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_order` AS d
    ON a.`CUSTOMER_ORDER_HK` = d.`CUSTOMER_ORDER_HK`
    WHERE d.`CUSTOMER_ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:54:38.453054 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m08:54:38.453054 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`CUSTOMER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NOT NULL
    AND rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` = d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:54:38.453054 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m08:54:38.453054 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.`CUSTOMER_HK`
               ORDER BY ru.`LOAD_DATE`, ru.`RECORD_SOURCE` ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_union AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer` AS d
    ON a.`CUSTOMER_HK` = d.`CUSTOMER_HK`
    WHERE d.`CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:54:41.438347 [debug] [Thread-1  ]: finished collecting timing info
[0m08:54:41.438347 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872A59E50>]}
[0m08:54:41.438347 [info ] [Thread-1  ]: 9 of 21 OK created incremental model data_vault.sat_US_customer ................ [[32mMERGE (0.0 rows, 441.0 Bytes processed)[0m in 4.17s]
[0m08:54:41.438347 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m08:54:41.438347 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:54:41.438347 [info ] [Thread-1  ]: 17 of 21 START incremental model data_vault.sat_UK_customer .................... [RUN]
[0m08:54:41.438347 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m08:54:41.438347 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:54:41.438347 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:54:41.485651 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m08:54:41.485651 [debug] [Thread-1  ]: finished collecting timing info
[0m08:54:41.485651 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:54:41.485651 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:54:41.516994 [debug] [Thread-4  ]: finished collecting timing info
[0m08:54:41.532114 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872A9FD60>]}
[0m08:54:41.532114 [info ] [Thread-4  ]: 10 of 21 OK created incremental model data_vault.hub_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 870.0 Bytes processed)[0m in 4.08s]
[0m08:54:41.532114 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m08:54:41.625907 [debug] [Thread-7  ]: finished collecting timing info
[0m08:54:41.625907 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872B47400>]}
[0m08:54:41.625907 [info ] [Thread-7  ]: 12 of 21 OK created incremental model data_vault.hub_order ..................... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 3.99s]
[0m08:54:41.625907 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m08:54:41.641735 [debug] [Thread-5  ]: finished collecting timing info
[0m08:54:41.641735 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872B30C70>]}
[0m08:54:41.641735 [info ] [Thread-5  ]: 11 of 21 OK created incremental model data_vault.sat_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 1.3 KB processed)[0m in 4.17s]
[0m08:54:41.641735 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m08:54:41.735313 [debug] [Thread-3  ]: finished collecting timing info
[0m08:54:41.735313 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298729FF5B0>]}
[0m08:54:41.735313 [info ] [Thread-3  ]: 16 of 21 OK created incremental model data_vault.link_customer_wealth_bracket_customer  [[32mMERGE (0.0 rows, 870.0 Bytes processed)[0m in 3.81s]
[0m08:54:41.735313 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m08:54:41.766793 [debug] [Thread-2  ]: finished collecting timing info
[0m08:54:41.766793 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987189E850>]}
[0m08:54:41.766793 [info ] [Thread-2  ]: 15 of 21 OK created incremental model data_vault.hub_customer .................. [[32mMERGE (0.0 rows, 1.4 KB processed)[0m in 3.85s]
[0m08:54:41.766793 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m08:54:41.938737 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m08:54:41.938737 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.sat_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_UK_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`TITLE`, a.`WEALTH_BRACKET`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_UK_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`TITLE`, stage.`WEALTH_BRACKET`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m08:54:41.969760 [debug] [Thread-8  ]: finished collecting timing info
[0m08:54:41.969760 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872B34220>]}
[0m08:54:41.969760 [info ] [Thread-8  ]: 14 of 21 OK created incremental model data_vault.sat_order ..................... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 4.33s]
[0m08:54:41.969760 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.sat_order
[0m08:54:42.266735 [debug] [Thread-6  ]: finished collecting timing info
[0m08:54:42.266735 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872A59550>]}
[0m08:54:42.266735 [info ] [Thread-6  ]: 13 of 21 OK created incremental model data_vault.link_customer_order ........... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 4.63s]
[0m08:54:42.282343 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m08:54:42.282343 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:54:42.282343 [info ] [Thread-4  ]: 18 of 21 START view model data_vault.v_comp_orders_as_is ....................... [RUN]
[0m08:54:42.282343 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m08:54:42.282343 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:54:42.282343 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:54:42.282343 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m08:54:42.282343 [debug] [Thread-4  ]: finished collecting timing info
[0m08:54:42.282343 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:54:42.282343 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m08:54:42.298029 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m08:54:42.298029 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_comp_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`
  OPTIONS()
  as with
    h as
        (select order_hk, order_number, record_source from `steadfast-task-363413`.`data_vault`.`hub_order`),
    s as
        (select order_hk, order_id, order_price, lastmodifieddate, createddate, effective_from, load_date,
         crud_flag, row_number() over(partition by order_hk order by lastmodifieddate desc) as rn
         from `steadfast-task-363413`.`data_vault`.`sat_order`),
    co as
        (select order_hk, customer_hk from `steadfast-task-363413`.`data_vault`.`link_customer_order` ),
    joined as
        (select h.order_hk, h.order_number,
            co.customer_hk,
            s.order_id, s.order_price, s.lastmodifieddate, s.createddate, h.record_source, s.effective_from,
            s.load_date, s.crud_flag, s.rn
         from h, s, co
        where s.order_hk = h.order_hk
        and co.order_hk = h.order_hk)
select order_hk, customer_hk, order_id, order_number, order_price, lastmodifieddate, createddate,
effective_from, load_date
from joined
where rn = 1 and crud_flag <> 'D';


[0m08:54:43.360815 [debug] [Thread-4  ]: finished collecting timing info
[0m08:54:43.360815 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298729FF280>]}
[0m08:54:43.360815 [info ] [Thread-4  ]: 18 of 21 OK created view model data_vault.v_comp_orders_as_is .................. [[32mOK[0m in 1.08s]
[0m08:54:43.360815 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m08:54:45.845936 [debug] [Thread-1  ]: finished collecting timing info
[0m08:54:45.845936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872AE0340>]}
[0m08:54:45.845936 [info ] [Thread-1  ]: 17 of 21 OK created incremental model data_vault.sat_UK_customer ............... [[32mMERGE (0.0 rows, 2.6 KB processed)[0m in 4.41s]
[0m08:54:45.845936 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m08:54:45.845936 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:54:45.845936 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:54:45.845936 [info ] [Thread-5  ]: 19 of 21 START view model data_vault.v_comp_customer_history ................... [RUN]
[0m08:54:45.845936 [info ] [Thread-3  ]: 20 of 21 START view model data_vault.v_comp_customers_as_is .................... [RUN]
[0m08:54:45.845936 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m08:54:45.845936 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:54:45.845936 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:54:45.845936 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m08:54:45.861565 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m08:54:45.861565 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:54:45.861565 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:54:45.861565 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m08:54:45.861565 [debug] [Thread-5  ]: finished collecting timing info
[0m08:54:45.861565 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:54:45.877184 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m08:54:45.877184 [debug] [Thread-3  ]: finished collecting timing info
[0m08:54:45.877184 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:54:45.877184 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m08:54:45.877184 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m08:54:45.877184 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.v_comp_customer_history: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_history"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_history`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.customer_id, s_uk.first_name,
        s_uk.last_name, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
        s_uk.effective_from, s_uk.crud_flag, s_uk.load_date
        from h, s_uk
        where s_uk.customer_hk = h.customer_hk
        union all
        select h.customer_hk, h.customer_number, s_us.customer_id, s_us.first_name,
        s_us.last_name, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
        s_us.effective_from, s_us.crud_flag, s_us.load_date
        from h, s_us
        where s_us.customer_hk = h.customer_hk)
select * from joined;


[0m08:54:45.877184 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m08:54:45.877184 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_comp_customers_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customers_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number, record_source
        from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.crud_flag, s_uk.customer_id,
                s_uk.title, s_uk.first_name, s_uk.last_name, s_uk.wealth_bracket, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
                s_uk.effective_from, s_uk.load_date, h.record_source,
                row_number() over(partition by s_uk.customer_hk order by s_uk.applieddate desc) as rn
         from h, s_uk
         where s_uk.customer_hk = h.customer_hk
         union all
         select h.customer_hk, h.customer_number, s_us.crud_flag, s_us.customer_id,
                '' as title, s_us.first_name, s_us.last_name, null as wealth_bracket, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
                s_us.effective_from, s_us.load_date, h.record_source,
                row_number() over(partition by s_us.customer_hk order by s_us.applieddate desc) as rn
         from h, s_us
         )
select customer_hk, customer_id, customer_number, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate, applieddate, effective_from, load_date, record_source from joined
where rn = 1 and crud_flag <> 'D';


[0m08:54:47.158837 [debug] [Thread-5  ]: finished collecting timing info
[0m08:54:47.158837 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872A7A730>]}
[0m08:54:47.158837 [info ] [Thread-5  ]: 19 of 21 OK created view model data_vault.v_comp_customer_history .............. [[32mOK[0m in 1.31s]
[0m08:54:47.158837 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m08:54:47.252621 [debug] [Thread-3  ]: finished collecting timing info
[0m08:54:47.252621 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298716E2190>]}
[0m08:54:47.252621 [info ] [Thread-3  ]: 20 of 21 OK created view model data_vault.v_comp_customers_as_is ............... [[32mOK[0m in 1.41s]
[0m08:54:47.252621 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m08:54:47.268229 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:54:47.268229 [info ] [Thread-8  ]: 21 of 21 START view model data_vault.v_comp_customer_orders_as_is .............. [RUN]
[0m08:54:47.268229 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m08:54:47.268229 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:54:47.268229 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:54:47.268229 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m08:54:47.268229 [debug] [Thread-8  ]: finished collecting timing info
[0m08:54:47.268229 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:54:47.268229 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m08:54:47.268229 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m08:54:47.268229 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_orders_as_is`
  OPTIONS()
  as with
    c as
        (select customer_hk, customer_number, first_name, last_name
         from `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`),
    o as
        (select customer_hk, order_number, order_price, createddate, lastmodifieddate
         from `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`),
    joined as
        (select c.customer_number, c.first_name, c.last_name, o.order_number, o.order_price,
         o.createddate, o.lastmodifieddate
         from c, o
         where o.customer_hk = c.customer_hk)
select * from joined;


[0m08:54:48.893742 [debug] [Thread-8  ]: finished collecting timing info
[0m08:54:48.893742 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8602cc72-8159-4974-b49a-d0bbfe454a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029871584A30>]}
[0m08:54:48.893742 [info ] [Thread-8  ]: 21 of 21 OK created view model data_vault.v_comp_customer_orders_as_is ......... [[32mOK[0m in 1.63s]
[0m08:54:48.893742 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m08:54:48.893742 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m08:54:48.893742 [info ] [MainThread]: 
[0m08:54:48.893742 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 16.09 seconds (16.09s).
[0m08:54:48.893742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:54:48.893742 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m08:54:48.893742 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m08:54:48.893742 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_UK_customer' was properly closed.
[0m08:54:48.893742 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_customer' was properly closed.
[0m08:54:48.893742 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customers_as_is' was properly closed.
[0m08:54:48.893742 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_orders_as_is' was properly closed.
[0m08:54:48.909368 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.link_customer_order' was properly closed.
[0m08:54:48.909368 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is' was properly closed.
[0m08:54:48.909368 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_history' was properly closed.
[0m08:54:48.909368 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_order' was properly closed.
[0m08:54:48.925005 [info ] [MainThread]: 
[0m08:54:48.925005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:54:48.925005 [info ] [MainThread]: 
[0m08:54:48.925005 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m08:54:48.925005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298717A76D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298717C52E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029872A43070>]}
[0m08:54:48.925005 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 16:49:47.356574 | 990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc ==============================
[0m16:49:47.356574 [info ] [MainThread]: Running with dbt=1.2.2
[0m16:49:47.358675 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:49:47.359678 [debug] [MainThread]: Tracking: tracking
[0m16:49:47.361677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0C491C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0C49730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0C49520>]}
[0m16:49:50.490999 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m16:49:50.490999 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://seeds\repl_US_customers.csv
[0m16:49:50.492056 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://seeds\repl_customer_wealth_brackets.csv
[0m16:49:50.492056 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://seeds\repl_UK_customers.csv
[0m16:49:50.492056 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://seeds\repl_customers.csv
[0m16:49:50.492056 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://seeds\repl_orders.csv
[0m16:49:50.654348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0BFB0D0>]}
[0m16:49:50.674281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0EBE940>]}
[0m16:49:50.674281 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 3 seed files, 4 sources, 0 exposures, 0 metrics
[0m16:49:50.675558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0EF1CD0>]}
[0m16:49:50.678572 [info ] [MainThread]: 
[0m16:49:50.679661 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:49:50.683670 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m16:49:50.684749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:51.609194 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m16:49:51.610191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:51.973934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0EF1940>]}
[0m16:49:51.976013 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:49:51.977073 [info ] [MainThread]: 
[0m16:49:52.003707 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m16:49:52.003707 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m16:49:52.004709 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m16:49:52.004709 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_order
[0m16:49:52.005845 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m16:49:52.006549 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m16:49:52.007557 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m16:49:52.007557 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_order ................................ [RUN]
[0m16:49:52.010714 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m16:49:52.012716 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m16:49:52.015787 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m16:49:52.016837 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m16:49:52.017836 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m16:49:52.018836 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m16:49:52.019832 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_order"
[0m16:49:52.019832 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m16:49:52.020913 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m16:49:52.021629 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m16:49:52.021629 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_order
[0m16:49:52.036021 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m16:49:52.046625 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m16:49:52.055642 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m16:49:52.055783 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_order
[0m16:49:52.067091 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_order"
[0m16:49:52.071754 [debug] [Thread-3  ]: finished collecting timing info
[0m16:49:52.071754 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m16:49:52.088108 [debug] [Thread-2  ]: finished collecting timing info
[0m16:49:52.103713 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m16:49:52.134362 [debug] [Thread-4  ]: finished collecting timing info
[0m16:49:52.194162 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m16:49:52.200296 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m16:49:52.201294 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_order
[0m16:49:52.201294 [debug] [Thread-1  ]: finished collecting timing info
[0m16:49:52.215461 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_order"
[0m16:49:52.216838 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m16:49:52.227835 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m16:49:52.227835 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:49:52.228838 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:49:52.229837 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m16:49:52.230835 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m16:49:52.231836 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:49:52.239567 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m16:49:52.243583 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:49:52.246722 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m16:49:52.810255 [debug] [Thread-4  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m16:49:52.811233 [debug] [Thread-4  ]: BigQuery adapter: 404 Not found: Table steadfast-task-363413:staging.repl_orders was not found in location US

(job ID: 83481050-d266-460d-b45f-8c26b68f478e)

                                                                    -----Query Job SQL Follows-----                                                                     

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_order"} */
   2:
   3:
   4:  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_order`
   5:  OPTIONS()
   6:  as select distinct
   7:c.ORDER_ID,
   8:c.ORDER_NUMBER,
   9:c.ORDER_PRICE,
  10:c.CUSTOMER_ID,
  11:c.LASTMODIFIEDDATE,
  12:c.CREATEDDATE,
  13:c.CRUD_FLAG,
  14:p.CUSTOMER_NUMBER
  15:from
  16:    `steadfast-task-363413`.`staging`.`repl_orders` as c
  17:left join
  18:    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
  19:on p.customer_id = c.customer_id;
  20:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
[0m16:49:52.812258 [debug] [Thread-4  ]: finished collecting timing info
[0m16:49:52.812410 [debug] [Thread-4  ]: Runtime Error in model v_raw_order (models\raw_stage\v_raw_order.sql)
  404 Not found: Table steadfast-task-363413:staging.repl_orders was not found in location US
  
  (job ID: 83481050-d266-460d-b45f-8c26b68f478e)
[0m16:49:52.813413 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF106FDC0>]}
[0m16:49:52.814426 [error] [Thread-4  ]: 4 of 21 ERROR creating view model data_vault.v_raw_order ....................... [[31mERROR[0m in 0.79s]
[0m16:49:52.816426 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_order
[0m16:49:52.817489 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_order
[0m16:49:52.818519 [info ] [Thread-6  ]: 5 of 21 SKIP relation data_vault.v_stg_order ................................... [[33mSKIP[0m]
[0m16:49:52.820594 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_order
[0m16:49:52.821619 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m16:49:52.822679 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m16:49:52.823276 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.sat_order
[0m16:49:52.823276 [info ] [Thread-8  ]: 6 of 21 SKIP relation data_vault.hub_order ..................................... [[33mSKIP[0m]
[0m16:49:52.824255 [info ] [Thread-5  ]: 7 of 21 SKIP relation data_vault.link_customer_order ........................... [[33mSKIP[0m]
[0m16:49:52.824255 [info ] [Thread-4  ]: 8 of 21 SKIP relation data_vault.sat_order ..................................... [[33mSKIP[0m]
[0m16:49:52.827258 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m16:49:52.829415 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m16:49:52.832416 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.sat_order
[0m16:49:52.833535 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m16:49:52.833535 [info ] [Thread-6  ]: 9 of 21 SKIP relation data_vault.v_comp_orders_as_is ........................... [[33mSKIP[0m]
[0m16:49:52.836552 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m16:49:53.558079 [debug] [Thread-3  ]: finished collecting timing info
[0m16:49:53.560081 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0F56E50>]}
[0m16:49:53.560081 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.54s]
[0m16:49:53.563177 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m16:49:53.564207 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m16:49:53.565208 [info ] [Thread-8  ]: 10 of 21 START view model data_vault.v_stg_customer_wealth_bracket ............. [RUN]
[0m16:49:53.567208 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m16:49:53.567208 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m16:49:53.568354 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m16:49:53.642955 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m16:49:53.653279 [debug] [Thread-2  ]: finished collecting timing info
[0m16:49:53.656266 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0F56C70>]}
[0m16:49:53.657266 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.64s]
[0m16:49:53.659392 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m16:49:53.664527 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m16:49:53.666526 [info ] [Thread-4  ]: 11 of 21 START view model data_vault.v_stg_US_customer ......................... [RUN]
[0m16:49:53.675690 [debug] [Thread-1  ]: finished collecting timing info
[0m16:49:53.678898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0F891F0>]}
[0m16:49:53.680896 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m16:49:53.681891 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.67s]
[0m16:49:53.682894 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m16:49:53.684895 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m16:49:53.713898 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:49:53.717037 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m16:49:53.719039 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m16:49:53.722216 [info ] [Thread-6  ]: 12 of 21 START view model data_vault.v_stg_UK_customer ......................... [RUN]
[0m16:49:53.725198 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m16:49:53.726383 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m16:49:53.726383 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m16:49:53.748920 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m16:49:54.790712 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m16:49:54.796846 [debug] [Thread-8  ]: finished collecting timing info
[0m16:49:54.796846 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m16:49:54.805885 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m16:49:54.809938 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
),

derived_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '3' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`DESCRIPTION` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`NAME` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m16:49:54.924408 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m16:49:54.935641 [debug] [Thread-4  ]: finished collecting timing info
[0m16:49:54.939782 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m16:49:54.952038 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m16:49:54.980062 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_stg_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_US_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    CUSTOMER_NUMBER AS `US_CUSTOMER_KEY`,
    '101' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`US_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m16:49:55.130871 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m16:49:55.133012 [debug] [Thread-6  ]: finished collecting timing info
[0m16:49:55.133012 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m16:49:55.141152 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m16:49:55.143367 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_stg_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '1' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`TITLE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`WEALTH_BRACKET` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m16:49:55.638298 [debug] [Thread-8  ]: finished collecting timing info
[0m16:49:55.640445 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0FAFDF0>]}
[0m16:49:55.641457 [info ] [Thread-8  ]: 10 of 21 OK created view model data_vault.v_stg_customer_wealth_bracket ........ [[32mOK[0m in 2.07s]
[0m16:49:55.643580 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m16:49:55.645791 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m16:49:55.645791 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m16:49:55.646792 [info ] [Thread-5  ]: 13 of 21 START incremental model data_vault.hub_customer_wealth_bracket ........ [RUN]
[0m16:49:55.647787 [info ] [Thread-2  ]: 14 of 21 START incremental model data_vault.sat_customer_wealth_bracket ........ [RUN]
[0m16:49:55.650788 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m16:49:55.652948 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m16:49:55.653970 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m16:49:55.653970 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m16:49:55.654967 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m16:49:55.686034 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m16:49:55.863730 [info ] [Thread-5  ]: 16:49:55 + Loading steadfast-task-363413.data_vault.hub_customer_wealth_bracket from 1 source(s)
[0m16:49:56.007167 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m16:49:56.094122 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m16:49:56.094441 [debug] [Thread-5  ]: finished collecting timing info
[0m16:49:56.100579 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m16:49:56.108738 [debug] [Thread-6  ]: finished collecting timing info
[0m16:49:56.165153 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0FF0250>]}
[0m16:49:56.179544 [info ] [Thread-6  ]: 12 of 21 OK created view model data_vault.v_stg_UK_customer .................... [[32mOK[0m in 2.44s]
[0m16:49:56.180545 [debug] [Thread-2  ]: finished collecting timing info
[0m16:49:56.189787 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m16:49:56.190788 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m16:49:56.201103 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:49:56.204188 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m16:49:56.208233 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m16:49:56.209350 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m16:49:56.211350 [info ] [Thread-1  ]: 15 of 21 START incremental model data_vault.link_customer_wealth_bracket_customer  [RUN]
[0m16:49:56.213348 [info ] [Thread-3  ]: 16 of 21 START incremental model data_vault.sat_UK_customer .................... [RUN]
[0m16:49:56.215468 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m16:49:56.216474 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m16:49:56.217473 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m16:49:56.217473 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m16:49:56.218472 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_customer
[0m16:49:56.255815 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_customer
[0m16:49:56.308994 [info ] [Thread-1  ]: 16:49:56 + Loading steadfast-task-363413.data_vault.link_customer_wealth_bracket_customer from 1 source(s)
[0m16:49:56.372317 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m16:49:56.386882 [debug] [Thread-1  ]: finished collecting timing info
[0m16:49:56.391048 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m16:49:56.400211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:49:56.408545 [debug] [Thread-4  ]: finished collecting timing info
[0m16:49:56.414760 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF1093700>]}
[0m16:49:56.429114 [info ] [Thread-4  ]: 11 of 21 OK created view model data_vault.v_stg_US_customer .................... [[32mOK[0m in 2.73s]
[0m16:49:56.451802 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m16:49:56.454797 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m16:49:56.456935 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m16:49:56.456935 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m16:49:56.457951 [debug] [Thread-3  ]: finished collecting timing info
[0m16:49:56.457951 [info ] [Thread-7  ]: 17 of 21 START incremental model data_vault.hub_customer ....................... [RUN]
[0m16:49:56.458948 [info ] [Thread-6  ]: 18 of 21 START incremental model data_vault.sat_US_customer .................... [RUN]
[0m16:49:56.458948 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_customer
[0m16:49:56.535823 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer"
[0m16:49:56.536846 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer
[0m16:49:56.536846 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.hub_customer
[0m16:49:56.537839 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_US_customer"
[0m16:49:56.549905 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.sat_US_customer
[0m16:49:56.550907 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.sat_US_customer
[0m16:49:56.576057 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:49:56.583134 [info ] [Thread-7  ]: 16:49:56 + Loading steadfast-task-363413.data_vault.hub_customer from 2 source(s)
[0m16:49:56.604466 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m16:49:56.628699 [debug] [Thread-7  ]: finished collecting timing info
[0m16:49:56.635881 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m16:49:56.635881 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer
[0m16:49:56.674233 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m16:49:56.681346 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m16:49:56.688391 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m16:49:56.690392 [debug] [Thread-6  ]: finished collecting timing info
[0m16:49:56.690392 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.sat_US_customer
[0m16:49:56.695466 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m16:49:56.697464 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.hub_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`ID`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`ID`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_HK` = d.`CUSTOMER_WEALTH_BRACKET_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:49:56.697464 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.sat_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`NAME`, a.`DESCRIPTION`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS a
    WHERE a.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_WEALTH_BRACKET_HK`, current_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_WEALTH_BRACKET_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_WEALTH_BRACKET_HK` = source_records.`CUSTOMER_WEALTH_BRACKET_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_WEALTH_BRACKET_HK`, stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, stage.`NAME`, stage.`DESCRIPTION`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_WEALTH_BRACKET_HK` = stage.`CUSTOMER_WEALTH_BRACKET_HK`
        AND latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` = stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`
    WHERE latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:49:56.901735 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m16:49:56.905817 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`CUSTOMER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NOT NULL
    AND rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` = d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:49:57.018457 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m16:49:57.021599 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.sat_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_UK_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`TITLE`, a.`WEALTH_BRACKET`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_UK_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`TITLE`, stage.`WEALTH_BRACKET`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:49:57.072156 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m16:49:57.077318 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m16:49:57.080298 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.sat_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_US_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_US_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_US_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:49:57.081441 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.`CUSTOMER_HK`
               ORDER BY ru.`LOAD_DATE`, ru.`RECORD_SOURCE` ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_union AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer` AS d
    ON a.`CUSTOMER_HK` = d.`CUSTOMER_HK`
    WHERE d.`CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:50:00.244499 [debug] [Thread-1  ]: finished collecting timing info
[0m16:50:00.245482 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF22602B0>]}
[0m16:50:00.247502 [info ] [Thread-1  ]: 15 of 21 OK created incremental model data_vault.link_customer_wealth_bracket_customer  [[32mMERGE (1.0 rows, 1019.0 Bytes processed)[0m in 4.03s]
[0m16:50:00.249214 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m16:50:00.269228 [debug] [Thread-5  ]: finished collecting timing info
[0m16:50:00.271232 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF2194EB0>]}
[0m16:50:00.272425 [info ] [Thread-5  ]: 13 of 21 OK created incremental model data_vault.hub_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 870.0 Bytes processed)[0m in 4.62s]
[0m16:50:00.274234 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m16:50:00.324284 [debug] [Thread-2  ]: finished collecting timing info
[0m16:50:00.325284 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF22E2160>]}
[0m16:50:00.326285 [info ] [Thread-2  ]: 14 of 21 OK created incremental model data_vault.sat_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 1.3 KB processed)[0m in 4.67s]
[0m16:50:00.328282 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m16:50:00.649181 [debug] [Thread-7  ]: finished collecting timing info
[0m16:50:00.650181 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF22ED220>]}
[0m16:50:00.650181 [info ] [Thread-7  ]: 17 of 21 OK created incremental model data_vault.hub_customer .................. [[32mMERGE (7.0 rows, 1016.0 Bytes processed)[0m in 4.11s]
[0m16:50:00.651182 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m16:50:00.992437 [debug] [Thread-6  ]: finished collecting timing info
[0m16:50:00.993437 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF22ED4C0>]}
[0m16:50:00.994437 [info ] [Thread-6  ]: 18 of 21 OK created incremental model data_vault.sat_US_customer ............... [[32mMERGE (1.0 rows, 63.0 Bytes processed)[0m in 4.46s]
[0m16:50:00.997417 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m16:50:01.326216 [debug] [Thread-3  ]: finished collecting timing info
[0m16:50:01.327217 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF2260850>]}
[0m16:50:01.328194 [info ] [Thread-3  ]: 16 of 21 OK created incremental model data_vault.sat_UK_customer ............... [[32mMERGE (6.0 rows, 2.8 KB processed)[0m in 5.11s]
[0m16:50:01.331197 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m16:50:01.332360 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m16:50:01.333356 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m16:50:01.333356 [info ] [Thread-4  ]: 19 of 21 START view model data_vault.v_comp_customer_history ................... [RUN]
[0m16:50:01.334375 [info ] [Thread-8  ]: 20 of 21 START view model data_vault.v_comp_customers_as_is .................... [RUN]
[0m16:50:01.336375 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m16:50:01.337354 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m16:50:01.338502 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m16:50:01.339507 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_history
[0m16:50:01.340502 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m16:50:01.354933 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m16:50:01.354933 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m16:50:01.366232 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m16:50:01.369233 [debug] [Thread-4  ]: finished collecting timing info
[0m16:50:01.370242 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m16:50:01.382696 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m16:50:01.382696 [debug] [Thread-8  ]: finished collecting timing info
[0m16:50:01.383676 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m16:50:01.397803 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m16:50:01.398804 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:50:01.400653 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_comp_customer_history: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_history"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_history`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.customer_id, s_uk.first_name,
        s_uk.last_name, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
        s_uk.effective_from, s_uk.crud_flag, s_uk.load_date
        from h, s_uk
        where s_uk.customer_hk = h.customer_hk
        union all
        select h.customer_hk, h.customer_number, s_us.customer_id, s_us.first_name,
        s_us.last_name, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
        s_us.effective_from, s_us.crud_flag, s_us.load_date
        from h, s_us
        where s_us.customer_hk = h.customer_hk)
select * from joined;


[0m16:50:01.404648 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m16:50:01.406647 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_comp_customers_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customers_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number, record_source
        from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.crud_flag, s_uk.customer_id,
                s_uk.title, s_uk.first_name, s_uk.last_name, s_uk.wealth_bracket, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
                s_uk.effective_from, s_uk.load_date, h.record_source,
                row_number() over(partition by s_uk.customer_hk order by s_uk.applieddate desc) as rn
         from h, s_uk
         where s_uk.customer_hk = h.customer_hk
         union all
         select h.customer_hk, h.customer_number, s_us.crud_flag, s_us.customer_id,
                '' as title, s_us.first_name, s_us.last_name, null as wealth_bracket, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
                s_us.effective_from, s_us.load_date, h.record_source,
                row_number() over(partition by s_us.customer_hk order by s_us.applieddate desc) as rn
         from h, s_us
         )
select customer_hk, customer_id, customer_number, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate, applieddate, effective_from, load_date, record_source from joined
where rn = 1 and crud_flag <> 'D';


[0m16:50:02.686314 [debug] [Thread-4  ]: finished collecting timing info
[0m16:50:02.687380 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF10849A0>]}
[0m16:50:02.689362 [info ] [Thread-4  ]: 19 of 21 OK created view model data_vault.v_comp_customer_history .............. [[32mOK[0m in 1.35s]
[0m16:50:02.698700 [debug] [Thread-8  ]: finished collecting timing info
[0m16:50:02.699683 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '990f7a0a-ee6d-4a8a-8a6c-2f3afbb385cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF1002940>]}
[0m16:50:02.700684 [info ] [Thread-8  ]: 20 of 21 OK created view model data_vault.v_comp_customers_as_is ............... [[32mOK[0m in 1.36s]
[0m16:50:02.702808 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m16:50:02.704333 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m16:50:02.705340 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m16:50:02.706336 [info ] [Thread-5  ]: 21 of 21 SKIP relation data_vault.v_comp_customer_orders_as_is ................. [[33mSKIP[0m]
[0m16:50:02.708628 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m16:50:02.712737 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:50:02.714777 [info ] [MainThread]: 
[0m16:50:02.716462 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 12.03 seconds (12.03s).
[0m16:50:02.717486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:02.718485 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m16:50:02.718485 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m16:50:02.719469 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer' was properly closed.
[0m16:50:02.719469 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_customer_wealth_bracket' was properly closed.
[0m16:50:02.719469 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_UK_customer' was properly closed.
[0m16:50:02.720467 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_history' was properly closed.
[0m16:50:02.720467 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customers_as_is' was properly closed.
[0m16:50:02.720467 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_US_customer' was properly closed.
[0m16:50:02.721466 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_customer_wealth_bracket' was properly closed.
[0m16:50:02.721466 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_customer' was properly closed.
[0m16:50:02.757914 [info ] [MainThread]: 
[0m16:50:02.758910 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:50:02.758910 [info ] [MainThread]: 
[0m16:50:02.759920 [error] [MainThread]: [33mRuntime Error in model v_raw_order (models\raw_stage\v_raw_order.sql)[0m
[0m16:50:02.760912 [error] [MainThread]:   404 Not found: Table steadfast-task-363413:staging.repl_orders was not found in location US
[0m16:50:02.761913 [error] [MainThread]:   
[0m16:50:02.761913 [error] [MainThread]:   (job ID: 83481050-d266-460d-b45f-8c26b68f478e)
[0m16:50:02.762913 [info ] [MainThread]: 
[0m16:50:02.763912 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=6 TOTAL=21
[0m16:50:02.765913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0C6FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0EF0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027EF0EF18E0>]}
[0m16:50:02.765913 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 16:51:25.063043 | 543436e0-7fcc-4ed0-8086-87ba952dd692 ==============================
[0m16:51:25.063043 [info ] [MainThread]: Running with dbt=1.2.2
[0m16:51:25.064028 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:51:25.064028 [debug] [MainThread]: Tracking: tracking
[0m16:51:25.065043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CC806D4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CC806DAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CC806DB20>]}
[0m16:51:25.604956 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
[0m16:51:25.604956 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_UK_order.sql
[0m16:51:25.606003 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\stage\v_stg_UK_order.sql
[0m16:51:25.606003 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_order.sql
[0m16:51:25.606988 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\stage\v_stg_order.sql
[0m16:51:25.607989 [debug] [MainThread]: Partial parsing: updated file: dbtvault_bigquery_demo://models\raw_vault\links\link_customer_order.sql
[0m16:51:25.632375 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_order.sql
[0m16:51:25.860948 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_order.sql
[0m16:51:25.863034 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_order.sql
[0m16:51:26.197665 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_order.sql
[0m16:51:26.202784 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m16:51:26.209923 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m16:51:26.218097 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m16:51:26.313866 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m16:51:26.317863 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m16:51:26.412833 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m16:51:26.415977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CC8355DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CC833FDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017CC82EE8B0>]}
[0m16:51:26.416980 [debug] [MainThread]: Flushing usage events
[0m16:51:26.973613 [error] [MainThread]: Encountered an error:
Compilation Error in model sat_UK_order (models\raw_vault\sats\sat_UK_order.sql)
  Model 'model.dbtvault_bigquery_demo.sat_UK_order' (models\raw_vault\sats\sat_UK_order.sql) depends on a node named 'v_stg_order' which was not found
[0m16:51:27.101843 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 131, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 193, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 240, in run_from_args
    results = task.run()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 451, in run
    self._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 391, in load
    self.process_refs(self.root_project.project_name)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 830, in process_refs
    _process_refs_for_node(self.manifest, current_project, node)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 1230, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 939, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 631, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 445, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model sat_UK_order (models\raw_vault\sats\sat_UK_order.sql)
  Model 'model.dbtvault_bigquery_demo.sat_UK_order' (models\raw_vault\sats\sat_UK_order.sql) depends on a node named 'v_stg_order' which was not found



============================== 2022-11-05 16:52:05.986746 | 7cdf5aa3-def0-4c3d-8610-60ed05bb9f6b ==============================
[0m16:52:05.986746 [info ] [MainThread]: Running with dbt=1.2.2
[0m16:52:05.987774 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:52:05.987774 [debug] [MainThread]: Tracking: tracking
[0m16:52:05.989774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119224A3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119224ABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002119224AD00>]}
[0m16:52:06.423883 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 1 files changed.
[0m16:52:06.423883 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_stage\v_raw_UK_order.sql
[0m16:52:06.425039 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\stage\v_stg_UK_order.sql
[0m16:52:06.425039 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_UK_order.sql
[0m16:52:06.425039 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_order.sql
[0m16:52:06.426035 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_stage\v_raw_order.sql
[0m16:52:06.426035 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\stage\v_stg_order.sql
[0m16:52:06.426035 [debug] [MainThread]: Partial parsing: updated file: dbtvault_bigquery_demo://models\raw_vault\links\link_customer_order.sql
[0m16:52:06.461999 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_order.sql
[0m16:52:06.486622 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_order.sql
[0m16:52:06.946073 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_order.sql
[0m16:52:06.949070 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_order.sql
[0m16:52:07.167625 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_order.sql
[0m16:52:07.170628 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m16:52:07.176747 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m16:52:07.181824 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m16:52:07.256822 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m16:52:07.259822 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m16:52:07.331548 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m16:52:07.333547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021192524970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211924BE280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211921D9BB0>]}
[0m16:52:07.335551 [debug] [MainThread]: Flushing usage events
[0m16:52:07.897501 [error] [MainThread]: Encountered an error:
Compilation Error in model v_raw_UK_order (models\raw_stage\v_raw_UK_order.sql)
  Model 'model.dbtvault_bigquery_demo.v_raw_UK_order' (models\raw_stage\v_raw_UK_order.sql) depends on a source named 'dbtvault_bigquery_demo.repl_UK_orders' which was not found
[0m16:52:07.903501 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 131, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 193, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 240, in run_from_args
    results = task.run()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 451, in run
    self._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 390, in load
    self.process_sources(self.root_project.project_name)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 921, in process_sources
    _process_sources_for_node(self.manifest, current_project, node)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 1302, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 955, in invalid_source_fail_unless_test
    source_target_not_found(node, target_name, target_table_name, disabled=disabled)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 656, in source_target_not_found
    raise_compiler_error(msg, model)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 445, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model v_raw_UK_order (models\raw_stage\v_raw_UK_order.sql)
  Model 'model.dbtvault_bigquery_demo.v_raw_UK_order' (models\raw_stage\v_raw_UK_order.sql) depends on a source named 'dbtvault_bigquery_demo.repl_UK_orders' which was not found



============================== 2022-11-05 16:52:54.696105 | 42c2842e-8f2e-441d-99f4-195525ce9485 ==============================
[0m16:52:54.696105 [info ] [MainThread]: Running with dbt=1.2.2
[0m16:52:54.697109 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:52:54.697109 [debug] [MainThread]: Tracking: tracking
[0m16:52:54.698168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA54AAABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA54AAAFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA54AAABE0>]}
[0m16:52:55.139301 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 2 files changed.
[0m16:52:55.140301 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\stage\v_stg_UK_order.sql
[0m16:52:55.140472 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_stage\v_raw_UK_order.sql
[0m16:52:55.140472 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_UK_order.sql
[0m16:52:55.141468 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_UK_customers
[0m16:52:55.142469 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_US_customers
[0m16:52:55.142469 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_orders
[0m16:52:55.143469 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_customer_wealth_brackets
[0m16:52:55.143469 [debug] [MainThread]: Partial parsing: update schema file: dbtvault_bigquery_demo://models\schema.yml
[0m16:52:55.143469 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_stage\v_raw_order.sql
[0m16:52:55.143469 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_order.sql
[0m16:52:55.144469 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\stage\v_stg_order.sql
[0m16:52:55.144469 [debug] [MainThread]: Partial parsing: updated file: dbtvault_bigquery_demo://models\raw_vault\links\link_customer_order.sql
[0m16:52:55.170974 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_order.sql
[0m16:52:55.658448 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_order.sql
[0m16:52:55.662448 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_order.sql
[0m16:52:55.668449 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_order.sql
[0m16:52:55.861758 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_order.sql
[0m16:52:55.864757 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m16:52:55.869888 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m16:52:55.876466 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m16:52:55.881622 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m16:52:55.956490 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m16:52:55.959652 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m16:52:56.030953 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m16:52:56.034020 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m16:52:56.088388 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m16:52:56.094397 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m16:52:56.199221 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m16:52:56.202355 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m16:52:56.207500 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m16:52:56.260774 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m16:52:56.262774 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m16:52:56.319037 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m16:52:56.321040 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m16:52:56.325125 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m16:52:56.339374 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m16:52:56.341374 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m16:52:56.366813 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m16:52:56.367814 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m16:52:56.409365 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m16:52:56.411365 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m16:52:56.414365 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m16:52:56.417406 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m16:52:56.433648 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m16:52:56.434649 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m16:52:56.453073 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m16:52:56.473440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA54D96E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA54F03FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA54F03F40>]}
[0m16:52:56.473440 [debug] [MainThread]: Flushing usage events
[0m16:52:57.245134 [error] [MainThread]: Encountered an error:
Compilation Error in model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
  Model 'model.dbtvault_bigquery_demo.v_stg_UK_order' (models\stage\v_stg_UK_order.sql) depends on a node named 'v_raw_order' which was not found
[0m16:52:57.253133 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 131, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 193, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 240, in run_from_args
    results = task.run()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 451, in run
    self._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 391, in load
    self.process_refs(self.root_project.project_name)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 830, in process_refs
    _process_refs_for_node(self.manifest, current_project, node)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 1230, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 939, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 631, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 445, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
  Model 'model.dbtvault_bigquery_demo.v_stg_UK_order' (models\stage\v_stg_UK_order.sql) depends on a node named 'v_raw_order' which was not found



============================== 2022-11-05 16:53:36.764826 | 3687ec36-f1b5-41f3-90da-575b586eee29 ==============================
[0m16:53:36.764826 [info ] [MainThread]: Running with dbt=1.2.2
[0m16:53:36.766161 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:53:36.766161 [debug] [MainThread]: Tracking: tracking
[0m16:53:36.767588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A3BBA7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A3BBAC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A3BBAF40>]}
[0m16:53:37.113875 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 2 files changed.
[0m16:53:37.113875 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_UK_order.sql
[0m16:53:37.114875 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_stage\v_raw_UK_order.sql
[0m16:53:37.114875 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\stage\v_stg_UK_order.sql
[0m16:53:37.115874 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_UK_customers
[0m16:53:37.115874 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_US_customers
[0m16:53:37.115874 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_orders
[0m16:53:37.116873 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_customer_wealth_brackets
[0m16:53:37.116873 [debug] [MainThread]: Partial parsing: update schema file: dbtvault_bigquery_demo://models\schema.yml
[0m16:53:37.116873 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\stage\v_stg_order.sql
[0m16:53:37.116873 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_stage\v_raw_order.sql
[0m16:53:37.116873 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_order.sql
[0m16:53:37.117873 [debug] [MainThread]: Partial parsing: updated file: dbtvault_bigquery_demo://models\raw_vault\links\link_customer_order.sql
[0m16:53:37.143985 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_order.sql
[0m16:53:37.450367 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_order.sql
[0m16:53:37.457491 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_order.sql
[0m16:53:37.463082 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_order.sql
[0m16:53:37.736849 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_order.sql
[0m16:53:37.740832 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m16:53:37.749100 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m16:53:37.756237 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m16:53:37.762404 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m16:53:37.843226 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m16:53:37.846412 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m16:53:37.918230 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m16:53:37.922214 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m16:53:37.975680 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m16:53:37.978834 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m16:53:38.085609 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m16:53:38.088594 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m16:53:38.094123 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m16:53:38.147340 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m16:53:38.150490 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m16:53:38.227434 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m16:53:38.230564 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m16:53:38.235711 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m16:53:38.261346 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m16:53:38.264346 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m16:53:38.305504 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m16:53:38.308669 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m16:53:38.378132 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m16:53:38.381136 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m16:53:38.386303 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m16:53:38.394438 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m16:53:38.422224 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m16:53:38.425379 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m16:53:38.455239 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m16:53:38.491746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A3EA70D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A3FE6040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A3FE61C0>]}
[0m16:53:38.492749 [debug] [MainThread]: Flushing usage events
[0m16:53:39.062816 [error] [MainThread]: Encountered an error:
Compilation Error in model sat_UK_order (models\raw_vault\sats\sat_UK_order.sql)
  Model 'model.dbtvault_bigquery_demo.sat_UK_order' (models\raw_vault\sats\sat_UK_order.sql) depends on a node named 'v_stg_order' which was not found
[0m16:53:39.071818 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 131, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 193, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 240, in run_from_args
    results = task.run()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 451, in run
    self._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 391, in load
    self.process_refs(self.root_project.project_name)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 830, in process_refs
    _process_refs_for_node(self.manifest, current_project, node)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 1230, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 939, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 631, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 445, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model sat_UK_order (models\raw_vault\sats\sat_UK_order.sql)
  Model 'model.dbtvault_bigquery_demo.sat_UK_order' (models\raw_vault\sats\sat_UK_order.sql) depends on a node named 'v_stg_order' which was not found



============================== 2022-11-05 16:54:04.374057 | 20bfe6e9-3bc7-4b95-bbfb-778428be41d2 ==============================
[0m16:54:04.374057 [info ] [MainThread]: Running with dbt=1.2.2
[0m16:54:04.376056 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:54:04.376056 [debug] [MainThread]: Tracking: tracking
[0m16:54:04.378068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAAFED130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAAFED550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAAFEDD90>]}
[0m16:54:04.862231 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 2 files changed.
[0m16:54:04.863249 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_UK_order.sql
[0m16:54:04.864249 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\stage\v_stg_UK_order.sql
[0m16:54:04.864249 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_stage\v_raw_UK_order.sql
[0m16:54:04.865248 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_UK_customers
[0m16:54:04.866248 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_US_customers
[0m16:54:04.866248 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_orders
[0m16:54:04.866248 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_customer_wealth_brackets
[0m16:54:04.867248 [debug] [MainThread]: Partial parsing: update schema file: dbtvault_bigquery_demo://models\schema.yml
[0m16:54:04.867584 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_stage\v_raw_order.sql
[0m16:54:04.867584 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_order.sql
[0m16:54:04.867584 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\stage\v_stg_order.sql
[0m16:54:04.868600 [debug] [MainThread]: Partial parsing: updated file: dbtvault_bigquery_demo://models\raw_vault\links\link_customer_order.sql
[0m16:54:04.896764 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_order.sql
[0m16:54:05.161578 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_order.sql
[0m16:54:05.163579 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_order.sql
[0m16:54:05.333954 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_order.sql
[0m16:54:05.335952 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_order.sql
[0m16:54:05.340956 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m16:54:05.343952 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m16:54:05.350827 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m16:54:05.354825 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m16:54:05.415729 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m16:54:05.417756 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m16:54:05.460258 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m16:54:05.462257 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m16:54:05.493549 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m16:54:05.495595 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m16:54:05.600423 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m16:54:05.603553 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m16:54:05.610718 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m16:54:05.664938 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m16:54:05.668085 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m16:54:05.798363 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m16:54:05.801363 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m16:54:05.807876 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m16:54:05.835467 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m16:54:05.838467 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m16:54:05.883705 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m16:54:05.886705 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m16:54:05.955863 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m16:54:05.958850 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m16:54:05.965047 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m16:54:05.970032 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m16:54:05.999735 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m16:54:06.003736 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m16:54:06.040054 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m16:54:06.073686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAB2E4F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAB44F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAB44F1F0>]}
[0m16:54:06.073686 [debug] [MainThread]: Flushing usage events
[0m16:54:06.632693 [error] [MainThread]: Encountered an error:
Compilation Error in model v_comp_orders_as_is (models\consumption_layer\v_comp_orders_as_is.sql)
  Model 'model.dbtvault_bigquery_demo.v_comp_orders_as_is' (models\consumption_layer\v_comp_orders_as_is.sql) depends on a node named 'sat_order' which was not found
[0m16:54:06.638691 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 131, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 193, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 240, in run_from_args
    results = task.run()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 451, in run
    self._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 391, in load
    self.process_refs(self.root_project.project_name)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 830, in process_refs
    _process_refs_for_node(self.manifest, current_project, node)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 1230, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 939, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 631, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 445, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model v_comp_orders_as_is (models\consumption_layer\v_comp_orders_as_is.sql)
  Model 'model.dbtvault_bigquery_demo.v_comp_orders_as_is' (models\consumption_layer\v_comp_orders_as_is.sql) depends on a node named 'sat_order' which was not found



============================== 2022-11-05 16:54:47.749201 | 3d253ccc-b507-438e-90ed-dc1f24a8179c ==============================
[0m16:54:47.749201 [info ] [MainThread]: Running with dbt=1.2.2
[0m16:54:47.750199 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:54:47.750199 [debug] [MainThread]: Tracking: tracking
[0m16:54:47.751214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A1E9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A1E9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A1E94C0>]}
[0m16:54:48.143929 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 3 files changed.
[0m16:54:48.144926 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_UK_order.sql
[0m16:54:48.144926 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_stage\v_raw_UK_order.sql
[0m16:54:48.145927 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\stage\v_stg_UK_order.sql
[0m16:54:48.146935 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_UK_customers
[0m16:54:48.146935 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_US_customers
[0m16:54:48.147926 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_orders
[0m16:54:48.147926 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_customer_wealth_brackets
[0m16:54:48.147926 [debug] [MainThread]: Partial parsing: update schema file: dbtvault_bigquery_demo://models\schema.yml
[0m16:54:48.148927 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_stage\v_raw_order.sql
[0m16:54:48.148927 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_order.sql
[0m16:54:48.148927 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\stage\v_stg_order.sql
[0m16:54:48.149926 [debug] [MainThread]: Partial parsing: updated file: dbtvault_bigquery_demo://models\raw_vault\links\link_customer_order.sql
[0m16:54:48.150095 [debug] [MainThread]: Partial parsing: updated file: dbtvault_bigquery_demo://models\consumption_layer\v_comp_orders_as_is.sql
[0m16:54:48.175634 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_order.sql
[0m16:54:48.541464 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_order.sql
[0m16:54:48.545595 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_order.sql
[0m16:54:48.551710 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_order.sql
[0m16:54:48.832465 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_order.sql
[0m16:54:48.835463 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m16:54:48.840596 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m16:54:48.847873 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m16:54:48.854000 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m16:54:48.930814 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m16:54:48.933993 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m16:54:49.000110 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m16:54:49.004264 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m16:54:49.055629 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m16:54:49.058618 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m16:54:49.166449 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m16:54:49.169459 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m16:54:49.175573 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m16:54:49.232150 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m16:54:49.235293 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m16:54:49.315491 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m16:54:49.317491 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m16:54:49.324687 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m16:54:49.352350 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m16:54:49.355350 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m16:54:49.398442 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m16:54:49.401610 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m16:54:49.453669 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m16:54:49.455712 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m16:54:49.458802 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m16:54:49.462797 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m16:54:49.477985 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m16:54:49.479985 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m16:54:49.497141 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m16:54:49.517381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A4E5C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A64C4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002057A64C760>]}
[0m16:54:49.517381 [debug] [MainThread]: Flushing usage events
[0m16:54:50.016748 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_order (models\raw_vault\hubs\hub_order.sql)
  Model 'model.dbtvault_bigquery_demo.hub_order' (models\raw_vault\hubs\hub_order.sql) depends on a node named 'v_stg_order' which was not found
[0m16:54:50.023753 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 131, in main
    results, succeeded = handle_and_check(args)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 193, in handle_and_check
    task, res = run_from_args(parsed)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\main.py", line 240, in run_from_args
    results = task.run()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 451, in run
    self._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\task\runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 391, in load
    self.process_refs(self.root_project.project_name)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 830, in process_refs
    _process_refs_for_node(self.manifest, current_project, node)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 1230, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\parser\manifest.py", line 939, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 631, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "C:\Users\james\PycharmProjects\Data_Vault_Code-Advanced_Topics\venv\lib\site-packages\dbt\exceptions.py", line 445, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model hub_order (models\raw_vault\hubs\hub_order.sql)
  Model 'model.dbtvault_bigquery_demo.hub_order' (models\raw_vault\hubs\hub_order.sql) depends on a node named 'v_stg_order' which was not found



============================== 2022-11-05 16:55:11.294645 | 885b9272-884c-4116-9d1b-0b98b310a09e ==============================
[0m16:55:11.294645 [info ] [MainThread]: Running with dbt=1.2.2
[0m16:55:11.296633 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:55:11.296633 [debug] [MainThread]: Tracking: tracking
[0m16:55:11.297737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B275AEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B275A0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B275AF70>]}
[0m16:55:11.735697 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 4 files changed.
[0m16:55:11.736695 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_UK_order.sql
[0m16:55:11.736695 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\stage\v_stg_UK_order.sql
[0m16:55:11.736695 [debug] [MainThread]: Partial parsing: added file: dbtvault_bigquery_demo://models\raw_stage\v_raw_UK_order.sql
[0m16:55:11.737696 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_UK_customers
[0m16:55:11.737696 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_US_customers
[0m16:55:11.738704 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_orders
[0m16:55:11.738704 [debug] [MainThread]: Partial parsing: deleted source source.dbtvault_bigquery_demo.dbtvault_bigquery_demo.repl_customer_wealth_brackets
[0m16:55:11.738704 [debug] [MainThread]: Partial parsing: update schema file: dbtvault_bigquery_demo://models\schema.yml
[0m16:55:11.738704 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_vault\sats\sat_order.sql
[0m16:55:11.739768 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\stage\v_stg_order.sql
[0m16:55:11.739768 [debug] [MainThread]: Partial parsing: deleted file: dbtvault_bigquery_demo://models\raw_stage\v_raw_order.sql
[0m16:55:11.739768 [debug] [MainThread]: Partial parsing: updated file: dbtvault_bigquery_demo://models\raw_vault\hubs\hub_order.sql
[0m16:55:11.739768 [debug] [MainThread]: Partial parsing: updated file: dbtvault_bigquery_demo://models\consumption_layer\v_comp_orders_as_is.sql
[0m16:55:11.739768 [debug] [MainThread]: Partial parsing: updated file: dbtvault_bigquery_demo://models\raw_vault\links\link_customer_order.sql
[0m16:55:11.757023 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_order.sql
[0m16:55:12.025099 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_order.sql
[0m16:55:12.026487 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_order.sql
[0m16:55:12.207160 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_order.sql
[0m16:55:12.211257 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_order.sql
[0m16:55:12.217458 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m16:55:12.223683 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m16:55:12.230125 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m16:55:12.237519 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m16:55:12.314311 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m16:55:12.317630 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m16:55:12.389126 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m16:55:12.392253 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m16:55:12.449668 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m16:55:12.452884 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m16:55:12.560288 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m16:55:12.563459 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m16:55:12.568693 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m16:55:12.620957 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m16:55:12.623957 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m16:55:12.709673 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m16:55:12.712672 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m16:55:12.720017 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m16:55:12.748059 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m16:55:12.751209 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m16:55:12.792818 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m16:55:12.795823 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m16:55:12.868399 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m16:55:12.870626 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m16:55:12.878077 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m16:55:12.885266 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m16:55:12.914740 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m16:55:12.917981 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m16:55:12.948181 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m16:55:13.082516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2C400D0>]}
[0m16:55:13.115797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B1CAE520>]}
[0m16:55:13.115797 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 3 seed files, 4 sources, 0 exposures, 0 metrics
[0m16:55:13.117805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2A06580>]}
[0m16:55:13.122946 [info ] [MainThread]: 
[0m16:55:13.123941 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:55:13.134235 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m16:55:13.135311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:13.789675 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m16:55:13.790675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:14.204927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2A06760>]}
[0m16:55:14.206927 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:55:14.207930 [info ] [MainThread]: 
[0m16:55:14.233932 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m16:55:14.234930 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m16:55:14.234930 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m16:55:14.235932 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m16:55:14.235932 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m16:55:14.236932 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_UK_order ............................. [RUN]
[0m16:55:14.236932 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m16:55:14.237929 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m16:55:14.239930 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m16:55:14.240930 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m16:55:14.242932 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m16:55:14.242932 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m16:55:14.243931 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m16:55:14.244931 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m16:55:14.254734 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m16:55:14.255734 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_order
[0m16:55:14.256717 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m16:55:14.256717 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m16:55:14.269046 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m16:55:14.270190 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m16:55:14.270190 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m16:55:14.271190 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m16:55:14.282577 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m16:55:14.283960 [debug] [Thread-1  ]: finished collecting timing info
[0m16:55:14.295109 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m16:55:14.293108 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m16:55:14.294107 [debug] [Thread-2  ]: finished collecting timing info
[0m16:55:14.343889 [debug] [Thread-3  ]: finished collecting timing info
[0m16:55:14.390729 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m16:55:14.394706 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m16:55:14.395451 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m16:55:14.396450 [debug] [Thread-4  ]: finished collecting timing info
[0m16:55:14.403611 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m16:55:14.413483 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m16:55:14.413483 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m16:55:14.421640 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m16:55:14.421640 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:55:14.422653 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m16:55:14.427766 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:55:14.428765 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m16:55:14.429858 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_UK_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m16:55:14.430879 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:55:14.430879 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m16:55:14.433879 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m16:55:15.672219 [debug] [Thread-4  ]: finished collecting timing info
[0m16:55:15.674219 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2C86640>]}
[0m16:55:15.676222 [info ] [Thread-4  ]: 4 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.42s]
[0m16:55:15.682220 [debug] [Thread-2  ]: finished collecting timing info
[0m16:55:15.688220 [debug] [Thread-3  ]: finished collecting timing info
[0m16:55:15.690222 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2D73CA0>]}
[0m16:55:15.691221 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2C865E0>]}
[0m16:55:15.692777 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_UK_order ........................ [[32mOK[0m in 1.45s]
[0m16:55:15.693779 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.45s]
[0m16:55:15.694778 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m16:55:15.698794 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m16:55:15.699796 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m16:55:15.700782 [info ] [Thread-6  ]: 5 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m16:55:15.702780 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m16:55:15.702780 [info ] [Thread-8  ]: 6 of 21 START view model data_vault.v_stg_UK_order ............................. [RUN]
[0m16:55:15.703781 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m16:55:15.706786 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m16:55:15.707778 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m16:55:15.707778 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m16:55:15.709779 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m16:55:15.710783 [info ] [Thread-4  ]: 7 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m16:55:15.710783 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m16:55:15.711781 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m16:55:15.727780 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m16:55:15.730780 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m16:55:15.730780 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_order
[0m16:55:15.730780 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m16:55:15.740788 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m16:55:15.742780 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m16:55:15.758780 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:55:15.764796 [debug] [Thread-1  ]: finished collecting timing info
[0m16:55:15.765780 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2C8CE80>]}
[0m16:55:15.766781 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.53s]
[0m16:55:15.767782 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m16:55:15.768783 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m16:55:15.768783 [info ] [Thread-2  ]: 8 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m16:55:15.769783 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m16:55:15.769783 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m16:55:15.769783 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m16:55:15.780792 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:55:16.592235 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m16:55:16.594218 [debug] [Thread-6  ]: finished collecting timing info
[0m16:55:16.595220 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m16:55:16.603400 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m16:55:16.605384 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
),

derived_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '3' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`DESCRIPTION` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`NAME` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m16:55:17.205816 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m16:55:17.225142 [debug] [Thread-8  ]: finished collecting timing info
[0m16:55:17.228301 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m16:55:17.237483 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m16:55:17.258482 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_stg_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_order`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
),

derived_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    ORDER_NUMBER AS `ORDER_KEY`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    '2' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), '')))) AS STRING) AS `ORDER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_ORDER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_PRICE` AS STRING))), ''), '^^')
    )))) AS `ORDER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `ORDER_HK`,
    `CUSTOMER_HK`,
    `CUSTOMER_ORDER_HK`,
    `ORDER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m16:55:17.271897 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m16:55:17.287361 [debug] [Thread-4  ]: finished collecting timing info
[0m16:55:17.290378 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m16:55:17.305847 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m16:55:17.326254 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_stg_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_US_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    CUSTOMER_NUMBER AS `US_CUSTOMER_KEY`,
    '101' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`US_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m16:55:17.436209 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m16:55:17.437210 [debug] [Thread-2  ]: finished collecting timing info
[0m16:55:17.438209 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m16:55:17.446594 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m16:55:17.448594 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_stg_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '1' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`TITLE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`WEALTH_BRACKET` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m16:55:17.750553 [debug] [Thread-6  ]: finished collecting timing info
[0m16:55:17.751735 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2BD45E0>]}
[0m16:55:17.751735 [info ] [Thread-6  ]: 5 of 21 OK created view model data_vault.v_stg_customer_wealth_bracket ......... [[32mOK[0m in 2.05s]
[0m16:55:17.752849 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m16:55:17.753854 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m16:55:17.753854 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m16:55:17.754851 [info ] [Thread-3  ]: 9 of 21 START incremental model data_vault.hub_customer_wealth_bracket ......... [RUN]
[0m16:55:17.754851 [info ] [Thread-7  ]: 10 of 21 START incremental model data_vault.sat_customer_wealth_bracket ........ [RUN]
[0m16:55:17.755603 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m16:55:17.756604 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m16:55:17.756604 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m16:55:17.756604 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m16:55:17.772810 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m16:55:17.778992 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m16:55:17.801295 [info ] [Thread-3  ]: 16:55:17 + Loading steadfast-task-363413.data_vault.hub_customer_wealth_bracket from 1 source(s)
[0m16:55:17.815459 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m16:55:17.825644 [debug] [Thread-3  ]: finished collecting timing info
[0m16:55:17.826635 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m16:55:17.847001 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m16:55:17.883521 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:55:17.886512 [debug] [Thread-7  ]: finished collecting timing info
[0m16:55:17.887585 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m16:55:17.891581 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m16:55:18.351214 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m16:55:18.354202 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m16:55:18.357546 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.hub_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`ID`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`ID`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_HK` = d.`CUSTOMER_WEALTH_BRACKET_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:55:18.357546 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.sat_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`NAME`, a.`DESCRIPTION`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS a
    WHERE a.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_WEALTH_BRACKET_HK`, current_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_WEALTH_BRACKET_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_WEALTH_BRACKET_HK` = source_records.`CUSTOMER_WEALTH_BRACKET_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_WEALTH_BRACKET_HK`, stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, stage.`NAME`, stage.`DESCRIPTION`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_WEALTH_BRACKET_HK` = stage.`CUSTOMER_WEALTH_BRACKET_HK`
        AND latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` = stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`
    WHERE latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:55:18.390572 [debug] [Thread-2  ]: finished collecting timing info
[0m16:55:18.391704 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2B30340>]}
[0m16:55:18.392704 [info ] [Thread-2  ]: 8 of 21 OK created view model data_vault.v_stg_UK_customer ..................... [[32mOK[0m in 2.62s]
[0m16:55:18.394702 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m16:55:18.396702 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m16:55:18.397705 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m16:55:18.398703 [info ] [Thread-5  ]: 11 of 21 START incremental model data_vault.link_customer_wealth_bracket_customer  [RUN]
[0m16:55:18.398703 [info ] [Thread-6  ]: 12 of 21 START incremental model data_vault.sat_UK_customer .................... [RUN]
[0m16:55:18.400708 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m16:55:18.401701 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m16:55:18.403843 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m16:55:18.403902 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m16:55:18.404899 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_customer
[0m16:55:18.417228 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_customer
[0m16:55:18.453661 [info ] [Thread-5  ]: 16:55:18 + Loading steadfast-task-363413.data_vault.link_customer_wealth_bracket_customer from 1 source(s)
[0m16:55:18.474495 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m16:55:18.483489 [debug] [Thread-5  ]: finished collecting timing info
[0m16:55:18.486612 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m16:55:18.513321 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m16:55:18.533705 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m16:55:18.537825 [debug] [Thread-6  ]: finished collecting timing info
[0m16:55:18.538827 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_customer
[0m16:55:18.547143 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m16:55:18.573094 [debug] [Thread-4  ]: finished collecting timing info
[0m16:55:18.574323 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2D5B6D0>]}
[0m16:55:18.575317 [info ] [Thread-4  ]: 7 of 21 OK created view model data_vault.v_stg_US_customer ..................... [[32mOK[0m in 2.85s]
[0m16:55:18.580321 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m16:55:18.582319 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m16:55:18.582319 [info ] [Thread-2  ]: 13 of 21 START incremental model data_vault.hub_customer ....................... [RUN]
[0m16:55:18.584318 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m16:55:18.585319 [info ] [Thread-1  ]: 14 of 21 START incremental model data_vault.sat_US_customer .................... [RUN]
[0m16:55:18.588318 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer"
[0m16:55:18.588318 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer
[0m16:55:18.589318 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.hub_customer
[0m16:55:18.591457 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_US_customer"
[0m16:55:18.603732 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.sat_US_customer
[0m16:55:18.605730 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.sat_US_customer
[0m16:55:18.633253 [debug] [Thread-8  ]: finished collecting timing info
[0m16:55:18.636244 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2D5DDF0>]}
[0m16:55:18.639408 [info ] [Thread-8  ]: 6 of 21 OK created view model data_vault.v_stg_UK_order ........................ [[32mOK[0m in 2.93s]
[0m16:55:18.648140 [info ] [Thread-2  ]: 16:55:18 + Loading steadfast-task-363413.data_vault.hub_customer from 2 source(s)
[0m16:55:18.654401 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m16:55:18.659520 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m16:55:18.663524 [info ] [Thread-4  ]: 15 of 21 START incremental model data_vault.hub_order .......................... [RUN]
[0m16:55:18.666263 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m16:55:18.667265 [info ] [Thread-8  ]: 16 of 21 START incremental model data_vault.link_customer_order ................ [RUN]
[0m16:55:18.670923 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_order"
[0m16:55:18.675918 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.hub_order
[0m16:55:18.677923 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_order"
[0m16:55:18.682242 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.hub_order
[0m16:55:18.686554 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_order
[0m16:55:18.705700 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.link_customer_order
[0m16:55:18.728014 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m16:55:18.778460 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m16:55:18.783645 [debug] [Thread-2  ]: finished collecting timing info
[0m16:55:18.786798 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer
[0m16:55:18.800138 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:55:18.808419 [debug] [Thread-1  ]: finished collecting timing info
[0m16:55:18.814577 [info ] [Thread-4  ]: 16:55:18 + Loading steadfast-task-363413.data_vault.hub_order from 1 source(s)
[0m16:55:18.814577 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.sat_US_customer
[0m16:55:18.824882 [info ] [Thread-8  ]: 16:55:18 + Loading steadfast-task-363413.data_vault.link_customer_order from 1 source(s)
[0m16:55:18.839167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:55:18.854198 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m16:55:18.874945 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m16:55:18.883055 [debug] [Thread-4  ]: finished collecting timing info
[0m16:55:18.884056 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.hub_order
[0m16:55:18.884056 [debug] [Thread-8  ]: finished collecting timing info
[0m16:55:18.894340 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m16:55:18.895342 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_order
[0m16:55:18.906796 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m16:55:18.922130 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m16:55:18.925278 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`CUSTOMER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NOT NULL
    AND rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` = d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:55:18.943627 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m16:55:18.947628 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.sat_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_UK_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`TITLE`, a.`WEALTH_BRACKET`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_UK_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`TITLE`, stage.`WEALTH_BRACKET`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:55:19.250623 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m16:55:19.253623 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.sat_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_US_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_US_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_US_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:55:19.280781 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m16:55:19.283780 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.`CUSTOMER_HK`
               ORDER BY ru.`LOAD_DATE`, ru.`RECORD_SOURCE` ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_union AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer` AS d
    ON a.`CUSTOMER_HK` = d.`CUSTOMER_HK`
    WHERE d.`CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:55:19.301625 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m16:55:19.304625 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m16:55:19.308628 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`ORDER_HK`, rr.`ORDER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS rr
    WHERE rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`ORDER_HK`, a.`ORDER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_order` AS d
    ON a.`ORDER_HK` = d.`ORDER_HK`
    WHERE d.`ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:55:19.313629 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_order` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_ORDER_HK`, rr.`CUSTOMER_HK`, rr.`ORDER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS rr
    WHERE rr.`CUSTOMER_ORDER_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    AND rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_ORDER_HK`, a.`CUSTOMER_HK`, a.`ORDER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_order` AS d
    ON a.`CUSTOMER_ORDER_HK` = d.`CUSTOMER_ORDER_HK`
    WHERE d.`CUSTOMER_ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m16:55:21.608261 [debug] [Thread-3  ]: finished collecting timing info
[0m16:55:21.609262 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2B4F5E0>]}
[0m16:55:21.611259 [info ] [Thread-3  ]: 9 of 21 OK created incremental model data_vault.hub_customer_wealth_bracket .... [[32mMERGE (0.0 rows, 870.0 Bytes processed)[0m in 3.85s]
[0m16:55:21.614395 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m16:55:21.615400 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_order
[0m16:55:21.616400 [info ] [Thread-3  ]: 17 of 21 START incremental model data_vault.sat_UK_order ....................... [RUN]
[0m16:55:21.619395 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_order"
[0m16:55:21.619395 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_order
[0m16:55:21.620395 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_order
[0m16:55:21.696418 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_order"
[0m16:55:21.698545 [debug] [Thread-3  ]: finished collecting timing info
[0m16:55:21.698545 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_order
[0m16:55:21.737537 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_order"
[0m16:55:21.740663 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m16:55:21.740663 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.sat_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_order"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`sat_UK_order`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`ORDER_ID`, a.`ORDER_PRICE`, a.`CUSTOMER_ID`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS a
    WHERE a.`ORDER_HK` IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.`ORDER_HK`, stage.`ORDER_HASHDIFF`, stage.`ORDER_ID`, stage.`ORDER_PRICE`, stage.`CUSTOMER_ID`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
  );
  
[0m16:55:22.155014 [debug] [Thread-5  ]: finished collecting timing info
[0m16:55:22.156016 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2B5E8E0>]}
[0m16:55:22.157015 [info ] [Thread-5  ]: 11 of 21 OK created incremental model data_vault.link_customer_wealth_bracket_customer  [[32mMERGE (0.0 rows, 1.1 KB processed)[0m in 3.76s]
[0m16:55:22.159112 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m16:55:22.204131 [debug] [Thread-7  ]: finished collecting timing info
[0m16:55:22.205132 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2B4F6A0>]}
[0m16:55:22.206263 [info ] [Thread-7  ]: 10 of 21 OK created incremental model data_vault.sat_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 1.3 KB processed)[0m in 4.45s]
[0m16:55:22.207340 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m16:55:22.403288 [debug] [Thread-8  ]: finished collecting timing info
[0m16:55:22.404292 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2B5EEB0>]}
[0m16:55:22.405289 [info ] [Thread-8  ]: 16 of 21 OK created incremental model data_vault.link_customer_order ........... [[32mMERGE (0.0 rows, 294.0 Bytes processed)[0m in 3.73s]
[0m16:55:22.406288 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m16:55:22.464159 [debug] [Thread-2  ]: finished collecting timing info
[0m16:55:22.465176 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2BE0C70>]}
[0m16:55:22.466174 [info ] [Thread-2  ]: 13 of 21 OK created incremental model data_vault.hub_customer .................. [[32mMERGE (0.0 rows, 1.4 KB processed)[0m in 3.88s]
[0m16:55:22.468170 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m16:55:22.579812 [debug] [Thread-4  ]: finished collecting timing info
[0m16:55:22.580830 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2A2E430>]}
[0m16:55:22.580830 [info ] [Thread-4  ]: 15 of 21 OK created incremental model data_vault.hub_order ..................... [[32mMERGE (0.0 rows, 294.0 Bytes processed)[0m in 3.91s]
[0m16:55:22.582810 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m16:55:22.705593 [debug] [Thread-1  ]: finished collecting timing info
[0m16:55:22.706594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B3DE6EB0>]}
[0m16:55:22.707738 [info ] [Thread-1  ]: 14 of 21 OK created incremental model data_vault.sat_US_customer ............... [[32mMERGE (0.0 rows, 220.0 Bytes processed)[0m in 4.12s]
[0m16:55:22.709738 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m16:55:22.920102 [debug] [Thread-6  ]: finished collecting timing info
[0m16:55:22.921277 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B3E18FA0>]}
[0m16:55:22.921277 [info ] [Thread-6  ]: 12 of 21 OK created incremental model data_vault.sat_UK_customer ............... [[32mMERGE (6.0 rows, 3.7 KB processed)[0m in 4.52s]
[0m16:55:22.924017 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m16:55:22.925016 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m16:55:22.925016 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m16:55:22.926137 [info ] [Thread-5  ]: 18 of 21 START view model data_vault.v_comp_customer_history ................... [RUN]
[0m16:55:22.927134 [info ] [Thread-7  ]: 19 of 21 START view model data_vault.v_comp_customers_as_is .................... [RUN]
[0m16:55:22.929133 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m16:55:22.930154 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m16:55:22.931133 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m16:55:22.931133 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_history
[0m16:55:22.932293 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m16:55:22.946562 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m16:55:22.947210 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m16:55:22.960048 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m16:55:22.964204 [debug] [Thread-5  ]: finished collecting timing info
[0m16:55:22.964204 [debug] [Thread-7  ]: finished collecting timing info
[0m16:55:22.965203 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m16:55:22.965203 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m16:55:23.086966 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m16:55:23.088953 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m16:55:23.089955 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.v_comp_customers_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customers_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number, record_source
        from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.crud_flag, s_uk.customer_id,
                s_uk.title, s_uk.first_name, s_uk.last_name, s_uk.wealth_bracket, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
                s_uk.effective_from, s_uk.load_date, h.record_source,
                row_number() over(partition by s_uk.customer_hk order by s_uk.applieddate desc) as rn
         from h, s_uk
         where s_uk.customer_hk = h.customer_hk
         union all
         select h.customer_hk, h.customer_number, s_us.crud_flag, s_us.customer_id,
                '' as title, s_us.first_name, s_us.last_name, null as wealth_bracket, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
                s_us.effective_from, s_us.load_date, h.record_source,
                row_number() over(partition by s_us.customer_hk order by s_us.applieddate desc) as rn
         from h, s_us
         )
select customer_hk, customer_id, customer_number, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate, applieddate, effective_from, load_date, record_source from joined
where rn = 1 and crud_flag <> 'D';


[0m16:55:23.161070 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m16:55:23.164072 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m16:55:23.165072 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.v_comp_customer_history: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_history"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_history`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.customer_id, s_uk.first_name,
        s_uk.last_name, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
        s_uk.effective_from, s_uk.crud_flag, s_uk.load_date
        from h, s_uk
        where s_uk.customer_hk = h.customer_hk
        union all
        select h.customer_hk, h.customer_number, s_us.customer_id, s_us.first_name,
        s_us.last_name, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
        s_us.effective_from, s_us.crud_flag, s_us.load_date
        from h, s_us
        where s_us.customer_hk = h.customer_hk)
select * from joined;


[0m16:55:24.413156 [debug] [Thread-7  ]: finished collecting timing info
[0m16:55:24.415308 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B3E64550>]}
[0m16:55:24.417307 [info ] [Thread-7  ]: 19 of 21 OK created view model data_vault.v_comp_customers_as_is ............... [[32mOK[0m in 1.48s]
[0m16:55:24.430011 [debug] [Thread-5  ]: finished collecting timing info
[0m16:55:24.430990 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B3EADA60>]}
[0m16:55:24.431996 [info ] [Thread-5  ]: 18 of 21 OK created view model data_vault.v_comp_customer_history .............. [[32mOK[0m in 1.50s]
[0m16:55:24.433992 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m16:55:24.437108 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m16:55:24.724824 [debug] [Thread-3  ]: finished collecting timing info
[0m16:55:24.725822 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B3F21BB0>]}
[0m16:55:24.726818 [info ] [Thread-3  ]: 17 of 21 OK created incremental model data_vault.sat_UK_order .................. [[32mCREATE TABLE (0.0 rows, 294.0 Bytes processed)[0m in 3.11s]
[0m16:55:24.729819 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_order
[0m16:55:24.732817 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m16:55:24.733957 [info ] [Thread-2  ]: 20 of 21 START view model data_vault.v_comp_orders_as_is ....................... [RUN]
[0m16:55:24.735953 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m16:55:24.735953 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m16:55:24.736952 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m16:55:24.747096 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m16:55:24.750096 [debug] [Thread-2  ]: finished collecting timing info
[0m16:55:24.751235 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m16:55:24.762380 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m16:55:24.764541 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m16:55:24.765543 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_comp_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`
  OPTIONS()
  as with
    h as
        (select order_hk, order_number, record_source from `steadfast-task-363413`.`data_vault`.`hub_order`),
    s as
        (select order_hk, order_id, order_price, lastmodifieddate, createddate, effective_from, load_date,
         crud_flag, row_number() over(partition by order_hk order by lastmodifieddate desc) as rn
         from `steadfast-task-363413`.`data_vault`.`sat_UK_order`),
    co as
        (select order_hk, customer_hk from `steadfast-task-363413`.`data_vault`.`link_customer_order` ),
    joined as
        (select h.order_hk, h.order_number,
            co.customer_hk,
            s.order_id, s.order_price, s.lastmodifieddate, s.createddate, h.record_source, s.effective_from,
            s.load_date, s.crud_flag, s.rn
         from h, s, co
        where s.order_hk = h.order_hk
        and co.order_hk = h.order_hk)
select order_hk, customer_hk, order_id, order_number, order_price, lastmodifieddate, createddate,
effective_from, load_date
from joined
where rn = 1 and crud_flag <> 'D';


[0m16:55:25.723857 [debug] [Thread-2  ]: finished collecting timing info
[0m16:55:25.724859 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B3E10160>]}
[0m16:55:25.725859 [info ] [Thread-2  ]: 20 of 21 OK created view model data_vault.v_comp_orders_as_is .................. [[32mOK[0m in 0.99s]
[0m16:55:25.729856 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m16:55:25.730855 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m16:55:25.731999 [info ] [Thread-1  ]: 21 of 21 START view model data_vault.v_comp_customer_orders_as_is .............. [RUN]
[0m16:55:25.733995 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m16:55:25.733995 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m16:55:25.734994 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m16:55:25.744121 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m16:55:25.747125 [debug] [Thread-1  ]: finished collecting timing info
[0m16:55:25.748124 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m16:55:25.758333 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m16:55:25.760393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:55:25.761391 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_orders_as_is`
  OPTIONS()
  as with
    c as
        (select customer_hk, customer_number, first_name, last_name
         from `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`),
    o as
        (select customer_hk, order_number, order_price, createddate, lastmodifieddate
         from `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`),
    joined as
        (select c.customer_number, c.first_name, c.last_name, o.order_number, o.order_price,
         o.createddate, o.lastmodifieddate
         from c, o
         where o.customer_hk = c.customer_hk)
select * from joined;


[0m16:55:27.069374 [debug] [Thread-1  ]: finished collecting timing info
[0m16:55:27.070378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '885b9272-884c-4116-9d1b-0b98b310a09e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2B27B50>]}
[0m16:55:27.071378 [info ] [Thread-1  ]: 21 of 21 OK created view model data_vault.v_comp_customer_orders_as_is ......... [[32mOK[0m in 1.34s]
[0m16:55:27.073376 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m16:55:27.077376 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m16:55:27.082374 [info ] [MainThread]: 
[0m16:55:27.084376 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 13.96 seconds (13.96s).
[0m16:55:27.085376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:27.086376 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m16:55:27.086376 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m16:55:27.087376 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is' was properly closed.
[0m16:55:27.087376 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_orders_as_is' was properly closed.
[0m16:55:27.091376 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_UK_order' was properly closed.
[0m16:55:27.092376 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_order' was properly closed.
[0m16:55:27.094377 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_UK_customer' was properly closed.
[0m16:55:27.094377 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.link_customer_order' was properly closed.
[0m16:55:27.095377 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customers_as_is' was properly closed.
[0m16:55:27.095377 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_history' was properly closed.
[0m16:55:27.175088 [info ] [MainThread]: 
[0m16:55:27.176090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:27.177089 [info ] [MainThread]: 
[0m16:55:27.178089 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m16:55:27.179088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255AF398100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2A06580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255B2C27970>]}
[0m16:55:27.180215 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 17:11:27.289461 | 04b31686-d11c-4893-8089-a9e7ec34ef3d ==============================
[0m17:11:27.289461 [info ] [MainThread]: Running with dbt=1.2.2
[0m17:11:27.291457 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:11:27.291457 [debug] [MainThread]: Tracking: tracking
[0m17:11:27.293456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4A7ADA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4A7AD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4A7ADD90>]}
[0m17:11:27.701926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:27.701926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:27.710926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4AAA00D0>]}
[0m17:11:27.780088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4A6E6D00>]}
[0m17:11:27.780088 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 3 seed files, 4 sources, 0 exposures, 0 metrics
[0m17:11:27.781166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4A6E6A90>]}
[0m17:11:27.783224 [info ] [MainThread]: 
[0m17:11:27.784221 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:11:27.787220 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m17:11:27.787220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:28.448491 [debug] [ThreadPool]: Acquiring new bigquery connection "create_steadfast-task-363413_data_vault"
[0m17:11:28.449490 [debug] [ThreadPool]: Acquiring new bigquery connection "create_steadfast-task-363413_data_vault"
[0m17:11:28.449490 [debug] [ThreadPool]: BigQuery adapter: Creating schema "steadfast-task-363413.data_vault".
[0m17:11:28.450496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:29.218274 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m17:11:29.219274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:29.662216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4A6A2EE0>]}
[0m17:11:29.664216 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:11:29.665212 [info ] [MainThread]: 
[0m17:11:29.692182 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:11:29.693226 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:11:29.694224 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:11:29.694224 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:11:29.695223 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m17:11:29.696223 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_UK_order ............................. [RUN]
[0m17:11:29.696223 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m17:11:29.697280 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m17:11:29.699313 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m17:11:29.701055 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m17:11:29.702053 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:11:29.702053 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:11:29.703109 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m17:11:29.703109 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:11:29.704149 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:11:29.705149 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m17:11:29.706150 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:11:29.717473 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m17:11:29.727623 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m17:11:29.728628 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:11:29.728628 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:11:29.729739 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:11:29.738906 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m17:11:29.744057 [debug] [Thread-1  ]: finished collecting timing info
[0m17:11:29.744057 [debug] [Thread-2  ]: finished collecting timing info
[0m17:11:29.745060 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:11:29.746057 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:11:29.766558 [debug] [Thread-3  ]: finished collecting timing info
[0m17:11:29.809375 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m17:11:29.815529 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m17:11:29.823054 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m17:11:29.823054 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:11:29.827111 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m17:11:29.828111 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:11:29.828111 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:11:29.829102 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_UK_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m17:11:29.829102 [debug] [Thread-4  ]: finished collecting timing info
[0m17:11:29.829102 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m17:11:29.830102 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:11:29.831103 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:11:29.833152 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m17:11:29.838444 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m17:11:29.842483 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:11:29.842483 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m17:11:31.095938 [debug] [Thread-3  ]: finished collecting timing info
[0m17:11:31.097940 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4AA692B0>]}
[0m17:11:31.098938 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.40s]
[0m17:11:31.104066 [debug] [Thread-2  ]: finished collecting timing info
[0m17:11:31.106236 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4AA69370>]}
[0m17:11:31.107235 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_UK_order ........................ [[32mOK[0m in 1.41s]
[0m17:11:31.108936 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:11:31.111070 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:11:31.111070 [info ] [Thread-6  ]: 5 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m17:11:31.114065 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:11:31.116068 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m17:11:31.116068 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:11:31.117219 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:11:31.117219 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:11:31.125219 [debug] [Thread-1  ]: finished collecting timing info
[0m17:11:31.126214 [info ] [Thread-8  ]: 6 of 21 START view model data_vault.v_stg_UK_order ............................. [RUN]
[0m17:11:31.208906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4AAE8CA0>]}
[0m17:11:31.211900 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m17:11:31.216003 [debug] [Thread-4  ]: finished collecting timing info
[0m17:11:31.217004 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.51s]
[0m17:11:31.218004 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m17:11:31.219006 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4AA69070>]}
[0m17:11:31.224127 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:11:31.225129 [info ] [Thread-4  ]: 4 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.51s]
[0m17:11:31.226253 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:11:31.227261 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:11:31.246670 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m17:11:31.247658 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:11:31.248819 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:11:31.252830 [info ] [Thread-3  ]: 7 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m17:11:31.253986 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:11:31.256982 [info ] [Thread-2  ]: 8 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m17:11:31.259985 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m17:11:31.260984 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:11:31.261984 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m17:11:31.261984 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:11:31.262997 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:11:31.283427 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:11:31.283427 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:11:31.298827 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:11:32.559644 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m17:11:32.564639 [debug] [Thread-6  ]: finished collecting timing info
[0m17:11:32.564639 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:11:32.571899 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m17:11:32.582097 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_stg_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_US_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    CUSTOMER_NUMBER AS `US_CUSTOMER_KEY`,
    '101' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`US_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:11:32.690918 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m17:11:32.701594 [debug] [Thread-2  ]: finished collecting timing info
[0m17:11:32.702592 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:11:32.712910 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m17:11:32.724721 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
),

derived_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '3' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`DESCRIPTION` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`NAME` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:11:32.827138 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m17:11:32.841615 [debug] [Thread-8  ]: finished collecting timing info
[0m17:11:32.844598 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:11:32.856839 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m17:11:32.872599 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_stg_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_order`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
),

derived_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    ORDER_NUMBER AS `ORDER_KEY`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    '2' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), '')))) AS STRING) AS `ORDER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_ORDER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_PRICE` AS STRING))), ''), '^^')
    )))) AS `ORDER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `ORDER_HK`,
    `CUSTOMER_HK`,
    `CUSTOMER_ORDER_HK`,
    `ORDER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:11:32.917360 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m17:11:32.919357 [debug] [Thread-3  ]: finished collecting timing info
[0m17:11:32.919357 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:11:32.926545 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m17:11:32.928636 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_stg_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '1' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`TITLE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`WEALTH_BRACKET` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:11:33.665845 [debug] [Thread-6  ]: finished collecting timing info
[0m17:11:33.666845 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4AA69580>]}
[0m17:11:33.667845 [info ] [Thread-6  ]: 5 of 21 OK created view model data_vault.v_stg_US_customer ..................... [[32mOK[0m in 2.55s]
[0m17:11:33.669846 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:11:33.670846 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:11:33.671847 [info ] [Thread-1  ]: 9 of 21 START incremental model data_vault.sat_US_customer ..................... [RUN]
[0m17:11:33.673852 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_US_customer"
[0m17:11:33.674850 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:11:33.674850 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.sat_US_customer
[0m17:11:33.826336 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m17:11:33.829328 [debug] [Thread-1  ]: finished collecting timing info
[0m17:11:33.829328 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:11:33.883942 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m17:11:33.887040 [debug] [Thread-2  ]: finished collecting timing info
[0m17:11:33.888042 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4AB87580>]}
[0m17:11:33.889043 [info ] [Thread-2  ]: 8 of 21 OK created view model data_vault.v_stg_customer_wealth_bracket ......... [[32mOK[0m in 2.63s]
[0m17:11:33.889043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:11:33.890043 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.sat_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_US_customer"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`sat_US_customer`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
  );
  
[0m17:11:33.893044 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:11:33.895043 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:11:33.895043 [info ] [Thread-4  ]: 10 of 21 START incremental model data_vault.hub_customer_wealth_bracket ........ [RUN]
[0m17:11:33.896112 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:11:33.897109 [info ] [Thread-5  ]: 11 of 21 START incremental model data_vault.sat_customer_wealth_bracket ........ [RUN]
[0m17:11:33.898109 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m17:11:33.899108 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:11:33.899108 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:11:33.899108 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m17:11:33.917373 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:11:33.922454 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:11:33.964427 [info ] [Thread-4  ]: 17:11:33 + Loading steadfast-task-363413.data_vault.hub_customer_wealth_bracket from 1 source(s)
[0m17:11:34.029911 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m17:11:34.053467 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m17:11:34.058594 [debug] [Thread-8  ]: finished collecting timing info
[0m17:11:34.060677 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4AB7B6A0>]}
[0m17:11:34.061712 [debug] [Thread-4  ]: finished collecting timing info
[0m17:11:34.061712 [info ] [Thread-8  ]: 6 of 21 OK created view model data_vault.v_stg_UK_order ........................ [[32mOK[0m in 2.84s]
[0m17:11:34.062723 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:11:34.062723 [debug] [Thread-5  ]: finished collecting timing info
[0m17:11:34.073029 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m17:11:34.074032 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:11:34.081632 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m17:11:34.082618 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:11:34.084020 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:11:34.084901 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.hub_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`ID`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`ID`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:11:34.084901 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m17:11:34.086905 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m17:11:34.086905 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:11:34.087920 [info ] [Thread-7  ]: 12 of 21 START incremental model data_vault.hub_order .......................... [RUN]
[0m17:11:34.090093 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:11:34.092088 [info ] [Thread-2  ]: 13 of 21 START incremental model data_vault.link_customer_order ................ [RUN]
[0m17:11:34.093090 [info ] [Thread-6  ]: 14 of 21 START incremental model data_vault.sat_UK_order ....................... [RUN]
[0m17:11:34.095351 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.sat_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`NAME`, a.`DESCRIPTION`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS a
    WHERE a.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_WEALTH_BRACKET_HK`, stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, stage.`NAME`, stage.`DESCRIPTION`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
  );
  
[0m17:11:34.097335 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_order"
[0m17:11:34.098345 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_order"
[0m17:11:34.100493 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_order"
[0m17:11:34.101479 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.hub_order
[0m17:11:34.102474 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_order
[0m17:11:34.104567 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:11:34.104567 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.hub_order
[0m17:11:34.104567 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.link_customer_order
[0m17:11:34.105617 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_order
[0m17:11:34.151750 [info ] [Thread-7  ]: 17:11:34 + Loading steadfast-task-363413.data_vault.hub_order from 1 source(s)
[0m17:11:34.298887 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m17:11:34.321485 [debug] [Thread-7  ]: finished collecting timing info
[0m17:11:34.323580 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.hub_order
[0m17:11:34.338985 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m17:11:34.378790 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_order"
[0m17:11:34.380769 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m17:11:34.380769 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_order"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`hub_order`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`ORDER_HK`, rr.`ORDER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS rr
    WHERE rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`ORDER_HK`, a.`ORDER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:11:34.398095 [debug] [Thread-6  ]: finished collecting timing info
[0m17:11:34.401254 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:11:34.438397 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_order"
[0m17:11:34.450723 [info ] [Thread-2  ]: 17:11:34 + Loading steadfast-task-363413.data_vault.link_customer_order from 1 source(s)
[0m17:11:34.451854 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m17:11:34.460589 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.sat_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_order"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`sat_UK_order`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`ORDER_ID`, a.`ORDER_PRICE`, a.`CUSTOMER_ID`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS a
    WHERE a.`ORDER_HK` IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.`ORDER_HK`, stage.`ORDER_HASHDIFF`, stage.`ORDER_ID`, stage.`ORDER_PRICE`, stage.`CUSTOMER_ID`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
  );
  
[0m17:11:34.518490 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m17:11:34.525817 [debug] [Thread-3  ]: finished collecting timing info
[0m17:11:34.527899 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A47408CD0>]}
[0m17:11:34.529899 [info ] [Thread-3  ]: 7 of 21 OK created view model data_vault.v_stg_UK_customer ..................... [[32mOK[0m in 3.27s]
[0m17:11:34.530896 [debug] [Thread-2  ]: finished collecting timing info
[0m17:11:34.531898 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_order
[0m17:11:34.542526 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m17:11:34.543543 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:11:34.546522 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m17:11:34.546522 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:11:34.547526 [info ] [Thread-8  ]: 15 of 21 START incremental model data_vault.hub_customer ....................... [RUN]
[0m17:11:34.548649 [info ] [Thread-3  ]: 16 of 21 START incremental model data_vault.link_customer_wealth_bracket_customer  [RUN]
[0m17:11:34.551649 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:11:34.553645 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer"
[0m17:11:34.554787 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_order"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`link_customer_order`
  
  
  OPTIONS()
  as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_ORDER_HK`, rr.`CUSTOMER_HK`, rr.`ORDER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS rr
    WHERE rr.`CUSTOMER_ORDER_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    AND rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_ORDER_HK`, a.`CUSTOMER_HK`, a.`ORDER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:11:34.554787 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer
[0m17:11:34.555784 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m17:11:34.557798 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.hub_customer
[0m17:11:34.558797 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:11:34.576470 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:11:34.604761 [info ] [Thread-8  ]: 17:11:34 + Loading steadfast-task-363413.data_vault.hub_customer from 2 source(s)
[0m17:11:34.623199 [info ] [Thread-3  ]: 17:11:34 + Loading steadfast-task-363413.data_vault.link_customer_wealth_bracket_customer from 1 source(s)
[0m17:11:34.635337 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m17:11:34.648053 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m17:11:34.651166 [debug] [Thread-3  ]: finished collecting timing info
[0m17:11:34.651166 [debug] [Thread-8  ]: finished collecting timing info
[0m17:11:34.652167 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:11:34.652167 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer
[0m17:11:34.664291 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m17:11:34.672573 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m17:11:34.675570 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:11:34.676574 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m17:11:34.676574 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer`
  
  
  OPTIONS()
  as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`CUSTOMER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NOT NULL
    AND rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:11:34.677755 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`hub_customer`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.`CUSTOMER_HK`
               ORDER BY ru.`LOAD_DATE`, ru.`RECORD_SOURCE` ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:11:37.458989 [debug] [Thread-1  ]: finished collecting timing info
[0m17:11:37.460001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BD6C490>]}
[0m17:11:37.460001 [info ] [Thread-1  ]: 9 of 21 OK created incremental model data_vault.sat_US_customer ................ [[32mCREATE TABLE (1.0 rows, 63.0 Bytes processed)[0m in 3.79s]
[0m17:11:37.460987 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:11:37.460987 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:11:37.460987 [info ] [Thread-1  ]: 17 of 21 START incremental model data_vault.sat_UK_customer .................... [RUN]
[0m17:11:37.461986 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m17:11:37.461986 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:11:37.462988 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:11:37.496326 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m17:11:37.497325 [debug] [Thread-1  ]: finished collecting timing info
[0m17:11:37.497325 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:11:37.501383 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m17:11:37.502384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:11:37.503385 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.sat_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_customer"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`sat_UK_customer`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`TITLE`, a.`WEALTH_BRACKET`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`TITLE`, stage.`WEALTH_BRACKET`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
  );
  
[0m17:11:37.689353 [debug] [Thread-5  ]: finished collecting timing info
[0m17:11:37.690404 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BD85CA0>]}
[0m17:11:37.692454 [info ] [Thread-5  ]: 11 of 21 OK created incremental model data_vault.sat_customer_wealth_bracket ... [[32mCREATE TABLE (5.0 rows, 540.0 Bytes processed)[0m in 3.79s]
[0m17:11:37.694764 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:11:37.899307 [debug] [Thread-4  ]: finished collecting timing info
[0m17:11:37.900309 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BD853A0>]}
[0m17:11:37.900309 [info ] [Thread-4  ]: 10 of 21 OK created incremental model data_vault.hub_customer_wealth_bracket ... [[32mCREATE TABLE (5.0 rows, 540.0 Bytes processed)[0m in 4.00s]
[0m17:11:37.902287 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:11:38.087123 [debug] [Thread-6  ]: finished collecting timing info
[0m17:11:38.088101 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BDF2730>]}
[0m17:11:38.089101 [info ] [Thread-6  ]: 14 of 21 OK created incremental model data_vault.sat_UK_order .................. [[32mCREATE TABLE (0.0 rows, 294.0 Bytes processed)[0m in 3.99s]
[0m17:11:38.091121 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:11:38.108102 [debug] [Thread-2  ]: finished collecting timing info
[0m17:11:38.109107 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BC6C4F0>]}
[0m17:11:38.110107 [info ] [Thread-2  ]: 13 of 21 OK created incremental model data_vault.link_customer_order ........... [[32mCREATE TABLE (0.0 rows, 294.0 Bytes processed)[0m in 4.01s]
[0m17:11:38.112102 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m17:11:38.275330 [debug] [Thread-3  ]: finished collecting timing info
[0m17:11:38.276329 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4AB2AB50>]}
[0m17:11:38.277328 [info ] [Thread-3  ]: 16 of 21 OK created incremental model data_vault.link_customer_wealth_bracket_customer  [[32mCREATE TABLE (2.0 rows, 953.0 Bytes processed)[0m in 3.72s]
[0m17:11:38.283325 [debug] [Thread-7  ]: finished collecting timing info
[0m17:11:38.286326 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BDC6220>]}
[0m17:11:38.291327 [info ] [Thread-7  ]: 12 of 21 OK created incremental model data_vault.hub_order ..................... [[32mCREATE TABLE (0.0 rows, 294.0 Bytes processed)[0m in 4.19s]
[0m17:11:38.301327 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:11:38.302326 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m17:11:38.304327 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:11:38.304327 [info ] [Thread-5  ]: 18 of 21 START view model data_vault.v_comp_orders_as_is ....................... [RUN]
[0m17:11:38.306473 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m17:11:38.307492 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:11:38.307492 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:11:38.320658 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m17:11:38.323655 [debug] [Thread-5  ]: finished collecting timing info
[0m17:11:38.323655 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:11:38.333682 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m17:11:38.336682 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m17:11:38.337662 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.v_comp_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`
  OPTIONS()
  as with
    h as
        (select order_hk, order_number, record_source from `steadfast-task-363413`.`data_vault`.`hub_order`),
    s as
        (select order_hk, order_id, order_price, lastmodifieddate, createddate, effective_from, load_date,
         crud_flag, row_number() over(partition by order_hk order by lastmodifieddate desc) as rn
         from `steadfast-task-363413`.`data_vault`.`sat_UK_order`),
    co as
        (select order_hk, customer_hk from `steadfast-task-363413`.`data_vault`.`link_customer_order` ),
    joined as
        (select h.order_hk, h.order_number,
            co.customer_hk,
            s.order_id, s.order_price, s.lastmodifieddate, s.createddate, h.record_source, s.effective_from,
            s.load_date, s.crud_flag, s.rn
         from h, s, co
        where s.order_hk = h.order_hk
        and co.order_hk = h.order_hk)
select order_hk, customer_hk, order_id, order_number, order_price, lastmodifieddate, createddate,
effective_from, load_date
from joined
where rn = 1 and crud_flag <> 'D';


[0m17:11:38.510219 [debug] [Thread-8  ]: finished collecting timing info
[0m17:11:38.511221 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4A7DCB20>]}
[0m17:11:38.512220 [info ] [Thread-8  ]: 15 of 21 OK created incremental model data_vault.hub_customer .................. [[32mCREATE TABLE (7.0 rows, 1016.0 Bytes processed)[0m in 3.96s]
[0m17:11:38.513352 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m17:11:39.552148 [debug] [Thread-5  ]: finished collecting timing info
[0m17:11:39.554145 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BCFFEE0>]}
[0m17:11:39.555146 [info ] [Thread-5  ]: 18 of 21 OK created view model data_vault.v_comp_orders_as_is .................. [[32mOK[0m in 1.25s]
[0m17:11:39.558145 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:11:41.094762 [debug] [Thread-1  ]: finished collecting timing info
[0m17:11:41.095762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A49D0E5B0>]}
[0m17:11:41.096762 [info ] [Thread-1  ]: 17 of 21 OK created incremental model data_vault.sat_UK_customer ............... [[32mCREATE TABLE (18.0 rows, 953.0 Bytes processed)[0m in 3.63s]
[0m17:11:41.098762 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:11:41.102763 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:11:41.108763 [info ] [Thread-6  ]: 19 of 21 START view model data_vault.v_comp_customer_history ................... [RUN]
[0m17:11:41.109764 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:11:41.110767 [info ] [Thread-2  ]: 20 of 21 START view model data_vault.v_comp_customers_as_is .................... [RUN]
[0m17:11:41.112765 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m17:11:41.113766 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:11:41.114765 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m17:11:41.115765 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:11:41.116765 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:11:41.128176 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m17:11:41.129174 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:11:41.136331 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m17:11:41.138318 [debug] [Thread-6  ]: finished collecting timing info
[0m17:11:41.139439 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:11:41.139439 [debug] [Thread-2  ]: finished collecting timing info
[0m17:11:41.148618 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m17:11:41.149891 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:11:41.158064 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m17:11:41.160052 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m17:11:41.161051 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_comp_customer_history: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_history"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_history`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.customer_id, s_uk.first_name,
        s_uk.last_name, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
        s_uk.effective_from, s_uk.crud_flag, s_uk.load_date
        from h, s_uk
        where s_uk.customer_hk = h.customer_hk
        union all
        select h.customer_hk, h.customer_number, s_us.customer_id, s_us.first_name,
        s_us.last_name, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
        s_us.effective_from, s_us.crud_flag, s_us.load_date
        from h, s_us
        where s_us.customer_hk = h.customer_hk)
select * from joined;


[0m17:11:41.162167 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:11:41.163163 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_comp_customers_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customers_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number, record_source
        from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.crud_flag, s_uk.customer_id,
                s_uk.title, s_uk.first_name, s_uk.last_name, s_uk.wealth_bracket, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
                s_uk.effective_from, s_uk.load_date, h.record_source,
                row_number() over(partition by s_uk.customer_hk order by s_uk.applieddate desc) as rn
         from h, s_uk
         where s_uk.customer_hk = h.customer_hk
         union all
         select h.customer_hk, h.customer_number, s_us.crud_flag, s_us.customer_id,
                '' as title, s_us.first_name, s_us.last_name, null as wealth_bracket, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
                s_us.effective_from, s_us.load_date, h.record_source,
                row_number() over(partition by s_us.customer_hk order by s_us.applieddate desc) as rn
         from h, s_us
         )
select customer_hk, customer_id, customer_number, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate, applieddate, effective_from, load_date, record_source from joined
where rn = 1 and crud_flag <> 'D';


[0m17:11:42.168404 [debug] [Thread-2  ]: finished collecting timing info
[0m17:11:42.169399 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BEEE4C0>]}
[0m17:11:42.171400 [info ] [Thread-2  ]: 20 of 21 OK created view model data_vault.v_comp_customers_as_is ............... [[32mOK[0m in 1.05s]
[0m17:11:42.173399 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:11:42.174474 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:11:42.175489 [info ] [Thread-7  ]: 21 of 21 START view model data_vault.v_comp_customer_orders_as_is .............. [RUN]
[0m17:11:42.177469 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m17:11:42.177469 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:11:42.178468 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:11:42.188595 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m17:11:42.193127 [debug] [Thread-7  ]: finished collecting timing info
[0m17:11:42.194128 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:11:42.207443 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m17:11:42.210653 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m17:11:42.211648 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_orders_as_is`
  OPTIONS()
  as with
    c as
        (select customer_hk, customer_number, first_name, last_name
         from `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`),
    o as
        (select customer_hk, order_number, order_price, createddate, lastmodifieddate
         from `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`),
    joined as
        (select c.customer_number, c.first_name, c.last_name, o.order_number, o.order_price,
         o.createddate, o.lastmodifieddate
         from c, o
         where o.customer_hk = c.customer_hk)
select * from joined;


[0m17:11:42.488505 [debug] [Thread-6  ]: finished collecting timing info
[0m17:11:42.490503 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BCC5040>]}
[0m17:11:42.491505 [info ] [Thread-6  ]: 19 of 21 OK created view model data_vault.v_comp_customer_history .............. [[32mOK[0m in 1.38s]
[0m17:11:42.493503 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:11:43.783212 [debug] [Thread-7  ]: finished collecting timing info
[0m17:11:43.784212 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04b31686-d11c-4893-8089-a9e7ec34ef3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BEA1520>]}
[0m17:11:43.785212 [info ] [Thread-7  ]: 21 of 21 OK created view model data_vault.v_comp_customer_orders_as_is ......... [[32mOK[0m in 1.61s]
[0m17:11:43.787209 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:11:43.792213 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:11:43.795349 [info ] [MainThread]: 
[0m17:11:43.796221 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 16.01 seconds (16.01s).
[0m17:11:43.797291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:43.797291 [debug] [MainThread]: Connection 'create_steadfast-task-363413_data_vault' was properly closed.
[0m17:11:43.798336 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m17:11:43.798336 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_UK_customer' was properly closed.
[0m17:11:43.798336 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customers_as_is' was properly closed.
[0m17:11:43.799336 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer' was properly closed.
[0m17:11:43.799336 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_customer_wealth_bracket' was properly closed.
[0m17:11:43.799336 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_history' was properly closed.
[0m17:11:43.799336 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_customer' was properly closed.
[0m17:11:43.800335 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_orders_as_is' was properly closed.
[0m17:11:43.800335 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is' was properly closed.
[0m17:11:43.845458 [info ] [MainThread]: 
[0m17:11:43.846460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:43.848456 [info ] [MainThread]: 
[0m17:11:43.849550 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m17:11:43.851593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4BF111F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4A27E610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4A793250>]}
[0m17:11:43.851593 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 17:27:57.777017 | 1742fd10-0723-4a50-9ce5-b36c1782fb70 ==============================
[0m17:27:57.777017 [info ] [MainThread]: Running with dbt=1.2.2
[0m17:27:57.785812 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:27:57.785812 [debug] [MainThread]: Tracking: tracking
[0m17:27:57.785812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE749A670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE749AC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE749AAC0>]}
[0m17:27:58.303734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:27:58.303734 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:27:58.314921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE777FFD0>]}
[0m17:27:58.470722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE73C6EB0>]}
[0m17:27:58.471726 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 3 seed files, 4 sources, 0 exposures, 0 metrics
[0m17:27:58.472728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE73C6C40>]}
[0m17:27:58.476833 [info ] [MainThread]: 
[0m17:27:58.478961 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:27:58.484124 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m17:27:58.485145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:59.078699 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m17:27:59.079702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:59.390227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE73980D0>]}
[0m17:27:59.391344 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:27:59.393388 [info ] [MainThread]: 
[0m17:27:59.411944 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:27:59.411944 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:27:59.412945 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:27:59.416115 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m17:27:59.412945 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m17:27:59.414068 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:27:59.415117 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_UK_order ............................. [RUN]
[0m17:27:59.418126 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m17:27:59.421116 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m17:27:59.422113 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:27:59.422113 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m17:27:59.423115 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:27:59.424114 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:27:59.425201 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m17:27:59.431376 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:27:59.435383 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m17:27:59.436382 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m17:27:59.437378 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:27:59.445511 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m17:27:59.446510 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:27:59.447657 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:27:59.448673 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:27:59.458941 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m17:27:59.458941 [debug] [Thread-3  ]: finished collecting timing info
[0m17:27:59.470247 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m17:27:59.471247 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:27:59.472245 [debug] [Thread-1  ]: finished collecting timing info
[0m17:27:59.541914 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m17:27:59.542914 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:27:59.542914 [debug] [Thread-2  ]: finished collecting timing info
[0m17:27:59.544069 [debug] [Thread-4  ]: finished collecting timing info
[0m17:27:59.552300 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m17:27:59.552300 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:27:59.553298 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:27:59.553298 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:27:59.560462 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m17:27:59.568845 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m17:27:59.569844 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m17:27:59.571847 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:27:59.573005 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m17:27:59.575007 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:27:59.577004 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:27:59.579137 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m17:27:59.580136 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_UK_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m17:28:00.834256 [debug] [Thread-1  ]: finished collecting timing info
[0m17:28:00.841414 [debug] [Thread-3  ]: finished collecting timing info
[0m17:28:00.842550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE747C8E0>]}
[0m17:28:00.847546 [debug] [Thread-2  ]: finished collecting timing info
[0m17:28:00.848679 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE77A20A0>]}
[0m17:28:00.849675 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.42s]
[0m17:28:00.850677 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE747C520>]}
[0m17:28:00.854836 [debug] [Thread-4  ]: finished collecting timing info
[0m17:28:00.855832 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.43s]
[0m17:28:00.856831 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_UK_order ........................ [[32mOK[0m in 1.43s]
[0m17:28:00.858834 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE40E7EB0>]}
[0m17:28:00.859833 [info ] [Thread-4  ]: 4 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.42s]
[0m17:28:00.860960 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:28:00.862957 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:28:00.862957 [info ] [Thread-6  ]: 5 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m17:28:00.863958 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:28:00.864959 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:28:00.865958 [info ] [Thread-8  ]: 6 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m17:28:00.868099 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:28:00.870100 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:28:00.871116 [info ] [Thread-1  ]: 7 of 21 START view model data_vault.v_stg_UK_order ............................. [RUN]
[0m17:28:00.872101 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:28:00.873242 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:28:00.874241 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m17:28:00.874241 [info ] [Thread-3  ]: 8 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m17:28:00.876244 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:28:00.877242 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m17:28:00.878241 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:28:00.879403 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m17:28:00.880400 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:28:00.902571 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m17:28:00.903573 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:28:00.932751 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:28:00.974998 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m17:28:00.975999 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:28:00.975999 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:28:00.994518 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m17:28:00.998546 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:28:01.020107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:28:01.046968 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:28:02.192205 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m17:28:02.195266 [debug] [Thread-3  ]: finished collecting timing info
[0m17:28:02.195266 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:28:02.202343 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m17:28:02.206342 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
),

derived_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '3' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`DESCRIPTION` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`NAME` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:28:02.312331 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m17:28:02.317320 [debug] [Thread-8  ]: finished collecting timing info
[0m17:28:02.317320 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:28:02.323466 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m17:28:02.330917 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_stg_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_US_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    CUSTOMER_NUMBER AS `US_CUSTOMER_KEY`,
    '101' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`US_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:28:02.419165 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m17:28:02.434433 [debug] [Thread-1  ]: finished collecting timing info
[0m17:28:02.436592 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:28:02.445752 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m17:28:02.459135 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_stg_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_order`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
),

derived_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    ORDER_NUMBER AS `ORDER_KEY`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    '2' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), '')))) AS STRING) AS `ORDER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_ORDER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_PRICE` AS STRING))), ''), '^^')
    )))) AS `ORDER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `ORDER_HK`,
    `CUSTOMER_HK`,
    `CUSTOMER_ORDER_HK`,
    `ORDER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:28:02.475610 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m17:28:02.477609 [debug] [Thread-6  ]: finished collecting timing info
[0m17:28:02.477609 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:28:02.484773 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m17:28:02.486940 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_stg_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '1' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`TITLE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`WEALTH_BRACKET` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:28:03.242259 [debug] [Thread-8  ]: finished collecting timing info
[0m17:28:03.243260 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE7847160>]}
[0m17:28:03.244260 [info ] [Thread-8  ]: 6 of 21 OK created view model data_vault.v_stg_US_customer ..................... [[32mOK[0m in 2.37s]
[0m17:28:03.246257 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:28:03.247258 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:28:03.248256 [info ] [Thread-2  ]: 9 of 21 START incremental model data_vault.sat_US_customer ..................... [RUN]
[0m17:28:03.251258 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_US_customer"
[0m17:28:03.252257 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:28:03.252257 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.sat_US_customer
[0m17:28:03.341262 [debug] [Thread-1  ]: finished collecting timing info
[0m17:28:03.344262 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE7847E20>]}
[0m17:28:03.345263 [info ] [Thread-1  ]: 7 of 21 OK created view model data_vault.v_stg_UK_order ........................ [[32mOK[0m in 2.46s]
[0m17:28:03.377266 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:28:03.499441 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m17:28:03.500442 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m17:28:03.519103 [info ] [Thread-4  ]: 10 of 21 START incremental model data_vault.hub_order .......................... [RUN]
[0m17:28:03.525212 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m17:28:03.526223 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:28:03.530207 [debug] [Thread-3  ]: finished collecting timing info
[0m17:28:03.531371 [info ] [Thread-5  ]: 11 of 21 START incremental model data_vault.link_customer_order ................ [RUN]
[0m17:28:03.536370 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_order"
[0m17:28:03.537431 [info ] [Thread-8  ]: 12 of 21 START incremental model data_vault.sat_UK_order ....................... [RUN]
[0m17:28:03.539482 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE78478B0>]}
[0m17:28:03.539482 [debug] [Thread-2  ]: finished collecting timing info
[0m17:28:03.540474 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.hub_order
[0m17:28:03.541474 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_order"
[0m17:28:03.543620 [info ] [Thread-3  ]: 8 of 21 OK created view model data_vault.v_stg_customer_wealth_bracket ......... [[32mOK[0m in 2.64s]
[0m17:28:03.543620 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:28:03.544607 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_order"
[0m17:28:03.545611 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.hub_order
[0m17:28:03.545611 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_order
[0m17:28:03.603254 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:28:03.634187 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:28:03.640589 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m17:28:03.660719 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.link_customer_order
[0m17:28:03.667864 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_order
[0m17:28:03.694593 [info ] [Thread-4  ]: 17:28:03 + Loading steadfast-task-363413.data_vault.hub_order from 1 source(s)
[0m17:28:03.695388 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:28:03.696395 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:28:03.846769 [info ] [Thread-1  ]: 13 of 21 START incremental model data_vault.hub_customer_wealth_bracket ........ [RUN]
[0m17:28:03.847467 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:28:03.859208 [debug] [Thread-6  ]: finished collecting timing info
[0m17:28:03.860217 [info ] [Thread-7  ]: 14 of 21 START incremental model data_vault.sat_customer_wealth_bracket ........ [RUN]
[0m17:28:03.881992 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m17:28:03.881992 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.sat_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_US_customer"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`sat_US_customer`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
  );
  
[0m17:28:03.883081 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m17:28:03.884079 [info ] [Thread-5  ]: 17:28:03 + Loading steadfast-task-363413.data_vault.link_customer_order from 1 source(s)
[0m17:28:03.885080 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8A35FD0>]}
[0m17:28:03.887078 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m17:28:03.888079 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:28:03.890135 [debug] [Thread-4  ]: finished collecting timing info
[0m17:28:03.916645 [info ] [Thread-6  ]: 5 of 21 OK created view model data_vault.v_stg_UK_customer ..................... [[32mOK[0m in 3.01s]
[0m17:28:03.936812 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:28:03.940895 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m17:28:03.941895 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:28:03.943966 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.hub_order
[0m17:28:03.946962 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:28:03.962130 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:28:03.968228 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m17:28:03.970346 [debug] [Thread-5  ]: finished collecting timing info
[0m17:28:03.981424 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m17:28:03.983477 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:28:03.983477 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_order
[0m17:28:03.985533 [info ] [Thread-3  ]: 15 of 21 START incremental model data_vault.hub_customer ....................... [RUN]
[0m17:28:03.987525 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:28:03.987525 [info ] [Thread-6  ]: 16 of 21 START incremental model data_vault.link_customer_wealth_bracket_customer  [RUN]
[0m17:28:04.001787 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_order"
[0m17:28:04.006612 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m17:28:04.010681 [info ] [Thread-1  ]: 17:28:04 + Loading steadfast-task-363413.data_vault.hub_customer_wealth_bracket from 1 source(s)
[0m17:28:04.013459 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer"
[0m17:28:04.014462 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_order"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`hub_order`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`ORDER_HK`, rr.`ORDER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS rr
    WHERE rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`ORDER_HK`, a.`ORDER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:28:04.020623 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m17:28:04.033778 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m17:28:04.033778 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer
[0m17:28:04.035773 [debug] [Thread-8  ]: finished collecting timing info
[0m17:28:04.039851 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m17:28:04.041851 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:28:04.041851 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:28:04.042856 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.hub_customer
[0m17:28:04.043852 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:28:04.044861 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_order"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`link_customer_order`
  
  
  OPTIONS()
  as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_ORDER_HK`, rr.`CUSTOMER_HK`, rr.`ORDER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS rr
    WHERE rr.`CUSTOMER_ORDER_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    AND rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_ORDER_HK`, a.`CUSTOMER_HK`, a.`ORDER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:28:04.044861 [debug] [Thread-7  ]: finished collecting timing info
[0m17:28:04.045852 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:28:04.054996 [debug] [Thread-1  ]: finished collecting timing info
[0m17:28:04.062087 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_order"
[0m17:28:04.065080 [info ] [Thread-3  ]: 17:28:04 + Loading steadfast-task-363413.data_vault.hub_customer from 2 source(s)
[0m17:28:04.067159 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:28:04.077355 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:28:04.083351 [info ] [Thread-6  ]: 17:28:04 + Loading steadfast-task-363413.data_vault.link_customer_wealth_bracket_customer from 1 source(s)
[0m17:28:04.089432 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m17:28:04.090430 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m17:28:04.095521 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m17:28:04.104615 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m17:28:04.104615 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.sat_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_order"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`sat_UK_order`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`ORDER_ID`, a.`ORDER_PRICE`, a.`CUSTOMER_ID`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS a
    WHERE a.`ORDER_HK` IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.`ORDER_HK`, stage.`ORDER_HASHDIFF`, stage.`ORDER_ID`, stage.`ORDER_PRICE`, stage.`CUSTOMER_ID`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
  );
  
[0m17:28:04.109681 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m17:28:04.112763 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m17:28:04.114764 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.sat_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`NAME`, a.`DESCRIPTION`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS a
    WHERE a.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_WEALTH_BRACKET_HK`, stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, stage.`NAME`, stage.`DESCRIPTION`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
  );
  
[0m17:28:04.114764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:28:04.114764 [debug] [Thread-3  ]: finished collecting timing info
[0m17:28:04.118754 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.hub_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`ID`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`ID`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:28:04.119754 [debug] [Thread-6  ]: finished collecting timing info
[0m17:28:04.119754 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer
[0m17:28:04.122758 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:28:04.132754 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m17:28:04.138770 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m17:28:04.141756 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:28:04.141756 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m17:28:04.141756 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`hub_customer`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.`CUSTOMER_HK`
               ORDER BY ru.`LOAD_DATE`, ru.`RECORD_SOURCE` ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:28:04.142769 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer`
  
  
  OPTIONS()
  as (
    

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`CUSTOMER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NOT NULL
    AND rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
[0m17:28:07.293888 [debug] [Thread-7  ]: finished collecting timing info
[0m17:28:07.294893 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8AE2C70>]}
[0m17:28:07.294893 [info ] [Thread-7  ]: 14 of 21 OK created incremental model data_vault.sat_customer_wealth_bracket ... [[32mCREATE TABLE (5.0 rows, 540.0 Bytes processed)[0m in 3.41s]
[0m17:28:07.296878 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:28:07.297890 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:28:07.297890 [info ] [Thread-7  ]: 17 of 21 START incremental model data_vault.sat_UK_customer .................... [RUN]
[0m17:28:07.299875 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m17:28:07.299875 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:28:07.299875 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:28:07.311877 [debug] [Thread-3  ]: finished collecting timing info
[0m17:28:07.336876 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE89E4880>]}
[0m17:28:07.347899 [info ] [Thread-3  ]: 15 of 21 OK created incremental model data_vault.hub_customer .................. [[32mCREATE TABLE (2.0 rows, 328.0 Bytes processed)[0m in 3.32s]
[0m17:28:07.354899 [debug] [Thread-4  ]: finished collecting timing info
[0m17:28:07.361900 [debug] [Thread-2  ]: finished collecting timing info
[0m17:28:07.365879 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8A58700>]}
[0m17:28:07.386880 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8A83820>]}
[0m17:28:07.390908 [debug] [Thread-5  ]: finished collecting timing info
[0m17:28:07.394881 [debug] [Thread-1  ]: finished collecting timing info
[0m17:28:07.400893 [debug] [Thread-8  ]: finished collecting timing info
[0m17:28:07.401887 [info ] [Thread-4  ]: 10 of 21 OK created incremental model data_vault.hub_order ..................... [[32mCREATE TABLE (0.0 rows, 63.0 Bytes processed)[0m in 3.83s]
[0m17:28:07.412882 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m17:28:07.413904 [info ] [Thread-2  ]: 9 of 21 OK created incremental model data_vault.sat_US_customer ................ [[32mCREATE TABLE (1.0 rows, 63.0 Bytes processed)[0m in 4.14s]
[0m17:28:07.436887 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8A37A90>]}
[0m17:28:07.459090 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m17:28:07.461069 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8AE2AF0>]}
[0m17:28:07.462252 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8A37B50>]}
[0m17:28:07.464477 [info ] [Thread-5  ]: 11 of 21 OK created incremental model data_vault.link_customer_order ........... [[32mCREATE TABLE (0.0 rows, 63.0 Bytes processed)[0m in 3.90s]
[0m17:28:07.465563 [info ] [Thread-1  ]: 13 of 21 OK created incremental model data_vault.hub_customer_wealth_bracket ... [[32mCREATE TABLE (5.0 rows, 540.0 Bytes processed)[0m in 3.58s]
[0m17:28:07.466590 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m17:28:07.468876 [info ] [Thread-8  ]: 12 of 21 OK created incremental model data_vault.sat_UK_order .................. [[32mCREATE TABLE (0.0 rows, 63.0 Bytes processed)[0m in 3.92s]
[0m17:28:07.471875 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:28:07.471875 [debug] [Thread-7  ]: finished collecting timing info
[0m17:28:07.474056 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:28:07.483060 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m17:28:07.489060 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m17:28:07.491211 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:28:07.493213 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m17:28:07.494206 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.sat_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_customer"} */


  create or replace table `steadfast-task-363413`.`data_vault`.`sat_UK_customer`
  
  
  OPTIONS()
  as (
    -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`TITLE`, a.`WEALTH_BRACKET`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`TITLE`, stage.`WEALTH_BRACKET`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
)

SELECT * FROM records_to_insert
  );
  
[0m17:28:07.495209 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:28:07.500344 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:28:07.501344 [info ] [Thread-3  ]: 18 of 21 START view model data_vault.v_comp_orders_as_is ....................... [RUN]
[0m17:28:07.503543 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m17:28:07.504576 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:28:07.505546 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:28:07.516833 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m17:28:07.519829 [debug] [Thread-3  ]: finished collecting timing info
[0m17:28:07.520916 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:28:07.531401 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m17:28:07.535395 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:28:07.536398 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_comp_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`
  OPTIONS()
  as with
    h as
        (select order_hk, order_number, record_source from `steadfast-task-363413`.`data_vault`.`hub_order`),
    s as
        (select order_hk, order_id, order_price, lastmodifieddate, createddate, effective_from, load_date,
         crud_flag, row_number() over(partition by order_hk order by lastmodifieddate desc) as rn
         from `steadfast-task-363413`.`data_vault`.`sat_UK_order`),
    co as
        (select order_hk, customer_hk from `steadfast-task-363413`.`data_vault`.`link_customer_order` ),
    joined as
        (select h.order_hk, h.order_number,
            co.customer_hk,
            s.order_id, s.order_price, s.lastmodifieddate, s.createddate, h.record_source, s.effective_from,
            s.load_date, s.crud_flag, s.rn
         from h, s, co
        where s.order_hk = h.order_hk
        and co.order_hk = h.order_hk)
select order_hk, customer_hk, order_id, order_number, order_price, lastmodifieddate, createddate,
effective_from, load_date
from joined
where rn = 1 and crud_flag <> 'D';


[0m17:28:07.705682 [debug] [Thread-6  ]: finished collecting timing info
[0m17:28:07.707683 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE89E6310>]}
[0m17:28:07.708679 [info ] [Thread-6  ]: 16 of 21 OK created incremental model data_vault.link_customer_wealth_bracket_customer  [[32mCREATE TABLE (3.0 rows, 265.0 Bytes processed)[0m in 3.69s]
[0m17:28:07.710680 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:28:08.741838 [debug] [Thread-3  ]: finished collecting timing info
[0m17:28:08.742838 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8B7EFD0>]}
[0m17:28:08.743839 [info ] [Thread-3  ]: 18 of 21 OK created view model data_vault.v_comp_orders_as_is .................. [[32mOK[0m in 1.24s]
[0m17:28:08.745840 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:28:10.664297 [debug] [Thread-7  ]: finished collecting timing info
[0m17:28:10.665319 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE78475E0>]}
[0m17:28:10.666296 [info ] [Thread-7  ]: 17 of 21 OK created incremental model data_vault.sat_UK_customer ............... [[32mCREATE TABLE (3.0 rows, 265.0 Bytes processed)[0m in 3.37s]
[0m17:28:10.668298 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:28:10.669319 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:28:10.670318 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:28:10.671296 [info ] [Thread-2  ]: 19 of 21 START view model data_vault.v_comp_customer_history ................... [RUN]
[0m17:28:10.671296 [info ] [Thread-5  ]: 20 of 21 START view model data_vault.v_comp_customers_as_is .................... [RUN]
[0m17:28:10.673296 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m17:28:10.674319 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:28:10.675300 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m17:28:10.676303 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:28:10.676303 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:28:10.689301 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m17:28:10.690301 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:28:10.702298 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m17:28:10.703300 [debug] [Thread-2  ]: finished collecting timing info
[0m17:28:10.704305 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:28:10.715299 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m17:28:10.716308 [debug] [Thread-5  ]: finished collecting timing info
[0m17:28:10.717302 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:28:10.729300 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m17:28:10.730307 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:28:10.731307 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_comp_customer_history: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_history"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_history`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.customer_id, s_uk.first_name,
        s_uk.last_name, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
        s_uk.effective_from, s_uk.crud_flag, s_uk.load_date
        from h, s_uk
        where s_uk.customer_hk = h.customer_hk
        union all
        select h.customer_hk, h.customer_number, s_us.customer_id, s_us.first_name,
        s_us.last_name, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
        s_us.effective_from, s_us.crud_flag, s_us.load_date
        from h, s_us
        where s_us.customer_hk = h.customer_hk)
select * from joined;


[0m17:28:10.736324 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m17:28:10.736324 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.v_comp_customers_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customers_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number, record_source
        from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.crud_flag, s_uk.customer_id,
                s_uk.title, s_uk.first_name, s_uk.last_name, s_uk.wealth_bracket, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
                s_uk.effective_from, s_uk.load_date, h.record_source,
                row_number() over(partition by s_uk.customer_hk order by s_uk.applieddate desc) as rn
         from h, s_uk
         where s_uk.customer_hk = h.customer_hk
         union all
         select h.customer_hk, h.customer_number, s_us.crud_flag, s_us.customer_id,
                '' as title, s_us.first_name, s_us.last_name, null as wealth_bracket, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
                s_us.effective_from, s_us.load_date, h.record_source,
                row_number() over(partition by s_us.customer_hk order by s_us.applieddate desc) as rn
         from h, s_us
         )
select customer_hk, customer_id, customer_number, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate, applieddate, effective_from, load_date, record_source from joined
where rn = 1 and crud_flag <> 'D';


[0m17:28:11.943749 [debug] [Thread-2  ]: finished collecting timing info
[0m17:28:11.944751 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE77F60D0>]}
[0m17:28:11.945751 [info ] [Thread-2  ]: 19 of 21 OK created view model data_vault.v_comp_customer_history .............. [[32mOK[0m in 1.27s]
[0m17:28:11.947882 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:28:11.970992 [debug] [Thread-5  ]: finished collecting timing info
[0m17:28:11.972010 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE77F6160>]}
[0m17:28:11.973009 [info ] [Thread-5  ]: 20 of 21 OK created view model data_vault.v_comp_customers_as_is ............... [[32mOK[0m in 1.30s]
[0m17:28:11.974992 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:28:11.976129 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:28:11.977145 [info ] [Thread-8  ]: 21 of 21 START view model data_vault.v_comp_customer_orders_as_is .............. [RUN]
[0m17:28:11.978131 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m17:28:11.979125 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:28:11.979125 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:28:11.989474 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m17:28:11.991491 [debug] [Thread-8  ]: finished collecting timing info
[0m17:28:11.991491 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:28:12.003785 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m17:28:12.005924 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m17:28:12.005924 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_orders_as_is`
  OPTIONS()
  as with
    c as
        (select customer_hk, customer_number, first_name, last_name
         from `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`),
    o as
        (select customer_hk, order_number, order_price, createddate, lastmodifieddate
         from `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`),
    joined as
        (select c.customer_number, c.first_name, c.last_name, o.order_number, o.order_price,
         o.createddate, o.lastmodifieddate
         from c, o
         where o.customer_hk = c.customer_hk)
select * from joined;


[0m17:28:13.374520 [debug] [Thread-8  ]: finished collecting timing info
[0m17:28:13.375656 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1742fd10-0723-4a50-9ce5-b36c1782fb70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8B66550>]}
[0m17:28:13.376650 [info ] [Thread-8  ]: 21 of 21 OK created view model data_vault.v_comp_customer_orders_as_is ......... [[32mOK[0m in 1.40s]
[0m17:28:13.379675 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:28:13.382787 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:28:13.384789 [info ] [MainThread]: 
[0m17:28:13.386791 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 14.91 seconds (14.91s).
[0m17:28:13.388987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:13.389987 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m17:28:13.389987 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m17:28:13.390986 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_orders_as_is' was properly closed.
[0m17:28:13.390986 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_customer_wealth_bracket' was properly closed.
[0m17:28:13.390986 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_history' was properly closed.
[0m17:28:13.391987 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_order' was properly closed.
[0m17:28:13.391987 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer' was properly closed.
[0m17:28:13.392987 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is' was properly closed.
[0m17:28:13.394061 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customers_as_is' was properly closed.
[0m17:28:13.394310 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_UK_customer' was properly closed.
[0m17:28:13.446601 [info ] [MainThread]: 
[0m17:28:13.448603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:13.450599 [info ] [MainThread]: 
[0m17:28:13.451730 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m17:28:13.453767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE8C0DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE7790340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014AE7466160>]}
[0m17:28:13.454791 [debug] [MainThread]: Flushing usage events


============================== 2022-11-05 17:28:54.114597 | 26a4d5e2-9208-4027-bfa0-959ac1c05bfb ==============================
[0m17:28:54.114597 [info ] [MainThread]: Running with dbt=1.2.2
[0m17:28:54.116607 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08:36.000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:28:54.116607 [debug] [MainThread]: Tracking: tracking
[0m17:28:54.117610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7065AFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7065AB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7065ACD0>]}
[0m17:28:54.714394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:28:54.714394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:28:54.722587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7093F0D0>]}
[0m17:28:54.787138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7090A0A0>]}
[0m17:28:54.787138 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 3 seed files, 4 sources, 0 exposures, 0 metrics
[0m17:28:54.788387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA70586880>]}
[0m17:28:54.790396 [info ] [MainThread]: 
[0m17:28:54.791466 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:28:54.793469 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m17:28:54.793469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:55.382258 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m17:28:55.383260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:55.751229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6FC30790>]}
[0m17:28:55.751362 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:28:55.755132 [info ] [MainThread]: 
[0m17:28:55.774373 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:28:55.776376 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m17:28:55.778374 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:28:55.779373 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_UK_order ............................. [RUN]
[0m17:28:55.779373 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:28:55.782373 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m17:28:55.781373 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m17:28:55.783373 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:28:55.784419 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:28:55.785425 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m17:28:55.786423 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m17:28:55.787425 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:28:55.788562 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:28:55.789556 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m17:28:55.800867 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m17:28:55.801862 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m17:28:55.802864 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:28:55.803884 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:28:55.804863 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:28:55.816974 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m17:28:55.818223 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:28:55.819218 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:28:55.828391 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m17:28:55.828391 [debug] [Thread-1  ]: finished collecting timing info
[0m17:28:55.841858 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m17:28:55.842836 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:28:55.848987 [debug] [Thread-2  ]: finished collecting timing info
[0m17:28:55.864421 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:28:55.955272 [debug] [Thread-4  ]: finished collecting timing info
[0m17:28:55.985966 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:28:56.024847 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m17:28:56.028992 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m17:28:56.034141 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m17:28:56.034141 [debug] [Thread-3  ]: finished collecting timing info
[0m17:28:56.036139 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:28:56.050761 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m17:28:56.050761 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:28:56.051745 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m17:28:56.055450 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:28:56.055450 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:28:56.058396 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m17:28:56.058396 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_UK_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m17:28:56.061554 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:28:56.067703 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m17:28:57.057178 [debug] [Thread-4  ]: finished collecting timing info
[0m17:28:57.058180 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA70906310>]}
[0m17:28:57.060358 [info ] [Thread-4  ]: 4 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.26s]
[0m17:28:57.076788 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m17:28:57.082998 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:28:57.083979 [info ] [Thread-6  ]: 5 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m17:28:57.085978 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m17:28:57.085978 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:28:57.086976 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:28:57.186515 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m17:28:57.241084 [debug] [Thread-3  ]: finished collecting timing info
[0m17:28:57.242085 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA70906970>]}
[0m17:28:57.243084 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.45s]
[0m17:28:57.246089 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m17:28:57.247087 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:28:57.248085 [info ] [Thread-8  ]: 6 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m17:28:57.250112 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m17:28:57.251108 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:28:57.251108 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:28:57.270112 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m17:28:57.279101 [debug] [Thread-1  ]: finished collecting timing info
[0m17:28:57.280106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7095F0A0>]}
[0m17:28:57.280106 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.50s]
[0m17:28:57.283106 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m17:28:57.285093 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:28:57.286089 [info ] [Thread-4  ]: 7 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m17:28:57.289106 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m17:28:57.290105 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:28:57.290105 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:28:57.312104 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:28:57.322408 [debug] [Thread-2  ]: finished collecting timing info
[0m17:28:57.323409 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA70906EB0>]}
[0m17:28:57.325420 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_UK_order ........................ [[32mOK[0m in 1.54s]
[0m17:28:57.327405 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m17:28:57.328474 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:28:57.329515 [info ] [Thread-3  ]: 8 of 21 START view model data_vault.v_stg_UK_order ............................. [RUN]
[0m17:28:57.331515 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m17:28:57.331515 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:28:57.331515 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:28:57.348863 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:28:58.292007 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m17:28:58.294911 [debug] [Thread-6  ]: finished collecting timing info
[0m17:28:58.295914 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:28:58.305319 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m17:28:58.314591 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
),

derived_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '3' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`DESCRIPTION` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`NAME` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:28:58.538258 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m17:28:58.552490 [debug] [Thread-8  ]: finished collecting timing info
[0m17:28:58.554634 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:28:58.565918 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m17:28:58.577107 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_stg_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_US_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    CUSTOMER_NUMBER AS `US_CUSTOMER_KEY`,
    '101' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`US_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:28:58.642020 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m17:28:58.659750 [debug] [Thread-3  ]: finished collecting timing info
[0m17:28:58.663849 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:28:58.671962 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m17:28:58.692348 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_stg_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_order`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
),

derived_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    ORDER_NUMBER AS `ORDER_KEY`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    '2' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), '')))) AS STRING) AS `ORDER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_ORDER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_PRICE` AS STRING))), ''), '^^')
    )))) AS `ORDER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `ORDER_HK`,
    `CUSTOMER_HK`,
    `CUSTOMER_ORDER_HK`,
    `ORDER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:28:58.729170 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m17:28:58.730170 [debug] [Thread-4  ]: finished collecting timing info
[0m17:28:58.731169 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:28:58.739397 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m17:28:58.740397 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_stg_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '1' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`TITLE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`WEALTH_BRACKET` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08:36.000000' AS LOAD_DATE
FROM staging;


[0m17:28:59.130107 [debug] [Thread-6  ]: finished collecting timing info
[0m17:28:59.131106 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA70906D60>]}
[0m17:28:59.133107 [info ] [Thread-6  ]: 5 of 21 OK created view model data_vault.v_stg_customer_wealth_bracket ......... [[32mOK[0m in 2.05s]
[0m17:28:59.139109 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m17:28:59.141106 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:28:59.142106 [info ] [Thread-1  ]: 9 of 21 START incremental model data_vault.hub_customer_wealth_bracket ......... [RUN]
[0m17:28:59.142106 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:28:59.144229 [info ] [Thread-7  ]: 10 of 21 START incremental model data_vault.sat_customer_wealth_bracket ........ [RUN]
[0m17:28:59.144229 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m17:28:59.145247 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:28:59.146230 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:28:59.147230 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m17:28:59.182403 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:28:59.185398 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:28:59.257995 [info ] [Thread-1  ]: 17:28:59 + Loading steadfast-task-363413.data_vault.hub_customer_wealth_bracket from 1 source(s)
[0m17:28:59.397687 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m17:28:59.479702 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m17:28:59.480703 [debug] [Thread-1  ]: finished collecting timing info
[0m17:28:59.481687 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:28:59.540220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:28:59.540220 [debug] [Thread-7  ]: finished collecting timing info
[0m17:28:59.542362 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:28:59.549650 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m17:28:59.720126 [debug] [Thread-8  ]: finished collecting timing info
[0m17:28:59.721287 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71B64640>]}
[0m17:28:59.722303 [info ] [Thread-8  ]: 6 of 21 OK created view model data_vault.v_stg_US_customer ..................... [[32mOK[0m in 2.47s]
[0m17:28:59.724281 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m17:28:59.725281 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:28:59.726284 [info ] [Thread-5  ]: 11 of 21 START incremental model data_vault.sat_US_customer .................... [RUN]
[0m17:28:59.728415 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_US_customer"
[0m17:28:59.728415 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:28:59.729418 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.sat_US_customer
[0m17:28:59.812103 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m17:28:59.819213 [debug] [Thread-4  ]: finished collecting timing info
[0m17:28:59.820214 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71BF0FA0>]}
[0m17:28:59.821214 [info ] [Thread-4  ]: 7 of 21 OK created view model data_vault.v_stg_UK_customer ..................... [[32mOK[0m in 2.53s]
[0m17:28:59.821214 [debug] [Thread-5  ]: finished collecting timing info
[0m17:28:59.822436 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:28:59.829602 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:28:59.832599 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m17:28:59.834600 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m17:28:59.834775 [info ] [Thread-2  ]: 12 of 21 START incremental model data_vault.hub_customer ....................... [RUN]
[0m17:28:59.836777 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:28:59.839774 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:28:59.841940 [info ] [Thread-8  ]: 13 of 21 START incremental model data_vault.link_customer_wealth_bracket_customer  [RUN]
[0m17:28:59.842938 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer"
[0m17:28:59.843936 [info ] [Thread-6  ]: 14 of 21 START incremental model data_vault.sat_UK_customer .................... [RUN]
[0m17:28:59.844936 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer
[0m17:28:59.844936 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m17:28:59.845936 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.hub_customer
[0m17:28:59.846935 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m17:28:59.847143 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:28:59.990180 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:29:00.020924 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m17:29:00.028129 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m17:29:00.030124 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:29:00.031298 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:29:00.036293 [debug] [Thread-3  ]: finished collecting timing info
[0m17:29:00.106703 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA709E7580>]}
[0m17:29:00.107702 [info ] [Thread-3  ]: 8 of 21 OK created view model data_vault.v_stg_UK_order ........................ [[32mOK[0m in 2.78s]
[0m17:29:00.108837 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.hub_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`ID`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`ID`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_HK` = d.`CUSTOMER_WEALTH_BRACKET_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m17:29:00.111839 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.sat_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`NAME`, a.`DESCRIPTION`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS a
    WHERE a.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_WEALTH_BRACKET_HK`, current_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_WEALTH_BRACKET_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_WEALTH_BRACKET_HK` = source_records.`CUSTOMER_WEALTH_BRACKET_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_WEALTH_BRACKET_HK`, stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, stage.`NAME`, stage.`DESCRIPTION`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_WEALTH_BRACKET_HK` = stage.`CUSTOMER_WEALTH_BRACKET_HK`
        AND latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` = stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`
    WHERE latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m17:29:00.127189 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m17:29:00.135312 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m17:29:00.135312 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m17:29:00.137311 [info ] [Thread-4  ]: 15 of 21 START incremental model data_vault.hub_order .......................... [RUN]
[0m17:29:00.141233 [info ] [Thread-3  ]: 16 of 21 START incremental model data_vault.link_customer_order ................ [RUN]
[0m17:29:00.148222 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_order"
[0m17:29:00.151399 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.hub_order
[0m17:29:00.156548 [info ] [Thread-2  ]: 17:29:00 + Loading steadfast-task-363413.data_vault.hub_customer from 2 source(s)
[0m17:29:00.156548 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.hub_order
[0m17:29:00.157556 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_order"
[0m17:29:00.177899 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_order
[0m17:29:00.180908 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.link_customer_order
[0m17:29:00.197411 [info ] [Thread-8  ]: 17:29:00 + Loading steadfast-task-363413.data_vault.link_customer_wealth_bracket_customer from 1 source(s)
[0m17:29:00.277352 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m17:29:00.286482 [info ] [Thread-4  ]: 17:29:00 + Loading steadfast-task-363413.data_vault.hub_order from 1 source(s)
[0m17:29:00.294787 [debug] [Thread-8  ]: finished collecting timing info
[0m17:29:00.311590 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m17:29:00.312988 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:29:00.332784 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m17:29:00.344968 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m17:29:00.356298 [info ] [Thread-3  ]: 17:29:00 + Loading steadfast-task-363413.data_vault.link_customer_order from 1 source(s)
[0m17:29:00.358277 [debug] [Thread-2  ]: finished collecting timing info
[0m17:29:00.359273 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer
[0m17:29:00.369596 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m17:29:00.398044 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m17:29:00.400044 [debug] [Thread-4  ]: finished collecting timing info
[0m17:29:00.404206 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.hub_order
[0m17:29:00.433672 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m17:29:00.460380 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m17:29:00.471724 [debug] [Thread-3  ]: finished collecting timing info
[0m17:29:00.469544 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m17:29:00.472841 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_order
[0m17:29:00.474721 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.sat_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_US_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_US_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_US_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m17:29:00.488191 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:29:00.494191 [debug] [Thread-6  ]: finished collecting timing info
[0m17:29:00.495191 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:29:00.506660 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m17:29:00.833937 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m17:29:00.836935 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_order` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_ORDER_HK`, rr.`CUSTOMER_HK`, rr.`ORDER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS rr
    WHERE rr.`CUSTOMER_ORDER_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    AND rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_ORDER_HK`, a.`CUSTOMER_HK`, a.`ORDER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_order` AS d
    ON a.`CUSTOMER_ORDER_HK` = d.`CUSTOMER_ORDER_HK`
    WHERE d.`CUSTOMER_ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m17:29:00.845935 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m17:29:00.851935 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m17:29:00.856957 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m17:29:00.860097 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.`CUSTOMER_HK`
               ORDER BY ru.`LOAD_DATE`, ru.`RECORD_SOURCE` ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_union AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer` AS d
    ON a.`CUSTOMER_HK` = d.`CUSTOMER_HK`
    WHERE d.`CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m17:29:00.864101 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m17:29:00.868239 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`CUSTOMER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NOT NULL
    AND rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` = d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m17:29:00.870240 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`ORDER_HK`, rr.`ORDER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS rr
    WHERE rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`ORDER_HK`, a.`ORDER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_order` AS d
    ON a.`ORDER_HK` = d.`ORDER_HK`
    WHERE d.`ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m17:29:00.874418 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.sat_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_UK_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`TITLE`, a.`WEALTH_BRACKET`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_UK_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`TITLE`, stage.`WEALTH_BRACKET`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m17:29:03.408979 [debug] [Thread-1  ]: finished collecting timing info
[0m17:29:03.409979 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71BF1940>]}
[0m17:29:03.410979 [info ] [Thread-1  ]: 9 of 21 OK created incremental model data_vault.hub_customer_wealth_bracket .... [[32mMERGE (0.0 rows, 870.0 Bytes processed)[0m in 4.27s]
[0m17:29:03.413977 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m17:29:03.413977 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:29:03.414980 [info ] [Thread-1  ]: 17 of 21 START incremental model data_vault.sat_UK_order ....................... [RUN]
[0m17:29:03.416977 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_order"
[0m17:29:03.416977 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:29:03.417976 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_order
[0m17:29:03.493982 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_order"
[0m17:29:03.496981 [debug] [Thread-1  ]: finished collecting timing info
[0m17:29:03.498982 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:29:03.506981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:29:03.732350 [debug] [Thread-7  ]: finished collecting timing info
[0m17:29:03.739351 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71BF1B50>]}
[0m17:29:03.740351 [info ] [Thread-7  ]: 10 of 21 OK created incremental model data_vault.sat_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 1.3 KB processed)[0m in 4.59s]
[0m17:29:03.747363 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m17:29:03.920942 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_order"
[0m17:29:03.923950 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.sat_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_UK_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`ORDER_ID`, a.`ORDER_PRICE`, a.`CUSTOMER_ID`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS a
    WHERE a.`ORDER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`ORDER_HK`, current_records.`ORDER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`ORDER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_UK_order` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`ORDER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`ORDER_HK` = source_records.`ORDER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`ORDER_HK`, stage.`ORDER_HASHDIFF`, stage.`ORDER_ID`, stage.`ORDER_PRICE`, stage.`CUSTOMER_ID`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`ORDER_HK` = stage.`ORDER_HK`
        AND latest_records.`ORDER_HASHDIFF` = stage.`ORDER_HASHDIFF`
    WHERE latest_records.`ORDER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_HASHDIFF`, `ORDER_ID`, `ORDER_PRICE`, `CUSTOMER_ID`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_HASHDIFF`, `ORDER_ID`, `ORDER_PRICE`, `CUSTOMER_ID`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m17:29:03.953359 [debug] [Thread-3  ]: finished collecting timing info
[0m17:29:03.955378 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA70AF64C0>]}
[0m17:29:03.956377 [info ] [Thread-3  ]: 16 of 21 OK created incremental model data_vault.link_customer_order ........... [[32mMERGE (0.0 rows, 63.0 Bytes processed)[0m in 3.80s]
[0m17:29:03.958357 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m17:29:04.065558 [debug] [Thread-4  ]: finished collecting timing info
[0m17:29:04.067559 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA70AF6AC0>]}
[0m17:29:04.067559 [info ] [Thread-4  ]: 15 of 21 OK created incremental model data_vault.hub_order ..................... [[32mMERGE (0.0 rows, 63.0 Bytes processed)[0m in 3.92s]
[0m17:29:04.070537 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m17:29:04.161825 [debug] [Thread-6  ]: finished collecting timing info
[0m17:29:04.163825 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71D0A430>]}
[0m17:29:04.163825 [info ] [Thread-6  ]: 14 of 21 OK created incremental model data_vault.sat_UK_customer ............... [[32mMERGE (3.0 rows, 736.0 Bytes processed)[0m in 4.32s]
[0m17:29:04.165821 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m17:29:04.215969 [debug] [Thread-5  ]: finished collecting timing info
[0m17:29:04.216967 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71CCCE80>]}
[0m17:29:04.218965 [info ] [Thread-5  ]: 11 of 21 OK created incremental model data_vault.sat_US_customer ............... [[32mMERGE (0.0 rows, 220.0 Bytes processed)[0m in 4.49s]
[0m17:29:04.229986 [debug] [Thread-8  ]: finished collecting timing info
[0m17:29:04.230989 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m17:29:04.231965 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71D0A1C0>]}
[0m17:29:04.233973 [info ] [Thread-8  ]: 13 of 21 OK created incremental model data_vault.link_customer_wealth_bracket_customer  [[32mMERGE (0.0 rows, 463.0 Bytes processed)[0m in 4.39s]
[0m17:29:04.237112 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m17:29:04.463762 [debug] [Thread-2  ]: finished collecting timing info
[0m17:29:04.464783 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71B6C700>]}
[0m17:29:04.465784 [info ] [Thread-2  ]: 12 of 21 OK created incremental model data_vault.hub_customer .................. [[32mMERGE (0.0 rows, 460.0 Bytes processed)[0m in 4.62s]
[0m17:29:04.467923 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m17:29:04.468902 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:29:04.469902 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:29:04.469902 [info ] [Thread-7  ]: 18 of 21 START view model data_vault.v_comp_customer_history ................... [RUN]
[0m17:29:04.470902 [info ] [Thread-3  ]: 19 of 21 START view model data_vault.v_comp_customers_as_is .................... [RUN]
[0m17:29:04.473017 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m17:29:04.474024 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:29:04.474024 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:29:04.475019 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m17:29:04.488344 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m17:29:04.488344 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:29:04.489320 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:29:04.499610 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m17:29:04.500606 [debug] [Thread-7  ]: finished collecting timing info
[0m17:29:04.501607 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:29:04.510424 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m17:29:04.511424 [debug] [Thread-3  ]: finished collecting timing info
[0m17:29:04.512407 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:29:04.523687 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m17:29:04.525830 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m17:29:04.529095 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.v_comp_customer_history: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_history"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_history`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.customer_id, s_uk.first_name,
        s_uk.last_name, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
        s_uk.effective_from, s_uk.crud_flag, s_uk.load_date
        from h, s_uk
        where s_uk.customer_hk = h.customer_hk
        union all
        select h.customer_hk, h.customer_number, s_us.customer_id, s_us.first_name,
        s_us.last_name, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
        s_us.effective_from, s_us.crud_flag, s_us.load_date
        from h, s_us
        where s_us.customer_hk = h.customer_hk)
select * from joined;


[0m17:29:04.538324 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m17:29:04.540464 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_comp_customers_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customers_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number, record_source
        from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.crud_flag, s_uk.customer_id,
                s_uk.title, s_uk.first_name, s_uk.last_name, s_uk.wealth_bracket, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
                s_uk.effective_from, s_uk.load_date, h.record_source,
                row_number() over(partition by s_uk.customer_hk order by s_uk.applieddate desc) as rn
         from h, s_uk
         where s_uk.customer_hk = h.customer_hk
         union all
         select h.customer_hk, h.customer_number, s_us.crud_flag, s_us.customer_id,
                '' as title, s_us.first_name, s_us.last_name, null as wealth_bracket, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
                s_us.effective_from, s_us.load_date, h.record_source,
                row_number() over(partition by s_us.customer_hk order by s_us.applieddate desc) as rn
         from h, s_us
         )
select customer_hk, customer_id, customer_number, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate, applieddate, effective_from, load_date, record_source from joined
where rn = 1 and crud_flag <> 'D';


[0m17:29:05.433258 [debug] [Thread-7  ]: finished collecting timing info
[0m17:29:05.434257 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA709DE610>]}
[0m17:29:05.436257 [info ] [Thread-7  ]: 18 of 21 OK created view model data_vault.v_comp_customer_history .............. [[32mOK[0m in 0.96s]
[0m17:29:05.439257 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m17:29:05.699556 [debug] [Thread-3  ]: finished collecting timing info
[0m17:29:05.700699 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71BF0FA0>]}
[0m17:29:05.700699 [info ] [Thread-3  ]: 19 of 21 OK created view model data_vault.v_comp_customers_as_is ............... [[32mOK[0m in 1.23s]
[0m17:29:05.702695 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m17:29:07.429416 [debug] [Thread-1  ]: finished collecting timing info
[0m17:29:07.430417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7097E130>]}
[0m17:29:07.431416 [info ] [Thread-1  ]: 17 of 21 OK created incremental model data_vault.sat_UK_order .................. [[32mMERGE (0.0 rows, 63.0 Bytes processed)[0m in 4.01s]
[0m17:29:07.434079 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_order
[0m17:29:07.435076 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:29:07.436097 [info ] [Thread-6  ]: 20 of 21 START view model data_vault.v_comp_orders_as_is ....................... [RUN]
[0m17:29:07.439076 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m17:29:07.440074 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:29:07.440074 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:29:07.455077 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m17:29:07.458076 [debug] [Thread-6  ]: finished collecting timing info
[0m17:29:07.458076 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:29:07.470077 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m17:29:07.473085 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
[0m17:29:07.474091 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.v_comp_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`
  OPTIONS()
  as with
    h as
        (select order_hk, order_number, record_source from `steadfast-task-363413`.`data_vault`.`hub_order`),
    s as
        (select order_hk, order_id, order_price, lastmodifieddate, createddate, effective_from, load_date,
         crud_flag, row_number() over(partition by order_hk order by lastmodifieddate desc) as rn
         from `steadfast-task-363413`.`data_vault`.`sat_UK_order`),
    co as
        (select order_hk, customer_hk from `steadfast-task-363413`.`data_vault`.`link_customer_order` ),
    joined as
        (select h.order_hk, h.order_number,
            co.customer_hk,
            s.order_id, s.order_price, s.lastmodifieddate, s.createddate, h.record_source, s.effective_from,
            s.load_date, s.crud_flag, s.rn
         from h, s, co
        where s.order_hk = h.order_hk
        and co.order_hk = h.order_hk)
select order_hk, customer_hk, order_id, order_number, order_price, lastmodifieddate, createddate,
effective_from, load_date
from joined
where rn = 1 and crud_flag <> 'D';


[0m17:29:08.725331 [debug] [Thread-6  ]: finished collecting timing info
[0m17:29:08.726331 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA7097CF40>]}
[0m17:29:08.727331 [info ] [Thread-6  ]: 20 of 21 OK created view model data_vault.v_comp_orders_as_is .................. [[32mOK[0m in 1.29s]
[0m17:29:08.728332 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m17:29:08.729864 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:29:08.729864 [info ] [Thread-8  ]: 21 of 21 START view model data_vault.v_comp_customer_orders_as_is .............. [RUN]
[0m17:29:08.731912 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m17:29:08.731912 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:29:08.732908 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:29:08.741099 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m17:29:08.742112 [debug] [Thread-8  ]: finished collecting timing info
[0m17:29:08.743097 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:29:08.749231 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m17:29:08.750224 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m17:29:08.751223 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_orders_as_is`
  OPTIONS()
  as with
    c as
        (select customer_hk, customer_number, first_name, last_name
         from `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`),
    o as
        (select customer_hk, order_number, order_price, createddate, lastmodifieddate
         from `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`),
    joined as
        (select c.customer_number, c.first_name, c.last_name, o.order_number, o.order_price,
         o.createddate, o.lastmodifieddate
         from c, o
         where o.customer_hk = c.customer_hk)
select * from joined;


[0m17:29:09.796875 [debug] [Thread-8  ]: finished collecting timing info
[0m17:29:09.797880 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a4d5e2-9208-4027-bfa0-959ac1c05bfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71D97820>]}
[0m17:29:09.798863 [info ] [Thread-8  ]: 21 of 21 OK created view model data_vault.v_comp_customer_orders_as_is ......... [[32mOK[0m in 1.07s]
[0m17:29:09.801023 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m17:29:09.805021 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m17:29:09.806222 [info ] [MainThread]: 
[0m17:29:09.808220 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 15.02 seconds (15.02s).
[0m17:29:09.810224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:09.811219 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m17:29:09.811219 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m17:29:09.811219 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_UK_order' was properly closed.
[0m17:29:09.812383 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_customer' was properly closed.
[0m17:29:09.812383 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customers_as_is' was properly closed.
[0m17:29:09.812383 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.hub_order' was properly closed.
[0m17:29:09.812383 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_orders_as_is' was properly closed.
[0m17:29:09.813383 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is' was properly closed.
[0m17:29:09.813383 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_history' was properly closed.
[0m17:29:09.813383 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_US_customer' was properly closed.
[0m17:29:09.876595 [info ] [MainThread]: 
[0m17:29:09.878753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:09.880749 [info ] [MainThread]: 
[0m17:29:09.882751 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m17:29:09.884910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA705867F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA705EDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA71D939A0>]}
[0m17:29:09.885902 [debug] [MainThread]: Flushing usage events


============================== 2022-11-08 09:12:09.329775 | b50e47b9-5821-4c67-92a0-41fe2b4f8e86 ==============================
[0m09:12:09.329775 [info ] [MainThread]: Running with dbt=1.2.2
[0m09:12:09.329775 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:12:09.329775 [debug] [MainThread]: Tracking: tracking
[0m09:12:09.329775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B07DB100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B07DBBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B07DB970>]}
[0m09:12:09.595479 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:12:09.595479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B07CE1C0>]}
[0m09:12:11.721123 [debug] [MainThread]: Parsing macros\adapters.sql
[0m09:12:11.768018 [debug] [MainThread]: Parsing macros\catalog.sql
[0m09:12:11.783647 [debug] [MainThread]: Parsing macros\etc.sql
[0m09:12:11.783647 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m09:12:11.783647 [debug] [MainThread]: Parsing macros\materializations\copy.sql
[0m09:12:11.783647 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m09:12:11.814907 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m09:12:11.814907 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m09:12:11.830538 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m09:12:11.830538 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m09:12:11.830538 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m09:12:11.846168 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m09:12:11.861794 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m09:12:11.861794 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m09:12:11.893050 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m09:12:11.908684 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m09:12:11.908684 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m09:12:11.908684 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m09:12:11.924319 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m09:12:11.939948 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m09:12:11.955574 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m09:12:11.955574 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m09:12:11.971207 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m09:12:11.986838 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m09:12:11.986838 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m09:12:11.986838 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m09:12:11.986838 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m09:12:11.986838 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m09:12:11.986838 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m09:12:12.002468 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m09:12:12.002468 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m09:12:12.002468 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m09:12:12.018097 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m09:12:12.018097 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m09:12:12.143128 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m09:12:12.143128 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m09:12:12.174385 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m09:12:12.190015 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m09:12:12.205647 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m09:12:12.205647 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m09:12:12.221300 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m09:12:12.221300 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m09:12:12.221300 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m09:12:12.236930 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m09:12:12.268186 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m09:12:12.283798 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m09:12:12.299428 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m09:12:12.315059 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m09:12:12.315059 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m09:12:12.346318 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m09:12:12.346318 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m09:12:12.361955 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m09:12:12.361955 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m09:12:12.361955 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m09:12:12.361955 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m09:12:12.361955 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m09:12:12.361955 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m09:12:12.377587 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m09:12:12.377587 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m09:12:12.393204 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m09:12:12.393204 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m09:12:12.393204 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m09:12:12.393204 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m09:12:12.393204 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m09:12:12.393204 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m09:12:12.393204 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m09:12:12.408831 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m09:12:12.408831 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m09:12:12.408831 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m09:12:12.408831 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m09:12:12.408831 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m09:12:12.408831 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m09:12:12.408831 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m09:12:12.424466 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m09:12:12.424466 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m09:12:12.440123 [debug] [MainThread]: Parsing macros\internal\helpers\logging.sql
[0m09:12:12.440123 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m09:12:12.440123 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m09:12:12.471373 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m09:12:12.471373 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m09:12:12.471373 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m09:12:12.487007 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m09:12:12.487007 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m09:12:12.487007 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m09:12:12.518269 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m09:12:12.518269 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m09:12:12.533899 [debug] [MainThread]: Parsing macros\internal\metadata_processing\process_payload_column_excludes.sql
[0m09:12:12.533899 [debug] [MainThread]: Parsing macros\materialisations\drop_temporary.sql
[0m09:12:12.533899 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m09:12:12.549522 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m09:12:12.549522 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m09:12:12.565145 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m09:12:12.580761 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m09:12:12.580761 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m09:12:12.627657 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m09:12:12.643275 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m09:12:12.674556 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m09:12:12.674556 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m09:12:12.690186 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m09:12:12.690186 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m09:12:12.705814 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m09:12:12.705814 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m09:12:12.705814 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m09:12:12.721445 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m09:12:12.721445 [debug] [MainThread]: Parsing macros\staging\null_columns.sql
[0m09:12:12.752687 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m09:12:12.768313 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m09:12:12.768313 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m09:12:12.783956 [debug] [MainThread]: Parsing macros\supporting\as_of_date_window.sql
[0m09:12:12.799591 [debug] [MainThread]: Parsing macros\supporting\bridge_shared.sql
[0m09:12:12.815221 [debug] [MainThread]: Parsing macros\supporting\cast_binary.sql
[0m09:12:12.815221 [debug] [MainThread]: Parsing macros\supporting\cast_date.sql
[0m09:12:12.815221 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m09:12:12.830850 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m09:12:12.830850 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m09:12:12.830850 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m09:12:12.877740 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m09:12:12.877740 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m09:12:12.877740 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m09:12:12.877740 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m09:12:12.893744 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m09:12:12.909217 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m09:12:12.924631 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m09:12:12.940260 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m09:12:12.955889 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m09:12:12.955889 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m09:12:12.955889 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m09:12:12.955889 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
[0m09:12:12.955889 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
[0m09:12:12.955889 [debug] [MainThread]: Parsing macros\tables\databricks\sat.sql
[0m09:12:12.971521 [debug] [MainThread]: Parsing macros\tables\postgres\hub.sql
[0m09:12:12.971521 [debug] [MainThread]: Parsing macros\tables\postgres\link.sql
[0m09:12:12.987148 [debug] [MainThread]: Parsing macros\tables\postgres\sat.sql
[0m09:12:13.002778 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m09:12:13.002778 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m09:12:13.034037 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m09:12:13.049667 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m09:12:13.065296 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m09:12:13.080926 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m09:12:13.128046 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m09:12:13.143673 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m09:12:13.159314 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m09:12:13.190345 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m09:12:13.190345 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m09:12:13.205971 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m09:12:13.221602 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m09:12:13.252859 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m09:12:13.268490 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m09:12:13.268490 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m09:12:13.268490 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m09:12:13.284122 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m09:12:13.284122 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\xdb_deprecation_warning.sql
[0m09:12:13.284122 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m09:12:13.284122 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m09:12:13.284122 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m09:12:13.284122 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m09:12:13.299743 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m09:12:13.299743 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m09:12:13.315380 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m09:12:13.315380 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m09:12:13.331002 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m09:12:13.331002 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m09:12:13.346638 [debug] [MainThread]: Parsing macros\generic_tests\not_empty_string.sql
[0m09:12:13.346638 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m09:12:13.346638 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m09:12:13.346638 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m09:12:13.362383 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m09:12:13.362383 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m09:12:13.362383 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m09:12:13.378136 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m09:12:13.378136 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m09:12:13.378136 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m09:12:13.378136 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_ephemeral.sql
[0m09:12:13.378136 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_relation.sql
[0m09:12:13.378136 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m09:12:13.393742 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m09:12:13.393742 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m09:12:13.409343 [debug] [MainThread]: Parsing macros\sql\generate_surrogate_key.sql
[0m09:12:13.409343 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m09:12:13.424794 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m09:12:13.424794 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m09:12:13.424794 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m09:12:13.440424 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m09:12:13.440424 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m09:12:13.456049 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m09:12:13.456049 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m09:12:13.456049 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m09:12:13.456049 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m09:12:13.471683 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m09:12:13.471683 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m09:12:13.487284 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m09:12:13.487284 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m09:12:13.487284 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m09:12:13.502916 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m09:12:13.502916 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m09:12:13.518544 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m09:12:13.534175 [debug] [MainThread]: Parsing macros\sql\width_bucket.sql
[0m09:12:13.549805 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m09:12:13.549805 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m09:12:13.549805 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m09:12:14.815811 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m09:12:14.847070 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m09:12:14.847070 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m09:12:14.847070 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m09:12:14.862699 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m09:12:14.862699 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m09:12:14.862699 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_order.sql
[0m09:12:14.862699 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m09:12:14.878329 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m09:12:15.003369 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m09:12:15.003369 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m09:12:15.018997 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m09:12:15.018997 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m09:12:15.034627 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m09:12:15.034627 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m09:12:15.081516 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m09:12:15.081516 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m09:12:15.097146 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m09:12:15.097146 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m09:12:15.206564 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m09:12:15.206564 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m09:12:15.253449 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m09:12:15.253449 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_order.sql
[0m09:12:15.300332 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_order.sql
[0m09:12:15.300332 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m09:12:15.362875 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m09:12:15.362875 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m09:12:15.581694 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m09:12:15.597314 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m09:12:15.691090 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m09:12:15.691090 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_order.sql
[0m09:12:15.784867 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_order.sql
[0m09:12:15.784867 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m09:12:15.863017 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m09:12:16.238124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0A39490>]}
[0m09:12:16.253753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0C15DC0>]}
[0m09:12:16.269379 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 3 seed files, 4 sources, 0 exposures, 0 metrics
[0m09:12:16.269379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0827970>]}
[0m09:12:16.269379 [info ] [MainThread]: 
[0m09:12:16.269379 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:12:16.269379 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m09:12:16.285008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:16.989034 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m09:12:16.989034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:12:17.332882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0A395B0>]}
[0m09:12:17.332882 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m09:12:17.332882 [info ] [MainThread]: 
[0m09:12:17.347826 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:12:17.347826 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:12:17.347826 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:12:17.347826 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:12:17.347826 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m09:12:17.363470 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_UK_order ............................. [RUN]
[0m09:12:17.363470 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m09:12:17.363470 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m09:12:17.363470 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m09:12:17.363470 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:12:17.363470 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m09:12:17.363470 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:12:17.363470 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:12:17.363470 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m09:12:17.363470 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m09:12:17.379108 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:12:17.379108 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m09:12:17.379108 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:12:17.379108 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m09:12:17.379108 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:12:17.379108 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:12:17.379108 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:12:17.395082 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m09:12:17.395082 [debug] [Thread-1  ]: finished collecting timing info
[0m09:12:17.395082 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m09:12:17.395082 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:12:17.395082 [debug] [Thread-2  ]: finished collecting timing info
[0m09:12:17.441642 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:12:17.441642 [debug] [Thread-3  ]: finished collecting timing info
[0m09:12:17.472868 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m09:12:17.472868 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m09:12:17.472868 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:12:17.472868 [debug] [Thread-4  ]: finished collecting timing info
[0m09:12:17.472868 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m09:12:17.472868 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:12:17.488495 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m09:12:17.488495 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:12:17.488495 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:12:17.488495 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_UK_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m09:12:17.488495 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m09:12:17.488495 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:12:17.488495 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:12:17.504138 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m09:12:17.504138 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m09:12:18.488823 [debug] [Thread-3  ]: finished collecting timing info
[0m09:12:18.488823 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0A103D0>]}
[0m09:12:18.488823 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.13s]
[0m09:12:18.504420 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:12:18.504420 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:12:18.504420 [info ] [Thread-6  ]: 5 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m09:12:18.504420 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m09:12:18.504420 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:12:18.504420 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:12:18.520051 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m09:12:18.723917 [debug] [Thread-2  ]: finished collecting timing info
[0m09:12:18.723917 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0A10070>]}
[0m09:12:18.723917 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_UK_order ........................ [[32mOK[0m in 1.36s]
[0m09:12:18.723917 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:12:18.723917 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:12:18.723917 [info ] [Thread-8  ]: 6 of 21 START view model data_vault.v_stg_UK_order ............................. [RUN]
[0m09:12:18.723917 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m09:12:18.723917 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:12:18.723917 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:12:18.738863 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m09:12:18.770143 [debug] [Thread-1  ]: finished collecting timing info
[0m09:12:18.770143 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0BCECD0>]}
[0m09:12:18.770143 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.41s]
[0m09:12:18.785752 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:12:18.785752 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:12:18.785752 [info ] [Thread-3  ]: 7 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m09:12:18.785752 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m09:12:18.785752 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:12:18.785752 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:12:18.785752 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:12:18.942446 [debug] [Thread-4  ]: finished collecting timing info
[0m09:12:18.942446 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0A10F70>]}
[0m09:12:18.942446 [info ] [Thread-4  ]: 4 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.56s]
[0m09:12:18.942446 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:12:18.942446 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:12:18.942446 [info ] [Thread-2  ]: 8 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m09:12:18.942446 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m09:12:18.942446 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:12:18.942446 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:12:18.957679 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:12:19.442203 [debug] [Thread-6  ]: finished collecting timing info
[0m09:12:19.442203 [debug] [Thread-6  ]: Compilation Error in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_US_customer = {
      "hash": "SHA",
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
  > called by model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
[0m09:12:19.442203 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B1CD07F0>]}
[0m09:12:19.442203 [error] [Thread-6  ]: 5 of 21 ERROR creating view model data_vault.v_stg_US_customer ................. [[31mERROR[0m in 0.94s]
[0m09:12:19.442203 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:12:19.442203 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m09:12:19.442203 [info ] [Thread-1  ]: 9 of 21 SKIP relation data_vault.sat_US_customer ............................... [[33mSKIP[0m]
[0m09:12:19.457845 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m09:12:19.661041 [debug] [Thread-8  ]: finished collecting timing info
[0m09:12:19.661041 [debug] [Thread-8  ]: Compilation Error in model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_UK_order = {
      "hash": "SHA",
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
  > called by model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
[0m09:12:19.661041 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0C1D370>]}
[0m09:12:19.661041 [error] [Thread-8  ]: 6 of 21 ERROR creating view model data_vault.v_stg_UK_order .................... [[31mERROR[0m in 0.94s]
[0m09:12:19.692499 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:12:19.692499 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m09:12:19.692499 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m09:12:19.707924 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_order
[0m09:12:19.707924 [info ] [Thread-4  ]: 10 of 21 SKIP relation data_vault.hub_order .................................... [[33mSKIP[0m]
[0m09:12:19.707924 [info ] [Thread-5  ]: 11 of 21 SKIP relation data_vault.link_customer_order .......................... [[33mSKIP[0m]
[0m09:12:19.707924 [info ] [Thread-6  ]: 12 of 21 SKIP relation data_vault.sat_UK_order ................................. [[33mSKIP[0m]
[0m09:12:19.739172 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m09:12:19.739172 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m09:12:19.770429 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_order
[0m09:12:19.770429 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m09:12:19.770429 [info ] [Thread-1  ]: 13 of 21 SKIP relation data_vault.v_comp_orders_as_is .......................... [[33mSKIP[0m]
[0m09:12:19.786072 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m09:12:19.786072 [debug] [Thread-3  ]: finished collecting timing info
[0m09:12:19.786072 [debug] [Thread-3  ]: Compilation Error in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_UK_customer = {
      "hash": "SHA",
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
  > called by model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
[0m09:12:19.786072 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B1CD8A60>]}
[0m09:12:19.786072 [error] [Thread-3  ]: 7 of 21 ERROR creating view model data_vault.v_stg_UK_customer ................. [[31mERROR[0m in 1.00s]
[0m09:12:19.786072 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:12:19.801687 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m09:12:19.801687 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m09:12:19.801687 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m09:12:19.801687 [info ] [Thread-7  ]: 14 of 21 SKIP relation data_vault.hub_customer ................................. [[33mSKIP[0m]
[0m09:12:19.801687 [info ] [Thread-4  ]: 15 of 21 SKIP relation data_vault.link_customer_wealth_bracket_customer ........ [[33mSKIP[0m]
[0m09:12:19.801687 [info ] [Thread-5  ]: 16 of 21 SKIP relation data_vault.sat_UK_customer .............................. [[33mSKIP[0m]
[0m09:12:19.817316 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m09:12:19.832948 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m09:12:19.848582 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m09:12:19.864205 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m09:12:19.864205 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m09:12:19.864205 [info ] [Thread-8  ]: 17 of 21 SKIP relation data_vault.v_comp_customer_history ...................... [[33mSKIP[0m]
[0m09:12:19.864205 [info ] [Thread-1  ]: 18 of 21 SKIP relation data_vault.v_comp_customers_as_is ....................... [[33mSKIP[0m]
[0m09:12:19.864205 [debug] [Thread-2  ]: finished collecting timing info
[0m09:12:19.879835 [debug] [Thread-2  ]: Compilation Error in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_customer_wealth_bracket = {
      "hash": "SHA",
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
  > called by model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
[0m09:12:19.879835 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b50e47b9-5821-4c67-92a0-41fe2b4f8e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B1CEC490>]}
[0m09:12:19.879835 [error] [Thread-2  ]: 8 of 21 ERROR creating view model data_vault.v_stg_customer_wealth_bracket ..... [[31mERROR[0m in 0.94s]
[0m09:12:19.879835 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m09:12:19.879835 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m09:12:19.879835 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m09:12:19.879835 [info ] [Thread-6  ]: 19 of 21 SKIP relation data_vault.v_comp_customer_orders_as_is ................. [[33mSKIP[0m]
[0m09:12:19.879835 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:12:19.879835 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m09:12:19.879835 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m09:12:19.879835 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m09:12:19.879835 [info ] [Thread-4  ]: 20 of 21 SKIP relation data_vault.hub_customer_wealth_bracket .................. [[33mSKIP[0m]
[0m09:12:19.879835 [info ] [Thread-5  ]: 21 of 21 SKIP relation data_vault.sat_customer_wealth_bracket .................. [[33mSKIP[0m]
[0m09:12:19.879835 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m09:12:19.879835 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m09:12:19.895465 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:12:19.895465 [info ] [MainThread]: 
[0m09:12:19.895465 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m09:12:19.895465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:12:19.895465 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m09:12:19.895465 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m09:12:19.895465 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_raw_UK_customer' was properly closed.
[0m09:12:19.895465 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket' was properly closed.
[0m09:12:19.895465 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_UK_customer' was properly closed.
[0m09:12:19.895465 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket' was properly closed.
[0m09:12:19.895465 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_US_customer' was properly closed.
[0m09:12:19.895465 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_UK_order' was properly closed.
[0m09:12:19.926724 [info ] [MainThread]: 
[0m09:12:19.926724 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:12:19.926724 [info ] [MainThread]: 
[0m09:12:19.926724 [error] [MainThread]: [33mCompilation Error in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)[0m
[0m09:12:19.926724 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m09:12:19.926724 [error] [MainThread]:   Vars supplied to v_stg_US_customer = {
[0m09:12:19.926724 [error] [MainThread]:       "hash": "SHA",
[0m09:12:19.926724 [error] [MainThread]:       "null_key_optional": "-2",
[0m09:12:19.926724 [error] [MainThread]:       "null_key_required": "-1"
[0m09:12:19.926724 [error] [MainThread]:   }
[0m09:12:19.926724 [error] [MainThread]:   
[0m09:12:19.926724 [error] [MainThread]:   > in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
[0m09:12:19.926724 [error] [MainThread]:   > called by model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
[0m09:12:19.926724 [info ] [MainThread]: 
[0m09:12:19.926724 [error] [MainThread]: [33mCompilation Error in model v_stg_UK_order (models\stage\v_stg_UK_order.sql)[0m
[0m09:12:19.942353 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m09:12:19.942353 [error] [MainThread]:   Vars supplied to v_stg_UK_order = {
[0m09:12:19.942353 [error] [MainThread]:       "hash": "SHA",
[0m09:12:19.942353 [error] [MainThread]:       "null_key_optional": "-2",
[0m09:12:19.942353 [error] [MainThread]:       "null_key_required": "-1"
[0m09:12:19.942353 [error] [MainThread]:   }
[0m09:12:19.942353 [error] [MainThread]:   
[0m09:12:19.942353 [error] [MainThread]:   > in model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
[0m09:12:19.942353 [error] [MainThread]:   > called by model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
[0m09:12:19.942353 [info ] [MainThread]: 
[0m09:12:19.942353 [error] [MainThread]: [33mCompilation Error in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)[0m
[0m09:12:19.942353 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m09:12:19.942353 [error] [MainThread]:   Vars supplied to v_stg_UK_customer = {
[0m09:12:19.942353 [error] [MainThread]:       "hash": "SHA",
[0m09:12:19.942353 [error] [MainThread]:       "null_key_optional": "-2",
[0m09:12:19.942353 [error] [MainThread]:       "null_key_required": "-1"
[0m09:12:19.942353 [error] [MainThread]:   }
[0m09:12:19.942353 [error] [MainThread]:   
[0m09:12:19.942353 [error] [MainThread]:   > in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
[0m09:12:19.942353 [error] [MainThread]:   > called by model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
[0m09:12:19.957982 [info ] [MainThread]: 
[0m09:12:19.957982 [error] [MainThread]: [33mCompilation Error in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)[0m
[0m09:12:19.957982 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m09:12:19.957982 [error] [MainThread]:   Vars supplied to v_stg_customer_wealth_bracket = {
[0m09:12:19.957982 [error] [MainThread]:       "hash": "SHA",
[0m09:12:19.957982 [error] [MainThread]:       "null_key_optional": "-2",
[0m09:12:19.957982 [error] [MainThread]:       "null_key_required": "-1"
[0m09:12:19.957982 [error] [MainThread]:   }
[0m09:12:19.957982 [error] [MainThread]:   
[0m09:12:19.957982 [error] [MainThread]:   > in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
[0m09:12:19.957982 [error] [MainThread]:   > called by model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
[0m09:12:19.957982 [info ] [MainThread]: 
[0m09:12:19.957982 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=13 TOTAL=21
[0m09:12:19.957982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0AAB880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0A4A700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231B0973310>]}
[0m09:12:19.957982 [debug] [MainThread]: Flushing usage events


============================== 2022-11-08 09:14:45.258993 | d51a5476-2b82-46c6-8c20-d7d540cfb32b ==============================
[0m09:14:45.258993 [info ] [MainThread]: Running with dbt=1.2.2
[0m09:14:45.258993 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date:2009-11-05 08.36.0000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:14:45.258993 [debug] [MainThread]: Tracking: tracking
[0m09:14:45.258993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019077DBB0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019077DBB160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019077DBB0A0>]}
[0m09:14:45.509044 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:14:45.509044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019077E07F70>]}
[0m09:14:45.837287 [debug] [MainThread]: Parsing macros\adapters.sql
[0m09:14:45.884160 [debug] [MainThread]: Parsing macros\catalog.sql
[0m09:14:45.884160 [debug] [MainThread]: Parsing macros\etc.sql
[0m09:14:45.899788 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m09:14:45.899788 [debug] [MainThread]: Parsing macros\materializations\copy.sql
[0m09:14:45.899788 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m09:14:45.931072 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m09:14:45.931072 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m09:14:45.931072 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m09:14:45.946708 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m09:14:45.946708 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m09:14:45.946708 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m09:14:45.946708 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m09:14:45.962338 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m09:14:45.993592 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m09:14:46.009219 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m09:14:46.009219 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m09:14:46.009219 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m09:14:46.024853 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m09:14:46.040482 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m09:14:46.056108 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m09:14:46.056108 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m09:14:46.071734 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m09:14:46.087359 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m09:14:46.087359 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m09:14:46.087359 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m09:14:46.087359 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m09:14:46.087359 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m09:14:46.087359 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m09:14:46.102989 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m09:14:46.102989 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m09:14:46.102989 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m09:14:46.118615 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m09:14:46.118615 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m09:14:46.228049 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m09:14:46.228049 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m09:14:46.259296 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m09:14:46.290534 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m09:14:46.290534 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m09:14:46.306185 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m09:14:46.306185 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m09:14:46.321815 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m09:14:46.321815 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m09:14:46.321815 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m09:14:46.353066 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m09:14:46.368683 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m09:14:46.384310 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m09:14:46.415569 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m09:14:46.415569 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m09:14:46.446856 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m09:14:46.446856 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m09:14:46.446856 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m09:14:46.462464 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m09:14:46.462464 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m09:14:46.462464 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m09:14:46.462464 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m09:14:46.462464 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m09:14:46.478109 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m09:14:46.478109 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m09:14:46.478109 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m09:14:46.478109 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m09:14:46.478109 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m09:14:46.478109 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m09:14:46.493748 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m09:14:46.493748 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m09:14:46.493748 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m09:14:46.493748 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m09:14:46.493748 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m09:14:46.509375 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m09:14:46.509375 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m09:14:46.509375 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m09:14:46.509375 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m09:14:46.509375 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m09:14:46.509375 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m09:14:46.525008 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m09:14:46.525008 [debug] [MainThread]: Parsing macros\internal\helpers\logging.sql
[0m09:14:46.540638 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m09:14:46.540638 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m09:14:46.556259 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m09:14:46.571883 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m09:14:46.571883 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m09:14:46.571883 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m09:14:46.587499 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m09:14:46.587499 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m09:14:46.603138 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m09:14:46.603138 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m09:14:46.618763 [debug] [MainThread]: Parsing macros\internal\metadata_processing\process_payload_column_excludes.sql
[0m09:14:46.618763 [debug] [MainThread]: Parsing macros\materialisations\drop_temporary.sql
[0m09:14:46.618763 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m09:14:46.634392 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m09:14:46.634392 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m09:14:46.634392 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m09:14:46.650018 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m09:14:46.650018 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m09:14:46.681293 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m09:14:46.696923 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m09:14:46.728162 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m09:14:46.728162 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m09:14:46.743793 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m09:14:46.743793 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m09:14:46.759424 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m09:14:46.759424 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m09:14:46.759424 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m09:14:46.775052 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m09:14:46.775052 [debug] [MainThread]: Parsing macros\staging\null_columns.sql
[0m09:14:46.790681 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m09:14:46.806311 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m09:14:46.806311 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m09:14:46.821940 [debug] [MainThread]: Parsing macros\supporting\as_of_date_window.sql
[0m09:14:46.837569 [debug] [MainThread]: Parsing macros\supporting\bridge_shared.sql
[0m09:14:46.837569 [debug] [MainThread]: Parsing macros\supporting\cast_binary.sql
[0m09:14:46.853199 [debug] [MainThread]: Parsing macros\supporting\cast_date.sql
[0m09:14:46.853199 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m09:14:46.853199 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m09:14:46.868829 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m09:14:46.868829 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m09:14:46.915718 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m09:14:46.915718 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m09:14:46.915718 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m09:14:46.915718 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m09:14:46.946978 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m09:14:46.946978 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m09:14:46.962609 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m09:14:46.978237 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m09:14:47.009503 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m09:14:47.009503 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m09:14:47.009503 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m09:14:47.009503 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
[0m09:14:47.009503 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
[0m09:14:47.009503 [debug] [MainThread]: Parsing macros\tables\databricks\sat.sql
[0m09:14:47.009503 [debug] [MainThread]: Parsing macros\tables\postgres\hub.sql
[0m09:14:47.025127 [debug] [MainThread]: Parsing macros\tables\postgres\link.sql
[0m09:14:47.040758 [debug] [MainThread]: Parsing macros\tables\postgres\sat.sql
[0m09:14:47.056387 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m09:14:47.056387 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m09:14:47.087646 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m09:14:47.103276 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m09:14:47.134539 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m09:14:47.165798 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m09:14:47.212709 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m09:14:47.228340 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m09:14:47.243972 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m09:14:47.275229 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m09:14:47.275229 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m09:14:47.290857 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m09:14:47.322110 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m09:14:47.337740 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m09:14:47.353370 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m09:14:47.368987 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m09:14:47.368987 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m09:14:47.368987 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m09:14:47.368987 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\xdb_deprecation_warning.sql
[0m09:14:47.368987 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m09:14:47.368987 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m09:14:47.384619 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m09:14:47.384619 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m09:14:47.384619 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m09:14:47.400246 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m09:14:47.400246 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m09:14:47.415873 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m09:14:47.431524 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m09:14:47.431524 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m09:14:47.431524 [debug] [MainThread]: Parsing macros\generic_tests\not_empty_string.sql
[0m09:14:47.431524 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m09:14:47.447162 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m09:14:47.447162 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m09:14:47.447162 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m09:14:47.462794 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m09:14:47.462794 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m09:14:47.462794 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m09:14:47.462794 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m09:14:47.462794 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m09:14:47.478423 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_ephemeral.sql
[0m09:14:47.478423 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_relation.sql
[0m09:14:47.478423 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m09:14:47.478423 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m09:14:47.494053 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m09:14:47.494053 [debug] [MainThread]: Parsing macros\sql\generate_surrogate_key.sql
[0m09:14:47.509678 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m09:14:47.509678 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m09:14:47.525311 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m09:14:47.525311 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m09:14:47.525311 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m09:14:47.540938 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m09:14:47.540938 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m09:14:47.556564 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m09:14:47.556564 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m09:14:47.556564 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m09:14:47.572183 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m09:14:47.572183 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m09:14:47.572183 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m09:14:47.587816 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m09:14:47.587816 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m09:14:47.587816 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m09:14:47.603445 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m09:14:47.619063 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m09:14:47.634697 [debug] [MainThread]: Parsing macros\sql\width_bucket.sql
[0m09:14:47.634697 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m09:14:47.650324 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m09:14:47.650324 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m09:14:48.916326 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m09:14:48.931954 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m09:14:48.947585 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m09:14:48.947585 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m09:14:48.947585 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m09:14:48.947585 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m09:14:48.947585 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_order.sql
[0m09:14:48.963214 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m09:14:48.963214 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m09:14:49.088254 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m09:14:49.103883 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m09:14:49.119514 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m09:14:49.119514 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m09:14:49.135142 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m09:14:49.135142 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m09:14:49.213305 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m09:14:49.213305 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m09:14:49.244559 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m09:14:49.244559 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m09:14:49.369606 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m09:14:49.385224 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m09:14:49.432147 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m09:14:49.447775 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_order.sql
[0m09:14:49.494655 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_order.sql
[0m09:14:49.494655 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m09:14:49.541533 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m09:14:49.557182 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m09:14:49.791626 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m09:14:49.791626 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m09:14:49.901012 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m09:14:49.901012 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_order.sql
[0m09:14:50.010429 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_order.sql
[0m09:14:50.010429 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m09:14:50.088564 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m09:14:50.479312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019077FFD7F0>]}
[0m09:14:50.510577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019078166310>]}
[0m09:14:50.510577 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 3 seed files, 4 sources, 0 exposures, 0 metrics
[0m09:14:50.510577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019077DADDC0>]}
[0m09:14:50.526204 [info ] [MainThread]: 
[0m09:14:50.526204 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:14:50.526204 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m09:14:50.541833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:51.167009 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m09:14:51.182639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:14:51.495247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019077DBB0A0>]}
[0m09:14:51.495247 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m09:14:51.495247 [info ] [MainThread]: 
[0m09:14:51.510876 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:14:51.510876 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:14:51.510876 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:14:51.510876 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:14:51.510876 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m09:14:51.510876 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_UK_order ............................. [RUN]
[0m09:14:51.526494 [info ] [Thread-3  ]: 3 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m09:14:51.526494 [info ] [Thread-4  ]: 4 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m09:14:51.526494 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m09:14:51.526494 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m09:14:51.526494 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:14:51.526494 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:14:51.526494 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m09:14:51.526494 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:14:51.526494 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:14:51.526494 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m09:14:51.526494 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:14:51.542125 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m09:14:51.542125 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m09:14:51.542125 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:14:51.542125 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:14:51.542125 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:14:51.557767 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m09:14:51.557767 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m09:14:51.557767 [debug] [Thread-2  ]: finished collecting timing info
[0m09:14:51.557767 [debug] [Thread-1  ]: finished collecting timing info
[0m09:14:51.557767 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:14:51.573384 [debug] [Thread-3  ]: finished collecting timing info
[0m09:14:51.573384 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:14:51.589026 [debug] [Thread-4  ]: finished collecting timing info
[0m09:14:51.635904 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m09:14:51.635904 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:14:51.635904 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m09:14:51.651533 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:14:51.651533 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m09:14:51.667163 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m09:14:51.667163 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:14:51.667163 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_UK_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m09:14:51.667163 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:14:51.667163 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m09:14:51.667163 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:14:51.667163 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:14:51.667163 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m09:14:51.667163 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m09:14:52.917540 [debug] [Thread-3  ]: finished collecting timing info
[0m09:14:52.917540 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019078082220>]}
[0m09:14:52.917540 [info ] [Thread-3  ]: 3 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.39s]
[0m09:14:52.917540 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:14:52.917540 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:14:52.917540 [info ] [Thread-6  ]: 5 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m09:14:52.917540 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m09:14:52.917540 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:14:52.917540 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:14:52.933165 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m09:14:52.933165 [debug] [Thread-1  ]: finished collecting timing info
[0m09:14:52.933165 [debug] [Thread-4  ]: finished collecting timing info
[0m09:14:52.933165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019077E7E0D0>]}
[0m09:14:52.933165 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001907808B490>]}
[0m09:14:52.948794 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.41s]
[0m09:14:52.948794 [info ] [Thread-4  ]: 4 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.41s]
[0m09:14:52.948794 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:14:52.948794 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:14:52.948794 [info ] [Thread-8  ]: 6 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m09:14:52.948794 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:14:52.948794 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m09:14:52.948794 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:14:52.948794 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:14:52.948794 [info ] [Thread-3  ]: 7 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m09:14:52.948794 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:14:52.964426 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m09:14:52.964426 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m09:14:52.964426 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:14:52.964426 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:14:52.964426 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:14:53.151984 [debug] [Thread-2  ]: finished collecting timing info
[0m09:14:53.151984 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001907821D7C0>]}
[0m09:14:53.151984 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_UK_order ........................ [[32mOK[0m in 1.63s]
[0m09:14:53.151984 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:14:53.151984 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:14:53.151984 [info ] [Thread-1  ]: 8 of 21 START view model data_vault.v_stg_UK_order ............................. [RUN]
[0m09:14:53.151984 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m09:14:53.151984 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:14:53.151984 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:14:53.183242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:14:53.870951 [debug] [Thread-3  ]: finished collecting timing info
[0m09:14:53.870951 [debug] [Thread-3  ]: Compilation Error in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_customer_wealth_bracket = {
      "hash": "SHA",
      "key:value": null,
      "load_date:2009-11-05 08.36.0000000": null,
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
  > called by model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
[0m09:14:53.870951 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190792AC580>]}
[0m09:14:53.886585 [error] [Thread-3  ]: 7 of 21 ERROR creating view model data_vault.v_stg_customer_wealth_bracket ..... [[31mERROR[0m in 0.91s]
[0m09:14:53.886585 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:14:53.886585 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m09:14:53.886585 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m09:14:53.902213 [info ] [Thread-4  ]: 9 of 21 SKIP relation data_vault.hub_customer_wealth_bracket ................... [[33mSKIP[0m]
[0m09:14:53.902213 [info ] [Thread-7  ]: 10 of 21 SKIP relation data_vault.sat_customer_wealth_bracket .................. [[33mSKIP[0m]
[0m09:14:53.917849 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m09:14:53.917849 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m09:14:53.980362 [debug] [Thread-6  ]: finished collecting timing info
[0m09:14:53.980362 [debug] [Thread-6  ]: Compilation Error in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_US_customer = {
      "hash": "SHA",
      "key:value": null,
      "load_date:2009-11-05 08.36.0000000": null,
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
  > called by model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
[0m09:14:53.980362 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190792E1160>]}
[0m09:14:53.980362 [error] [Thread-6  ]: 5 of 21 ERROR creating view model data_vault.v_stg_US_customer ................. [[31mERROR[0m in 1.06s]
[0m09:14:53.980362 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:14:53.995990 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m09:14:53.995990 [info ] [Thread-5  ]: 11 of 21 SKIP relation data_vault.sat_US_customer .............................. [[33mSKIP[0m]
[0m09:14:53.995990 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m09:14:54.199174 [debug] [Thread-1  ]: finished collecting timing info
[0m09:14:54.199174 [debug] [Thread-1  ]: Compilation Error in model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_UK_order = {
      "hash": "SHA",
      "key:value": null,
      "load_date:2009-11-05 08.36.0000000": null,
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
  > called by model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
[0m09:14:54.199174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001907928FE50>]}
[0m09:14:54.199174 [error] [Thread-1  ]: 8 of 21 ERROR creating view model data_vault.v_stg_UK_order .................... [[31mERROR[0m in 1.05s]
[0m09:14:54.230439 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:14:54.246070 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m09:14:54.246070 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m09:14:54.246070 [info ] [Thread-2  ]: 12 of 21 SKIP relation data_vault.hub_order .................................... [[33mSKIP[0m]
[0m09:14:54.246070 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_order
[0m09:14:54.246070 [info ] [Thread-4  ]: 13 of 21 SKIP relation data_vault.link_customer_order .......................... [[33mSKIP[0m]
[0m09:14:54.261698 [info ] [Thread-7  ]: 14 of 21 SKIP relation data_vault.sat_UK_order ................................. [[33mSKIP[0m]
[0m09:14:54.277350 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m09:14:54.292970 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m09:14:54.308584 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_order
[0m09:14:54.308584 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m09:14:54.308584 [info ] [Thread-3  ]: 15 of 21 SKIP relation data_vault.v_comp_orders_as_is .......................... [[33mSKIP[0m]
[0m09:14:54.324215 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m09:14:54.324215 [debug] [Thread-8  ]: finished collecting timing info
[0m09:14:54.324215 [debug] [Thread-8  ]: Compilation Error in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
  Required var 'load_date' not found in config:
  Vars supplied to v_stg_UK_customer = {
      "hash": "SHA",
      "key:value": null,
      "load_date:2009-11-05 08.36.0000000": null,
      "null_key_optional": "-2",
      "null_key_required": "-1"
  }
  
  > in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
  > called by model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
[0m09:14:54.324215 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd51a5476-2b82-46c6-8c20-d7d540cfb32b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190792C2310>]}
[0m09:14:54.324215 [error] [Thread-8  ]: 6 of 21 ERROR creating view model data_vault.v_stg_UK_customer ................. [[31mERROR[0m in 1.38s]
[0m09:14:54.339848 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:14:54.339848 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m09:14:54.339848 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m09:14:54.339848 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m09:14:54.339848 [info ] [Thread-1  ]: 16 of 21 SKIP relation data_vault.hub_customer ................................. [[33mSKIP[0m]
[0m09:14:54.339848 [info ] [Thread-6  ]: 17 of 21 SKIP relation data_vault.link_customer_wealth_bracket_customer ........ [[33mSKIP[0m]
[0m09:14:54.339848 [info ] [Thread-2  ]: 18 of 21 SKIP relation data_vault.sat_UK_customer .............................. [[33mSKIP[0m]
[0m09:14:54.339848 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m09:14:54.339848 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m09:14:54.339848 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m09:14:54.339848 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m09:14:54.339848 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m09:14:54.339848 [info ] [Thread-7  ]: 19 of 21 SKIP relation data_vault.v_comp_customer_history ...................... [[33mSKIP[0m]
[0m09:14:54.339848 [info ] [Thread-5  ]: 20 of 21 SKIP relation data_vault.v_comp_customers_as_is ....................... [[33mSKIP[0m]
[0m09:14:54.355474 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m09:14:54.355474 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m09:14:54.355474 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m09:14:54.355474 [info ] [Thread-8  ]: 21 of 21 SKIP relation data_vault.v_comp_customer_orders_as_is ................. [[33mSKIP[0m]
[0m09:14:54.355474 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m09:14:54.355474 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:14:54.355474 [info ] [MainThread]: 
[0m09:14:54.371106 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m09:14:54.371106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:14:54.371106 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m09:14:54.371106 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m09:14:54.371106 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_UK_order' was properly closed.
[0m09:14:54.371106 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_raw_UK_order' was properly closed.
[0m09:14:54.371106 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket' was properly closed.
[0m09:14:54.371106 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket' was properly closed.
[0m09:14:54.371106 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_US_customer' was properly closed.
[0m09:14:54.371106 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_stg_UK_customer' was properly closed.
[0m09:14:54.418000 [info ] [MainThread]: 
[0m09:14:54.433623 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m09:14:54.433623 [info ] [MainThread]: 
[0m09:14:54.433623 [error] [MainThread]: [33mCompilation Error in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)[0m
[0m09:14:54.433623 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m09:14:54.433623 [error] [MainThread]:   Vars supplied to v_stg_customer_wealth_bracket = {
[0m09:14:54.433623 [error] [MainThread]:       "hash": "SHA",
[0m09:14:54.433623 [error] [MainThread]:       "key:value": null,
[0m09:14:54.433623 [error] [MainThread]:       "load_date:2009-11-05 08.36.0000000": null,
[0m09:14:54.433623 [error] [MainThread]:       "null_key_optional": "-2",
[0m09:14:54.433623 [error] [MainThread]:       "null_key_required": "-1"
[0m09:14:54.433623 [error] [MainThread]:   }
[0m09:14:54.433623 [error] [MainThread]:   
[0m09:14:54.433623 [error] [MainThread]:   > in model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
[0m09:14:54.449251 [error] [MainThread]:   > called by model v_stg_customer_wealth_bracket (models\stage\v_stg_customer_wealth_bracket.sql)
[0m09:14:54.449251 [info ] [MainThread]: 
[0m09:14:54.449251 [error] [MainThread]: [33mCompilation Error in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)[0m
[0m09:14:54.449251 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m09:14:54.449251 [error] [MainThread]:   Vars supplied to v_stg_US_customer = {
[0m09:14:54.449251 [error] [MainThread]:       "hash": "SHA",
[0m09:14:54.449251 [error] [MainThread]:       "key:value": null,
[0m09:14:54.449251 [error] [MainThread]:       "load_date:2009-11-05 08.36.0000000": null,
[0m09:14:54.449251 [error] [MainThread]:       "null_key_optional": "-2",
[0m09:14:54.449251 [error] [MainThread]:       "null_key_required": "-1"
[0m09:14:54.449251 [error] [MainThread]:   }
[0m09:14:54.449251 [error] [MainThread]:   
[0m09:14:54.449251 [error] [MainThread]:   > in model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
[0m09:14:54.449251 [error] [MainThread]:   > called by model v_stg_US_customer (models\stage\v_stg_US_customer.sql)
[0m09:14:54.449251 [info ] [MainThread]: 
[0m09:14:54.449251 [error] [MainThread]: [33mCompilation Error in model v_stg_UK_order (models\stage\v_stg_UK_order.sql)[0m
[0m09:14:54.464898 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m09:14:54.464898 [error] [MainThread]:   Vars supplied to v_stg_UK_order = {
[0m09:14:54.464898 [error] [MainThread]:       "hash": "SHA",
[0m09:14:54.464898 [error] [MainThread]:       "key:value": null,
[0m09:14:54.464898 [error] [MainThread]:       "load_date:2009-11-05 08.36.0000000": null,
[0m09:14:54.464898 [error] [MainThread]:       "null_key_optional": "-2",
[0m09:14:54.464898 [error] [MainThread]:       "null_key_required": "-1"
[0m09:14:54.464898 [error] [MainThread]:   }
[0m09:14:54.464898 [error] [MainThread]:   
[0m09:14:54.464898 [error] [MainThread]:   > in model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
[0m09:14:54.464898 [error] [MainThread]:   > called by model v_stg_UK_order (models\stage\v_stg_UK_order.sql)
[0m09:14:54.464898 [info ] [MainThread]: 
[0m09:14:54.480529 [error] [MainThread]: [33mCompilation Error in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)[0m
[0m09:14:54.480529 [error] [MainThread]:   Required var 'load_date' not found in config:
[0m09:14:54.480529 [error] [MainThread]:   Vars supplied to v_stg_UK_customer = {
[0m09:14:54.480529 [error] [MainThread]:       "hash": "SHA",
[0m09:14:54.480529 [error] [MainThread]:       "key:value": null,
[0m09:14:54.480529 [error] [MainThread]:       "load_date:2009-11-05 08.36.0000000": null,
[0m09:14:54.480529 [error] [MainThread]:       "null_key_optional": "-2",
[0m09:14:54.480529 [error] [MainThread]:       "null_key_required": "-1"
[0m09:14:54.480529 [error] [MainThread]:   }
[0m09:14:54.480529 [error] [MainThread]:   
[0m09:14:54.480529 [error] [MainThread]:   > in model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
[0m09:14:54.480529 [error] [MainThread]:   > called by model v_stg_UK_customer (models\stage\v_stg_UK_customer.sql)
[0m09:14:54.480529 [info ] [MainThread]: 
[0m09:14:54.480529 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=13 TOTAL=21
[0m09:14:54.496159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001907828F6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019077EA1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019078294910>]}
[0m09:14:54.496159 [debug] [MainThread]: Flushing usage events


============================== 2022-11-08 09:16:21.406059 | f9ecc229-02a3-4fd2-854a-09cd49318e83 ==============================
[0m09:16:21.406059 [info ] [MainThread]: Running with dbt=1.2.2
[0m09:16:21.406059 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\james\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'vars': '{key:value, load_date: 2009-11-05 08.36.0000000}', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m09:16:21.406059 [debug] [MainThread]: Tracking: tracking
[0m09:16:21.406059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FCAAC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FCAA040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FCAABE0>]}
[0m09:16:21.640505 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m09:16:21.640505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FCFC6D0>]}
[0m09:16:21.953095 [debug] [MainThread]: Parsing macros\adapters.sql
[0m09:16:21.984353 [debug] [MainThread]: Parsing macros\catalog.sql
[0m09:16:21.984353 [debug] [MainThread]: Parsing macros\etc.sql
[0m09:16:21.999984 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m09:16:21.999984 [debug] [MainThread]: Parsing macros\materializations\copy.sql
[0m09:16:21.999984 [debug] [MainThread]: Parsing macros\materializations\incremental.sql
[0m09:16:22.015614 [debug] [MainThread]: Parsing macros\materializations\seed.sql
[0m09:16:22.015614 [debug] [MainThread]: Parsing macros\materializations\snapshot.sql
[0m09:16:22.015614 [debug] [MainThread]: Parsing macros\materializations\table.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\materializations\view.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m09:16:22.031246 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m09:16:22.046874 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m09:16:22.046874 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m09:16:22.046874 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m09:16:22.062500 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m09:16:22.062500 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m09:16:22.062500 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m09:16:22.078133 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m09:16:22.078133 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m09:16:22.078133 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m09:16:22.093763 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m09:16:22.109392 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m09:16:22.109392 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m09:16:22.125040 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m09:16:22.125040 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m09:16:22.125040 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m09:16:22.125040 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m09:16:22.125040 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m09:16:22.125040 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m09:16:22.125040 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m09:16:22.125040 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m09:16:22.140669 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m09:16:22.140669 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m09:16:22.140669 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m09:16:22.203188 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m09:16:22.203188 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m09:16:22.234429 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m09:16:22.250059 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m09:16:22.265686 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m09:16:22.265686 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m09:16:22.265686 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m09:16:22.265686 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m09:16:22.265686 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m09:16:22.281319 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m09:16:22.296946 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m09:16:22.312576 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m09:16:22.312576 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m09:16:22.328208 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m09:16:22.328208 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m09:16:22.343838 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m09:16:22.359466 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m09:16:22.359466 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m09:16:22.359466 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m09:16:22.359466 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m09:16:22.359466 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m09:16:22.359466 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m09:16:22.359466 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m09:16:22.375095 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m09:16:22.375095 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m09:16:22.375095 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m09:16:22.375095 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m09:16:22.375095 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m09:16:22.375095 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m09:16:22.375095 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m09:16:22.375095 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m09:16:22.375095 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m09:16:22.375095 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m09:16:22.390725 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m09:16:22.390725 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m09:16:22.390725 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m09:16:22.390725 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m09:16:22.390725 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m09:16:22.390725 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m09:16:22.390725 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m09:16:22.390725 [debug] [MainThread]: Parsing macros\internal\helpers\is_checks.sql
[0m09:16:22.406354 [debug] [MainThread]: Parsing macros\internal\helpers\logging.sql
[0m09:16:22.406354 [debug] [MainThread]: Parsing macros\internal\helpers\prepend_generated_by.sql
[0m09:16:22.406354 [debug] [MainThread]: Parsing macros\internal\helpers\stage_processing_macros.sql
[0m09:16:22.421993 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias.sql
[0m09:16:22.421993 [debug] [MainThread]: Parsing macros\internal\metadata_processing\alias_all.sql
[0m09:16:22.421993 [debug] [MainThread]: Parsing macros\internal\metadata_processing\as_constant.sql
[0m09:16:22.421993 [debug] [MainThread]: Parsing macros\internal\metadata_processing\check_required_parameters.sql
[0m09:16:22.437614 [debug] [MainThread]: Parsing macros\internal\metadata_processing\concat_ws.sql
[0m09:16:22.437614 [debug] [MainThread]: Parsing macros\internal\metadata_processing\escape_column_names.sql
[0m09:16:22.453245 [debug] [MainThread]: Parsing macros\internal\metadata_processing\expand_column_list.sql
[0m09:16:22.453245 [debug] [MainThread]: Parsing macros\internal\metadata_processing\multikey.sql
[0m09:16:22.468905 [debug] [MainThread]: Parsing macros\internal\metadata_processing\process_payload_column_excludes.sql
[0m09:16:22.468905 [debug] [MainThread]: Parsing macros\materialisations\drop_temporary.sql
[0m09:16:22.484534 [debug] [MainThread]: Parsing macros\materialisations\incremental_bridge_materialization.sql
[0m09:16:22.484534 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_bridge_replace.sql
[0m09:16:22.500164 [debug] [MainThread]: Parsing macros\materialisations\incremental_pit_materialization.sql
[0m09:16:22.500164 [debug] [MainThread]: Parsing macros\materialisations\mat_is_checks.sql
[0m09:16:22.515787 [debug] [MainThread]: Parsing macros\materialisations\shared_helpers.sql
[0m09:16:22.531419 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_period_materialization.sql
[0m09:16:22.578308 [debug] [MainThread]: Parsing macros\materialisations\vault_insert_by_rank_materialization.sql
[0m09:16:22.609560 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_boundaries.sql
[0m09:16:22.640819 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_filter_sql.sql
[0m09:16:22.656436 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_period_of_load.sql
[0m09:16:22.672064 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\get_start_stop_dates.sql
[0m09:16:22.687693 [debug] [MainThread]: Parsing macros\materialisations\period_mat_helpers\replace_placeholder_with_period_filter.sql
[0m09:16:22.703347 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\get_min_max_ranks.sql
[0m09:16:22.703347 [debug] [MainThread]: Parsing macros\materialisations\rank_mat_helpers\replace_placeholder_with_rank_filter.sql
[0m09:16:22.718954 [debug] [MainThread]: Parsing macros\staging\derive_columns.sql
[0m09:16:22.734583 [debug] [MainThread]: Parsing macros\staging\hash_columns.sql
[0m09:16:22.734583 [debug] [MainThread]: Parsing macros\staging\null_columns.sql
[0m09:16:22.765843 [debug] [MainThread]: Parsing macros\staging\rank_columns.sql
[0m09:16:22.781470 [debug] [MainThread]: Parsing macros\staging\source_columns.sql
[0m09:16:22.781470 [debug] [MainThread]: Parsing macros\staging\stage.sql
[0m09:16:22.828381 [debug] [MainThread]: Parsing macros\supporting\as_of_date_window.sql
[0m09:16:22.828381 [debug] [MainThread]: Parsing macros\supporting\bridge_shared.sql
[0m09:16:22.859635 [debug] [MainThread]: Parsing macros\supporting\cast_binary.sql
[0m09:16:22.859635 [debug] [MainThread]: Parsing macros\supporting\cast_date.sql
[0m09:16:22.875254 [debug] [MainThread]: Parsing macros\supporting\current_timestamp.sql
[0m09:16:22.875254 [debug] [MainThread]: Parsing macros\supporting\datatypes.sql
[0m09:16:22.875254 [debug] [MainThread]: Parsing macros\supporting\get_query_results_as_dict.sql
[0m09:16:22.890884 [debug] [MainThread]: Parsing macros\supporting\hash.sql
[0m09:16:22.953401 [debug] [MainThread]: Parsing macros\supporting\max_datetime.sql
[0m09:16:22.953401 [debug] [MainThread]: Parsing macros\supporting\prefix.sql
[0m09:16:22.969038 [debug] [MainThread]: Parsing macros\tables\bigquery\bridge.sql
[0m09:16:22.969038 [debug] [MainThread]: Parsing macros\tables\bigquery\eff_sat.sql
[0m09:16:23.000312 [debug] [MainThread]: Parsing macros\tables\bigquery\hub.sql
[0m09:16:23.015943 [debug] [MainThread]: Parsing macros\tables\bigquery\link.sql
[0m09:16:23.031572 [debug] [MainThread]: Parsing macros\tables\bigquery\ma_sat.sql
[0m09:16:23.047201 [debug] [MainThread]: Parsing macros\tables\bigquery\pit.sql
[0m09:16:23.078460 [debug] [MainThread]: Parsing macros\tables\bigquery\sat.sql
[0m09:16:23.078460 [debug] [MainThread]: Parsing macros\tables\bigquery\t_link.sql
[0m09:16:23.094093 [debug] [MainThread]: Parsing macros\tables\bigquery\xts.sql
[0m09:16:23.094093 [debug] [MainThread]: Parsing macros\tables\databricks\hub.sql
[0m09:16:23.094093 [debug] [MainThread]: Parsing macros\tables\databricks\link.sql
[0m09:16:23.094093 [debug] [MainThread]: Parsing macros\tables\databricks\sat.sql
[0m09:16:23.094093 [debug] [MainThread]: Parsing macros\tables\postgres\hub.sql
[0m09:16:23.109719 [debug] [MainThread]: Parsing macros\tables\postgres\link.sql
[0m09:16:23.125342 [debug] [MainThread]: Parsing macros\tables\postgres\sat.sql
[0m09:16:23.140972 [debug] [MainThread]: Parsing macros\tables\snowflake\bridge.sql
[0m09:16:23.156587 [debug] [MainThread]: Parsing macros\tables\snowflake\eff_sat.sql
[0m09:16:23.203474 [debug] [MainThread]: Parsing macros\tables\snowflake\hub.sql
[0m09:16:23.219128 [debug] [MainThread]: Parsing macros\tables\snowflake\link.sql
[0m09:16:23.250385 [debug] [MainThread]: Parsing macros\tables\snowflake\ma_sat.sql
[0m09:16:23.281627 [debug] [MainThread]: Parsing macros\tables\snowflake\pit.sql
[0m09:16:23.328517 [debug] [MainThread]: Parsing macros\tables\snowflake\sat.sql
[0m09:16:23.344147 [debug] [MainThread]: Parsing macros\tables\snowflake\t_link.sql
[0m09:16:23.359776 [debug] [MainThread]: Parsing macros\tables\snowflake\xts.sql
[0m09:16:23.391048 [debug] [MainThread]: Parsing macros\tables\sqlserver\bridge.sql
[0m09:16:23.391048 [debug] [MainThread]: Parsing macros\tables\sqlserver\eff_sat.sql
[0m09:16:23.422291 [debug] [MainThread]: Parsing macros\tables\sqlserver\hub.sql
[0m09:16:23.437948 [debug] [MainThread]: Parsing macros\tables\sqlserver\link.sql
[0m09:16:23.453577 [debug] [MainThread]: Parsing macros\tables\sqlserver\ma_sat.sql
[0m09:16:23.484840 [debug] [MainThread]: Parsing macros\tables\sqlserver\pit.sql
[0m09:16:23.484840 [debug] [MainThread]: Parsing macros\tables\sqlserver\sat.sql
[0m09:16:23.484840 [debug] [MainThread]: Parsing macros\tables\sqlserver\t_link.sql
[0m09:16:23.500473 [debug] [MainThread]: Parsing macros\tables\sqlserver\xts.sql
[0m09:16:23.500473 [debug] [MainThread]: Parsing macros\cross_db_utils\deprecated\xdb_deprecation_warning.sql
[0m09:16:23.500473 [debug] [MainThread]: Parsing macros\generic_tests\accepted_range.sql
[0m09:16:23.500473 [debug] [MainThread]: Parsing macros\generic_tests\at_least_one.sql
[0m09:16:23.516103 [debug] [MainThread]: Parsing macros\generic_tests\cardinality_equality.sql
[0m09:16:23.516103 [debug] [MainThread]: Parsing macros\generic_tests\equality.sql
[0m09:16:23.516103 [debug] [MainThread]: Parsing macros\generic_tests\equal_rowcount.sql
[0m09:16:23.531725 [debug] [MainThread]: Parsing macros\generic_tests\expression_is_true.sql
[0m09:16:23.531725 [debug] [MainThread]: Parsing macros\generic_tests\fewer_rows_than.sql
[0m09:16:23.531725 [debug] [MainThread]: Parsing macros\generic_tests\mutually_exclusive_ranges.sql
[0m09:16:23.547354 [debug] [MainThread]: Parsing macros\generic_tests\not_accepted_values.sql
[0m09:16:23.562983 [debug] [MainThread]: Parsing macros\generic_tests\not_constant.sql
[0m09:16:23.562983 [debug] [MainThread]: Parsing macros\generic_tests\not_empty_string.sql
[0m09:16:23.578590 [debug] [MainThread]: Parsing macros\generic_tests\not_null_proportion.sql
[0m09:16:23.578590 [debug] [MainThread]: Parsing macros\generic_tests\recency.sql
[0m09:16:23.578590 [debug] [MainThread]: Parsing macros\generic_tests\relationships_where.sql
[0m09:16:23.594244 [debug] [MainThread]: Parsing macros\generic_tests\sequential_values.sql
[0m09:16:23.594244 [debug] [MainThread]: Parsing macros\generic_tests\unique_combination_of_columns.sql
[0m09:16:23.594244 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m09:16:23.594244 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m09:16:23.609873 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m09:16:23.609873 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m09:16:23.609873 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_ephemeral.sql
[0m09:16:23.609873 [debug] [MainThread]: Parsing macros\jinja_helpers\_is_relation.sql
[0m09:16:23.609873 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m09:16:23.625493 [debug] [MainThread]: Parsing macros\sql\deduplicate.sql
[0m09:16:23.625493 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m09:16:23.625493 [debug] [MainThread]: Parsing macros\sql\generate_surrogate_key.sql
[0m09:16:23.641123 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m09:16:23.641123 [debug] [MainThread]: Parsing macros\sql\get_filtered_columns_in_relation.sql
[0m09:16:23.656740 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m09:16:23.656740 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m09:16:23.656740 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m09:16:23.672370 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m09:16:23.687996 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m09:16:23.687996 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m09:16:23.687996 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m09:16:23.687996 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m09:16:23.703625 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m09:16:23.703625 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m09:16:23.703625 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m09:16:23.719258 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m09:16:23.719258 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m09:16:23.719258 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m09:16:23.719258 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m09:16:23.750518 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m09:16:23.766147 [debug] [MainThread]: Parsing macros\sql\width_bucket.sql
[0m09:16:23.781773 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m09:16:23.781773 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m09:16:23.781773 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m09:16:24.938377 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customers_as_is.sql
[0m09:16:24.969640 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_history.sql
[0m09:16:24.969640 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_customer_orders_as_is.sql
[0m09:16:24.969640 [debug] [MainThread]: 1699: static parser successfully parsed consumption_layer\v_comp_orders_as_is.sql
[0m09:16:24.985282 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_customer_wealth_bracket.sql
[0m09:16:24.985282 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_customer.sql
[0m09:16:24.985282 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_UK_order.sql
[0m09:16:25.000915 [debug] [MainThread]: 1699: static parser successfully parsed raw_stage\v_raw_US_customer.sql
[0m09:16:25.000915 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer.sql
[0m09:16:25.204109 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer.sql
[0m09:16:25.204109 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m09:16:25.235373 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_customer_wealth_bracket.sql
[0m09:16:25.235373 [debug] [MainThread]: 1603: static parser failed on raw_vault\hubs\hub_order.sql
[0m09:16:25.266635 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\hubs\hub_order.sql
[0m09:16:25.282265 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_order.sql
[0m09:16:25.360394 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_order.sql
[0m09:16:25.360394 [debug] [MainThread]: 1603: static parser failed on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m09:16:25.391645 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\links\link_customer_wealth_bracket_customer.sql
[0m09:16:25.391645 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m09:16:25.501060 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_customer_wealth_bracket.sql
[0m09:16:25.501060 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_customer.sql
[0m09:16:25.547950 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_customer.sql
[0m09:16:25.563577 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_UK_order.sql
[0m09:16:25.594836 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_UK_order.sql
[0m09:16:25.610463 [debug] [MainThread]: 1603: static parser failed on raw_vault\sats\sat_US_customer.sql
[0m09:16:25.657349 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault\sats\sat_US_customer.sql
[0m09:16:25.657349 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_customer_wealth_bracket.sql
[0m09:16:25.876170 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_customer_wealth_bracket.sql
[0m09:16:25.891797 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_customer.sql
[0m09:16:26.001212 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_customer.sql
[0m09:16:26.001212 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_UK_order.sql
[0m09:16:26.063715 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_UK_order.sql
[0m09:16:26.063715 [debug] [MainThread]: 1603: static parser failed on stage\v_stg_US_customer.sql
[0m09:16:26.126256 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage\v_stg_US_customer.sql
[0m09:16:26.345070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FF86250>]}
[0m09:16:26.360700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E57005FBB0>]}
[0m09:16:26.360700 [info ] [MainThread]: Found 21 models, 0 tests, 0 snapshots, 0 analyses, 565 macros, 0 operations, 3 seed files, 4 sources, 0 exposures, 0 metrics
[0m09:16:26.360700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FC9D490>]}
[0m09:16:26.360700 [info ] [MainThread]: 
[0m09:16:26.360700 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:16:26.376312 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413"
[0m09:16:26.376312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:26.939003 [debug] [ThreadPool]: Acquiring new bigquery connection "list_steadfast-task-363413_data_vault"
[0m09:16:26.939003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:27.283522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FDD6E80>]}
[0m09:16:27.283522 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m09:16:27.283522 [info ] [MainThread]: 
[0m09:16:27.314088 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:16:27.314088 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:16:27.314088 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:16:27.314088 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:16:27.314088 [info ] [Thread-1  ]: 1 of 21 START view model data_vault.v_raw_UK_customer .......................... [RUN]
[0m09:16:27.314088 [info ] [Thread-2  ]: 2 of 21 START view model data_vault.v_raw_UK_order ............................. [RUN]
[0m09:16:27.314088 [info ] [Thread-4  ]: 3 of 21 START view model data_vault.v_raw_US_customer .......................... [RUN]
[0m09:16:27.314088 [info ] [Thread-5  ]: 4 of 21 START view model data_vault.v_raw_customer_wealth_bracket .............. [RUN]
[0m09:16:27.314088 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m09:16:27.314088 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:16:27.314088 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m09:16:27.314088 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:16:27.314088 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:16:27.314088 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m09:16:27.329718 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m09:16:27.329718 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m09:16:27.329718 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:16:27.329718 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:16:27.329718 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:16:27.345349 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:16:27.345349 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m09:16:27.345349 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:16:27.360977 [debug] [Thread-1  ]: finished collecting timing info
[0m09:16:27.345349 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m09:16:27.360977 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m09:16:27.360977 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:16:27.376611 [debug] [Thread-2  ]: finished collecting timing info
[0m09:16:27.376611 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:16:27.407871 [debug] [Thread-4  ]: finished collecting timing info
[0m09:16:27.454759 [debug] [Thread-5  ]: finished collecting timing info
[0m09:16:27.454759 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_customer"
[0m09:16:27.454759 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_UK_order"
[0m09:16:27.454759 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:16:27.454759 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:16:27.470398 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_US_customer"
[0m09:16:27.470398 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"
[0m09:16:27.486017 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:16:27.486017 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:16:27.486017 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_raw_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG,
c.TITLE,
c.WEALTH_BRACKET,
p.ID
from
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as c
left join
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as p
on p.id = c.wealth_bracket;


[0m09:16:27.486017 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_raw_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
  OPTIONS()
  as select distinct
c.ORDER_ID,
c.ORDER_NUMBER,
c.ORDER_PRICE,
c.CUSTOMER_ID,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.CRUD_FLAG,
p.CUSTOMER_NUMBER
from
    `steadfast-task-363413`.`staging`.`repl_UK_orders` as c
left join
    `steadfast-task-363413`.`staging`.`repl_UK_customers` as p
on p.customer_id = c.customer_id;


[0m09:16:27.486017 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m09:16:27.486017 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m09:16:27.486017 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_raw_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
  OPTIONS()
  as select distinct
c.CUSTOMER_ID,
c.CUSTOMER_NUMBER,
c.FIRST_NAME,
c.LAST_NAME,
c.LASTMODIFIEDDATE,
c.CREATEDDATE,
c.APPLIEDDATE,
c.CRUD_FLAG
from
    `steadfast-task-363413`.`staging`.`repl_US_customers` as c;


[0m09:16:27.486017 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
  OPTIONS()
  as select distinct
c.ID,
c.NAME,
c.DESCRIPTION,
c.LASTMODIFIEDDATE,
c.CREATEDDATE
from
    `steadfast-task-363413`.`staging`.`repl_customer_wealth_brackets` as c;


[0m09:16:28.439452 [debug] [Thread-2  ]: finished collecting timing info
[0m09:16:28.439452 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FDCB520>]}
[0m09:16:28.439452 [info ] [Thread-2  ]: 2 of 21 OK created view model data_vault.v_raw_UK_order ........................ [[32mOK[0m in 1.13s]
[0m09:16:28.439452 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_order
[0m09:16:28.439452 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:16:28.439452 [info ] [Thread-7  ]: 5 of 21 START view model data_vault.v_stg_UK_order ............................. [RUN]
[0m09:16:28.439452 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m09:16:28.439452 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:16:28.439452 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:16:28.455067 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m09:16:28.596428 [debug] [Thread-1  ]: finished collecting timing info
[0m09:16:28.596428 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FDCB700>]}
[0m09:16:28.596428 [info ] [Thread-1  ]: 1 of 21 OK created view model data_vault.v_raw_UK_customer ..................... [[32mOK[0m in 1.28s]
[0m09:16:28.596428 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_UK_customer
[0m09:16:28.596428 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:16:28.596428 [info ] [Thread-3  ]: 6 of 21 START view model data_vault.v_stg_UK_customer .......................... [RUN]
[0m09:16:28.611352 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m09:16:28.611352 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:16:28.611352 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:16:28.627001 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:16:28.689501 [debug] [Thread-4  ]: finished collecting timing info
[0m09:16:28.689501 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FE29D30>]}
[0m09:16:28.689501 [info ] [Thread-4  ]: 3 of 21 OK created view model data_vault.v_raw_US_customer ..................... [[32mOK[0m in 1.38s]
[0m09:16:28.689501 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_US_customer
[0m09:16:28.689501 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:16:28.705131 [info ] [Thread-2  ]: 7 of 21 START view model data_vault.v_stg_US_customer .......................... [RUN]
[0m09:16:28.705131 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m09:16:28.705131 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:16:28.705131 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:16:28.720757 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:16:28.736388 [debug] [Thread-5  ]: finished collecting timing info
[0m09:16:28.736388 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FE29CA0>]}
[0m09:16:28.736388 [info ] [Thread-5  ]: 4 of 21 OK created view model data_vault.v_raw_customer_wealth_bracket ......... [[32mOK[0m in 1.41s]
[0m09:16:28.736388 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_raw_customer_wealth_bracket
[0m09:16:28.736388 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:16:28.736388 [info ] [Thread-1  ]: 8 of 21 START view model data_vault.v_stg_customer_wealth_bracket .............. [RUN]
[0m09:16:28.736388 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m09:16:28.736388 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:16:28.736388 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:16:28.752048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:16:29.424098 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m09:16:29.455356 [debug] [Thread-7  ]: finished collecting timing info
[0m09:16:29.455356 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:16:29.470985 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_order"
[0m09:16:29.470985 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.v_stg_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_order"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_order`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_order`
),

derived_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    ORDER_NUMBER AS `ORDER_KEY`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    '2' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), '')))) AS STRING) AS `ORDER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_ORDER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ORDER_PRICE` AS STRING))), ''), '^^')
    )))) AS `ORDER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ORDER_ID`,
    `ORDER_NUMBER`,
    `ORDER_PRICE`,
    `CUSTOMER_ID`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CRUD_FLAG`,
    `CUSTOMER_NUMBER`,
    `ORDER_KEY`,
    `UK_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `ORDER_HK`,
    `CUSTOMER_HK`,
    `CUSTOMER_ORDER_HK`,
    `ORDER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08.36.0000000' AS LOAD_DATE
FROM staging;


[0m09:16:29.674173 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m09:16:29.674173 [debug] [Thread-1  ]: finished collecting timing info
[0m09:16:29.689802 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:16:29.689802 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"
[0m09:16:29.705432 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_customer_wealth_bracket`
),

derived_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '3' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`DESCRIPTION` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`NAME` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `ID`,
    `NAME`,
    `DESCRIPTION`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08.36.0000000' AS LOAD_DATE
FROM staging;


[0m09:16:29.971138 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m09:16:29.986770 [debug] [Thread-3  ]: finished collecting timing info
[0m09:16:29.986770 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:16:29.986770 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_UK_customer"
[0m09:16:30.002397 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.v_stg_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_UK_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_UK_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    CUSTOMER_NUMBER AS `UK_CUSTOMER_KEY`,
    ID AS `CUSTOMER_WEALTH_BRACKET_KEY`,
    '1' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_WEALTH_BRACKET_HK`,
    UPPER(TO_HEX(SHA256(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`UK_CUSTOMER_KEY` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_WEALTH_BRACKET_KEY` AS STRING))), ''), '^^')
    ), '^^||^^')))) AS `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`TITLE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`WEALTH_BRACKET` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `TITLE`,
    `WEALTH_BRACKET`,
    `ID`,
    `UK_CUSTOMER_KEY`,
    `CUSTOMER_WEALTH_BRACKET_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_WEALTH_BRACKET_HK`,
    `CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08.36.0000000' AS LOAD_DATE
FROM staging;


[0m09:16:30.002397 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m09:16:30.002397 [debug] [Thread-2  ]: finished collecting timing info
[0m09:16:30.002397 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:16:30.018027 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_stg_US_customer"
[0m09:16:30.018027 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_stg_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_stg_US_customer"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_stg_US_customer`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by dbtvault.

    

WITH source_data AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`

    FROM `steadfast-task-363413`.`data_vault`.`v_raw_US_customer`
),

derived_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    CUSTOMER_NUMBER AS `US_CUSTOMER_KEY`,
    '101' AS `RECORD_SOURCE`,
    LASTMODIFIEDDATE AS `EFFECTIVE_FROM`

    FROM source_data
),

hashed_columns AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,

    CAST(UPPER(TO_HEX(SHA256(NULLIF(UPPER(TRIM(CAST(`US_CUSTOMER_KEY` AS STRING))), '')))) AS STRING) AS `CUSTOMER_HK`,
    UPPER(TO_HEX(SHA256(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(`APPLIEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CREATEDDATE` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CRUD_FLAG` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_ID` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`CUSTOMER_NUMBER` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`FIRST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LAST_NAME` AS STRING))), ''), '^^'),'||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(`LASTMODIFIEDDATE` AS STRING))), ''), '^^')
    )))) AS `CUSTOMER_HASHDIFF`

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    `CUSTOMER_ID`,
    `CUSTOMER_NUMBER`,
    `FIRST_NAME`,
    `LAST_NAME`,
    `LASTMODIFIEDDATE`,
    `CREATEDDATE`,
    `APPLIEDDATE`,
    `CRUD_FLAG`,
    `US_CUSTOMER_KEY`,
    `RECORD_SOURCE`,
    `EFFECTIVE_FROM`,
    `CUSTOMER_HK`,
    `CUSTOMER_HASHDIFF`

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       '2009-11-05 08.36.0000000' AS LOAD_DATE
FROM staging;


[0m09:16:30.292385 [debug] [Thread-7  ]: finished collecting timing info
[0m09:16:30.292385 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5711DF0A0>]}
[0m09:16:30.292385 [info ] [Thread-7  ]: 5 of 21 OK created view model data_vault.v_stg_UK_order ........................ [[32mOK[0m in 1.85s]
[0m09:16:30.292385 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_order
[0m09:16:30.292385 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.hub_order
[0m09:16:30.292385 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.link_customer_order
[0m09:16:30.292385 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_order
[0m09:16:30.292385 [info ] [Thread-4  ]: 9 of 21 START incremental model data_vault.hub_order ........................... [RUN]
[0m09:16:30.292385 [info ] [Thread-8  ]: 10 of 21 START incremental model data_vault.link_customer_order ................ [RUN]
[0m09:16:30.292385 [info ] [Thread-5  ]: 11 of 21 START incremental model data_vault.sat_UK_order ....................... [RUN]
[0m09:16:30.308030 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_order"
[0m09:16:30.308030 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.hub_order
[0m09:16:30.308030 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_order"
[0m09:16:30.308030 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.hub_order
[0m09:16:30.308030 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_order
[0m09:16:30.308030 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_order"
[0m09:16:30.339271 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.link_customer_order
[0m09:16:30.339271 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_order
[0m09:16:30.370532 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_order
[0m09:16:30.401796 [info ] [Thread-4  ]: 09:16:30 + Loading steadfast-task-363413.data_vault.hub_order from 1 source(s)
[0m09:16:30.448679 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m09:16:30.464311 [debug] [Thread-4  ]: finished collecting timing info
[0m09:16:30.464311 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.hub_order
[0m09:16:30.542475 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:16:30.542475 [info ] [Thread-8  ]: 09:16:30 + Loading steadfast-task-363413.data_vault.link_customer_order from 1 source(s)
[0m09:16:30.558096 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m09:16:30.573732 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_order"
[0m09:16:30.573732 [debug] [Thread-8  ]: finished collecting timing info
[0m09:16:30.573732 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_order
[0m09:16:30.589345 [debug] [Thread-8  ]: Opening a new connection, currently in state init
[0m09:16:30.589345 [debug] [Thread-5  ]: finished collecting timing info
[0m09:16:30.589345 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_order
[0m09:16:30.604977 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m09:16:30.636235 [debug] [Thread-1  ]: finished collecting timing info
[0m09:16:30.636235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5700E4820>]}
[0m09:16:30.636235 [info ] [Thread-1  ]: 8 of 21 OK created view model data_vault.v_stg_customer_wealth_bracket ......... [[32mOK[0m in 1.90s]
[0m09:16:30.651865 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_customer_wealth_bracket
[0m09:16:30.651865 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m09:16:30.651865 [debug] [Thread-6  ]: Began running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m09:16:30.651865 [info ] [Thread-7  ]: 12 of 21 START incremental model data_vault.hub_customer_wealth_bracket ........ [RUN]
[0m09:16:30.651865 [info ] [Thread-6  ]: 13 of 21 START incremental model data_vault.sat_customer_wealth_bracket ........ [RUN]
[0m09:16:30.651865 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m09:16:30.651865 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m09:16:30.651865 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m09:16:30.667496 [debug] [Thread-6  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m09:16:30.683124 [debug] [Thread-6  ]: Began compiling node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m09:16:30.683124 [debug] [Thread-6  ]: Compiling model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m09:16:30.808167 [info ] [Thread-7  ]: 09:16:30 + Loading steadfast-task-363413.data_vault.hub_customer_wealth_bracket from 1 source(s)
[0m09:16:30.823793 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m09:16:30.855052 [debug] [Thread-7  ]: finished collecting timing info
[0m09:16:30.855052 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m09:16:30.870796 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m09:16:30.917575 [debug] [Thread-6  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m09:16:30.948845 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_order"
[0m09:16:30.948845 [debug] [Thread-6  ]: finished collecting timing info
[0m09:16:30.948845 [debug] [Thread-6  ]: Began executing node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m09:16:30.964476 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m09:16:30.964476 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.hub_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`ORDER_HK`, rr.`ORDER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS rr
    WHERE rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`ORDER_HK`, a.`ORDER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_order` AS d
    ON a.`ORDER_HK` = d.`ORDER_HK`
    WHERE d.`ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m09:16:31.011355 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_order"
[0m09:16:31.011355 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.sat_UK_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_UK_order` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`ORDER_ID`, a.`ORDER_PRICE`, a.`CUSTOMER_ID`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS a
    WHERE a.`ORDER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`ORDER_HK`, a.`ORDER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`ORDER_HK`, current_records.`ORDER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`ORDER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_UK_order` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`ORDER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`ORDER_HK` = source_records.`ORDER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`ORDER_HK`, stage.`ORDER_HASHDIFF`, stage.`ORDER_ID`, stage.`ORDER_PRICE`, stage.`CUSTOMER_ID`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`ORDER_HK` = stage.`ORDER_HK`
        AND latest_records.`ORDER_HASHDIFF` = stage.`ORDER_HASHDIFF`
    WHERE latest_records.`ORDER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`ORDER_HK`, `ORDER_HASHDIFF`, `ORDER_ID`, `ORDER_PRICE`, `CUSTOMER_ID`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`ORDER_HK`, `ORDER_HASHDIFF`, `ORDER_ID`, `ORDER_PRICE`, `CUSTOMER_ID`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m09:16:31.073870 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_order"
[0m09:16:31.089499 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.link_customer_order: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_order"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_order` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_ORDER_HK`, rr.`CUSTOMER_HK`, rr.`ORDER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_ORDER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_order` AS rr
    WHERE rr.`CUSTOMER_ORDER_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    AND rr.`ORDER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_ORDER_HK`, a.`CUSTOMER_HK`, a.`ORDER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_order` AS d
    ON a.`CUSTOMER_ORDER_HK` = d.`CUSTOMER_ORDER_HK`
    WHERE d.`CUSTOMER_ORDER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_ORDER_HK`, `CUSTOMER_HK`, `ORDER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m09:16:31.152036 [debug] [Thread-3  ]: finished collecting timing info
[0m09:16:31.152036 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5712B8760>]}
[0m09:16:31.152036 [info ] [Thread-3  ]: 6 of 21 OK created view model data_vault.v_stg_UK_customer ..................... [[32mOK[0m in 2.54s]
[0m09:16:31.152036 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_UK_customer
[0m09:16:31.152036 [debug] [Thread-1  ]: Began running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m09:16:31.152036 [debug] [Thread-3  ]: Began running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m09:16:31.152036 [info ] [Thread-1  ]: 14 of 21 START incremental model data_vault.link_customer_wealth_bracket_customer  [RUN]
[0m09:16:31.152036 [info ] [Thread-3  ]: 15 of 21 START incremental model data_vault.sat_UK_customer .................... [RUN]
[0m09:16:31.167646 [debug] [Thread-1  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m09:16:31.167646 [debug] [Thread-1  ]: Began compiling node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m09:16:31.167646 [debug] [Thread-3  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m09:16:31.167646 [debug] [Thread-1  ]: Compiling model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m09:16:31.167646 [debug] [Thread-3  ]: Began compiling node model.dbtvault_bigquery_demo.sat_UK_customer
[0m09:16:31.183308 [debug] [Thread-3  ]: Compiling model.dbtvault_bigquery_demo.sat_UK_customer
[0m09:16:31.230167 [info ] [Thread-1  ]: 09:16:31 + Loading steadfast-task-363413.data_vault.link_customer_wealth_bracket_customer from 1 source(s)
[0m09:16:31.261448 [debug] [Thread-2  ]: finished collecting timing info
[0m09:16:31.261448 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5711E45B0>]}
[0m09:16:31.261448 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m09:16:31.261448 [info ] [Thread-2  ]: 7 of 21 OK created view model data_vault.v_stg_US_customer ..................... [[32mOK[0m in 2.56s]
[0m09:16:31.277058 [debug] [Thread-1  ]: finished collecting timing info
[0m09:16:31.277058 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"
[0m09:16:31.277058 [debug] [Thread-1  ]: Began executing node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m09:16:31.292685 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_stg_US_customer
[0m09:16:31.308314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:16:31.339578 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.hub_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`ID`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`ID`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer_wealth_bracket` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_HK` = d.`CUSTOMER_WEALTH_BRACKET_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `ID`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m09:16:31.339578 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.hub_customer
[0m09:16:31.370835 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m09:16:31.370835 [info ] [Thread-2  ]: 16 of 21 START incremental model data_vault.hub_customer ....................... [RUN]
[0m09:16:31.370835 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.hub_customer"
[0m09:16:31.386463 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.hub_customer
[0m09:16:31.386463 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.hub_customer
[0m09:16:31.386463 [debug] [Thread-3  ]: finished collecting timing info
[0m09:16:31.402092 [debug] [Thread-6  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"
[0m09:16:31.402092 [debug] [Thread-3  ]: Began executing node model.dbtvault_bigquery_demo.sat_UK_customer
[0m09:16:31.417744 [info ] [Thread-2  ]: 09:16:31 + Loading steadfast-task-363413.data_vault.hub_customer from 2 source(s)
[0m09:16:31.433377 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m09:16:31.433377 [debug] [Thread-6  ]: On model.dbtvault_bigquery_demo.sat_customer_wealth_bracket: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_customer_wealth_bracket"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`NAME`, a.`DESCRIPTION`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_customer_wealth_bracket` AS a
    WHERE a.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_WEALTH_BRACKET_HK`, current_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_WEALTH_BRACKET_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_customer_wealth_bracket` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_WEALTH_BRACKET_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_WEALTH_BRACKET_HK` = source_records.`CUSTOMER_WEALTH_BRACKET_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_WEALTH_BRACKET_HK`, stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`, stage.`NAME`, stage.`DESCRIPTION`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_WEALTH_BRACKET_HK` = stage.`CUSTOMER_WEALTH_BRACKET_HK`
        AND latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` = stage.`CUSTOMER_WEALTH_BRACKET_HASHDIFF`
    WHERE latest_records.`CUSTOMER_WEALTH_BRACKET_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_WEALTH_BRACKET_HASHDIFF`, `NAME`, `DESCRIPTION`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m09:16:31.464613 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m09:16:31.464613 [debug] [Thread-2  ]: finished collecting timing info
[0m09:16:31.464613 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.hub_customer
[0m09:16:31.480240 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:16:31.792859 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"
[0m09:16:31.792859 [debug] [Thread-1  ]: On model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` as DBT_INTERNAL_DEST
        using (
          

    -- Generated by dbtvault.

    

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, rr.`CUSTOMER_WEALTH_BRACKET_HK`, rr.`CUSTOMER_HK`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
        ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
        ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NOT NULL
    AND rr.`CUSTOMER_WEALTH_BRACKET_HK` IS NOT NULL
    AND rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
    ),


records_to_insert AS (
    SELECT a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, a.`CUSTOMER_WEALTH_BRACKET_HK`, a.`CUSTOMER_HK`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_1 AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`link_customer_wealth_bracket_customer` AS d
    ON a.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` = d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`
    WHERE d.`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_WEALTH_BRACKET_CUSTOMER_HK`, `CUSTOMER_WEALTH_BRACKET_HK`, `CUSTOMER_HK`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m09:16:31.824121 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.hub_customer"
[0m09:16:31.839723 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.hub_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.hub_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`hub_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.`CUSTOMER_HK`, rr.`CUSTOMER_NUMBER`, rr.`LOAD_DATE`, rr.`RECORD_SOURCE`,
           ROW_NUMBER() OVER(
               PARTITION BY rr.`CUSTOMER_HK`
               ORDER BY rr.`LOAD_DATE`
           ) AS row_number
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS rr
    WHERE rr.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.`CUSTOMER_HK`
               ORDER BY ru.`LOAD_DATE`, ru.`RECORD_SOURCE` ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.`CUSTOMER_HK` IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_NUMBER`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM row_rank_union AS a
    LEFT JOIN `steadfast-task-363413`.`data_vault`.`hub_customer` AS d
    ON a.`CUSTOMER_HK` = d.`CUSTOMER_HK`
    WHERE d.`CUSTOMER_HK` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_NUMBER`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m09:16:31.839723 [debug] [Thread-3  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_UK_customer"
[0m09:16:31.855355 [debug] [Thread-3  ]: On model.dbtvault_bigquery_demo.sat_UK_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_UK_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_UK_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`TITLE`, a.`WEALTH_BRACKET`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_UK_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_UK_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`TITLE`, stage.`WEALTH_BRACKET`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `TITLE`, `WEALTH_BRACKET`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m09:16:34.340486 [debug] [Thread-7  ]: finished collecting timing info
[0m09:16:34.340486 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5711EE4F0>]}
[0m09:16:34.340486 [info ] [Thread-7  ]: 12 of 21 OK created incremental model data_vault.hub_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 870.0 Bytes processed)[0m in 3.69s]
[0m09:16:34.356115 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer_wealth_bracket
[0m09:16:34.356115 [debug] [Thread-7  ]: Began running node model.dbtvault_bigquery_demo.sat_US_customer
[0m09:16:34.356115 [info ] [Thread-7  ]: 17 of 21 START incremental model data_vault.sat_US_customer .................... [RUN]
[0m09:16:34.356115 [debug] [Thread-7  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.sat_US_customer"
[0m09:16:34.356115 [debug] [Thread-7  ]: Began compiling node model.dbtvault_bigquery_demo.sat_US_customer
[0m09:16:34.356115 [debug] [Thread-7  ]: Compiling model.dbtvault_bigquery_demo.sat_US_customer
[0m09:16:34.371745 [debug] [Thread-4  ]: finished collecting timing info
[0m09:16:34.387456 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5712DCFD0>]}
[0m09:16:34.387456 [info ] [Thread-4  ]: 9 of 21 OK created incremental model data_vault.hub_order ...................... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 4.08s]
[0m09:16:34.403006 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.hub_order
[0m09:16:34.465522 [debug] [Thread-7  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m09:16:34.465522 [debug] [Thread-8  ]: finished collecting timing info
[0m09:16:34.481336 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E571321F10>]}
[0m09:16:34.481336 [info ] [Thread-8  ]: 10 of 21 OK created incremental model data_vault.link_customer_order ........... [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 4.16s]
[0m09:16:34.481336 [debug] [Thread-7  ]: finished collecting timing info
[0m09:16:34.481336 [debug] [Thread-7  ]: Began executing node model.dbtvault_bigquery_demo.sat_US_customer
[0m09:16:34.496763 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
[0m09:16:34.496763 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_order
[0m09:16:34.606169 [debug] [Thread-5  ]: finished collecting timing info
[0m09:16:34.606169 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E571259610>]}
[0m09:16:34.606169 [info ] [Thread-5  ]: 11 of 21 OK created incremental model data_vault.sat_UK_order .................. [[32mMERGE (0.0 rows, 252.0 Bytes processed)[0m in 4.30s]
[0m09:16:34.606169 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_order
[0m09:16:34.606169 [debug] [Thread-4  ]: Began running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m09:16:34.606169 [info ] [Thread-4  ]: 18 of 21 START view model data_vault.v_comp_orders_as_is ....................... [RUN]
[0m09:16:34.606169 [debug] [Thread-4  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m09:16:34.606169 [debug] [Thread-4  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m09:16:34.621797 [debug] [Thread-4  ]: Compiling model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m09:16:34.621797 [debug] [Thread-4  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m09:16:34.621797 [debug] [Thread-4  ]: finished collecting timing info
[0m09:16:34.637425 [debug] [Thread-4  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m09:16:34.637425 [debug] [Thread-4  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_orders_as_is"
[0m09:16:34.653055 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m09:16:34.653055 [debug] [Thread-4  ]: On model.dbtvault_bigquery_demo.v_comp_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`
  OPTIONS()
  as with
    h as
        (select order_hk, order_number, record_source from `steadfast-task-363413`.`data_vault`.`hub_order`),
    s as
        (select order_hk, order_id, order_price, lastmodifieddate, createddate, effective_from, load_date,
         crud_flag, row_number() over(partition by order_hk order by lastmodifieddate desc) as rn
         from `steadfast-task-363413`.`data_vault`.`sat_UK_order`),
    co as
        (select order_hk, customer_hk from `steadfast-task-363413`.`data_vault`.`link_customer_order` ),
    joined as
        (select h.order_hk, h.order_number,
            co.customer_hk,
            s.order_id, s.order_price, s.lastmodifieddate, s.createddate, h.record_source, s.effective_from,
            s.load_date, s.crud_flag, s.rn
         from h, s, co
        where s.order_hk = h.order_hk
        and co.order_hk = h.order_hk)
select order_hk, customer_hk, order_id, order_number, order_price, lastmodifieddate, createddate,
effective_from, load_date
from joined
where rn = 1 and crud_flag <> 'D';


[0m09:16:34.887719 [debug] [Thread-7  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.sat_US_customer"
[0m09:16:34.887719 [debug] [Thread-7  ]: On model.dbtvault_bigquery_demo.sat_US_customer: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.sat_US_customer"} */

        
    

    

    merge into `steadfast-task-363413`.`data_vault`.`sat_US_customer` as DBT_INTERNAL_DEST
        using (
          -- Generated by dbtvault.

    

WITH source_data AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`CUSTOMER_ID`, a.`FIRST_NAME`, a.`LAST_NAME`, a.`LASTMODIFIEDDATE`, a.`CREATEDDATE`, a.`APPLIEDDATE`, a.`CRUD_FLAG`, a.`EFFECTIVE_FROM`, a.`LOAD_DATE`, a.`RECORD_SOURCE`
    FROM `steadfast-task-363413`.`data_vault`.`v_stg_US_customer` AS a
    WHERE a.`CUSTOMER_HK` IS NOT NULL
),



latest_records AS (
    SELECT a.`CUSTOMER_HK`, a.`CUSTOMER_HASHDIFF`, a.`LOAD_DATE`
    FROM (
        SELECT current_records.`CUSTOMER_HK`, current_records.`CUSTOMER_HASHDIFF`, current_records.`LOAD_DATE`,
            RANK() OVER (
               PARTITION BY current_records.`CUSTOMER_HK`
               ORDER BY current_records.`LOAD_DATE` DESC
            ) AS rank
        FROM `steadfast-task-363413`.`data_vault`.`sat_US_customer` AS current_records
            JOIN (
                SELECT DISTINCT source_data.`CUSTOMER_HK`
                FROM source_data
            ) AS source_records
                ON current_records.`CUSTOMER_HK` = source_records.`CUSTOMER_HK`
    ) AS a
    WHERE a.rank = 1
),records_to_insert AS (
    SELECT DISTINCT stage.`CUSTOMER_HK`, stage.`CUSTOMER_HASHDIFF`, stage.`CUSTOMER_ID`, stage.`FIRST_NAME`, stage.`LAST_NAME`, stage.`LASTMODIFIEDDATE`, stage.`CREATEDDATE`, stage.`APPLIEDDATE`, stage.`CRUD_FLAG`, stage.`EFFECTIVE_FROM`, stage.`LOAD_DATE`, stage.`RECORD_SOURCE`
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.`CUSTOMER_HK` = stage.`CUSTOMER_HK`
        AND latest_records.`CUSTOMER_HASHDIFF` = stage.`CUSTOMER_HASHDIFF`
    WHERE latest_records.`CUSTOMER_HASHDIFF` IS NULL
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on FALSE

    

    when not matched then insert
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`CUSTOMER_HK`, `CUSTOMER_HASHDIFF`, `CUSTOMER_ID`, `FIRST_NAME`, `LAST_NAME`, `LASTMODIFIEDDATE`, `CREATEDDATE`, `APPLIEDDATE`, `CRUD_FLAG`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


  
[0m09:16:34.981278 [debug] [Thread-1  ]: finished collecting timing info
[0m09:16:34.981278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5711F2220>]}
[0m09:16:34.981278 [info ] [Thread-1  ]: 14 of 21 OK created incremental model data_vault.link_customer_wealth_bracket_customer  [[32mMERGE (0.0 rows, 1018.0 Bytes processed)[0m in 3.83s]
[0m09:16:34.981278 [debug] [Thread-1  ]: Finished running node model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer
[0m09:16:35.309532 [debug] [Thread-2  ]: finished collecting timing info
[0m09:16:35.309532 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FFA7850>]}
[0m09:16:35.309532 [info ] [Thread-2  ]: 16 of 21 OK created incremental model data_vault.hub_customer .................. [[32mMERGE (0.0 rows, 1015.0 Bytes processed)[0m in 3.94s]
[0m09:16:35.309532 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.hub_customer
[0m09:16:35.325152 [debug] [Thread-6  ]: finished collecting timing info
[0m09:16:35.325152 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E571317D00>]}
[0m09:16:35.325152 [info ] [Thread-6  ]: 13 of 21 OK created incremental model data_vault.sat_customer_wealth_bracket ... [[32mMERGE (0.0 rows, 1.3 KB processed)[0m in 4.66s]
[0m09:16:35.325152 [debug] [Thread-6  ]: Finished running node model.dbtvault_bigquery_demo.sat_customer_wealth_bracket
[0m09:16:35.575764 [debug] [Thread-3  ]: finished collecting timing info
[0m09:16:35.575764 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5711F5FD0>]}
[0m09:16:35.575764 [info ] [Thread-3  ]: 15 of 21 OK created incremental model data_vault.sat_UK_customer ............... [[32mMERGE (0.0 rows, 2.6 KB processed)[0m in 4.41s]
[0m09:16:35.590836 [debug] [Thread-3  ]: Finished running node model.dbtvault_bigquery_demo.sat_UK_customer
[0m09:16:35.965965 [debug] [Thread-4  ]: finished collecting timing info
[0m09:16:35.965965 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E571331A60>]}
[0m09:16:35.965965 [info ] [Thread-4  ]: 18 of 21 OK created view model data_vault.v_comp_orders_as_is .................. [[32mOK[0m in 1.36s]
[0m09:16:35.965965 [debug] [Thread-4  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_orders_as_is
[0m09:16:38.795591 [debug] [Thread-7  ]: finished collecting timing info
[0m09:16:38.810565 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5700801F0>]}
[0m09:16:38.810565 [info ] [Thread-7  ]: 17 of 21 OK created incremental model data_vault.sat_US_customer ............... [[32mMERGE (0.0 rows, 220.0 Bytes processed)[0m in 4.45s]
[0m09:16:38.810565 [debug] [Thread-7  ]: Finished running node model.dbtvault_bigquery_demo.sat_US_customer
[0m09:16:38.810565 [debug] [Thread-5  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m09:16:38.810565 [debug] [Thread-8  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m09:16:38.810565 [info ] [Thread-5  ]: 19 of 21 START view model data_vault.v_comp_customer_history ................... [RUN]
[0m09:16:38.810565 [info ] [Thread-8  ]: 20 of 21 START view model data_vault.v_comp_customers_as_is .................... [RUN]
[0m09:16:38.810565 [debug] [Thread-5  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m09:16:38.810565 [debug] [Thread-5  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m09:16:38.810565 [debug] [Thread-8  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m09:16:38.810565 [debug] [Thread-5  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_history
[0m09:16:38.810565 [debug] [Thread-8  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m09:16:38.826195 [debug] [Thread-5  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m09:16:38.826195 [debug] [Thread-8  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m09:16:38.841799 [debug] [Thread-8  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m09:16:38.841799 [debug] [Thread-5  ]: finished collecting timing info
[0m09:16:38.841799 [debug] [Thread-5  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m09:16:38.841799 [debug] [Thread-5  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_history"
[0m09:16:38.841799 [debug] [Thread-8  ]: finished collecting timing info
[0m09:16:38.841799 [debug] [Thread-8  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m09:16:38.857431 [debug] [Thread-8  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customers_as_is"
[0m09:16:38.857431 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
[0m09:16:38.857431 [debug] [Thread-5  ]: On model.dbtvault_bigquery_demo.v_comp_customer_history: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_history"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_history`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.customer_id, s_uk.first_name,
        s_uk.last_name, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
        s_uk.effective_from, s_uk.crud_flag, s_uk.load_date
        from h, s_uk
        where s_uk.customer_hk = h.customer_hk
        union all
        select h.customer_hk, h.customer_number, s_us.customer_id, s_us.first_name,
        s_us.last_name, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
        s_us.effective_from, s_us.crud_flag, s_us.load_date
        from h, s_us
        where s_us.customer_hk = h.customer_hk)
select * from joined;


[0m09:16:38.873075 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
[0m09:16:38.873075 [debug] [Thread-8  ]: On model.dbtvault_bigquery_demo.v_comp_customers_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customers_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`
  OPTIONS()
  as with
    h as
        (select customer_hk, customer_number, record_source
        from `steadfast-task-363413`.`data_vault`.`hub_customer`),
    s_uk as
        (select customer_hk, customer_id, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_UK_customer`),
    s_us as
        (select customer_hk, customer_id, first_name, last_name, lastmodifieddate, createddate,
         applieddate, effective_from, crud_flag, load_date from `steadfast-task-363413`.`data_vault`.`sat_US_customer`),
    joined as
        (select h.customer_hk, h.customer_number, s_uk.crud_flag, s_uk.customer_id,
                s_uk.title, s_uk.first_name, s_uk.last_name, s_uk.wealth_bracket, s_uk.lastmodifieddate, s_uk.createddate, s_uk.applieddate,
                s_uk.effective_from, s_uk.load_date, h.record_source,
                row_number() over(partition by s_uk.customer_hk order by s_uk.applieddate desc) as rn
         from h, s_uk
         where s_uk.customer_hk = h.customer_hk
         union all
         select h.customer_hk, h.customer_number, s_us.crud_flag, s_us.customer_id,
                '' as title, s_us.first_name, s_us.last_name, null as wealth_bracket, s_us.lastmodifieddate, s_us.createddate, s_us.applieddate,
                s_us.effective_from, s_us.load_date, h.record_source,
                row_number() over(partition by s_us.customer_hk order by s_us.applieddate desc) as rn
         from h, s_us
         )
select customer_hk, customer_id, customer_number, title, first_name, last_name, wealth_bracket, lastmodifieddate, createddate, applieddate, effective_from, load_date, record_source from joined
where rn = 1 and crud_flag <> 'D';


[0m09:16:39.810829 [debug] [Thread-8  ]: finished collecting timing info
[0m09:16:39.810829 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E57131F0D0>]}
[0m09:16:39.810829 [info ] [Thread-8  ]: 20 of 21 OK created view model data_vault.v_comp_customers_as_is ............... [[32mOK[0m in 1.00s]
[0m09:16:39.810829 [debug] [Thread-8  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customers_as_is
[0m09:16:39.810829 [debug] [Thread-2  ]: Began running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m09:16:39.810829 [info ] [Thread-2  ]: 21 of 21 START view model data_vault.v_comp_customer_orders_as_is .............. [RUN]
[0m09:16:39.810829 [debug] [Thread-2  ]: Acquiring new bigquery connection "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m09:16:39.810829 [debug] [Thread-2  ]: Began compiling node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m09:16:39.810829 [debug] [Thread-2  ]: Compiling model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m09:16:39.826467 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m09:16:39.826467 [debug] [Thread-2  ]: finished collecting timing info
[0m09:16:39.826467 [debug] [Thread-2  ]: Began executing node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m09:16:39.842096 [debug] [Thread-2  ]: Writing runtime SQL for node "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"
[0m09:16:39.842096 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:16:39.842096 [debug] [Thread-2  ]: On model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is: /* {"app": "dbt", "dbt_version": "1.2.2", "profile_name": "dbtvault_bigquery_demo", "target_name": "dev", "node_id": "model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is"} */


  create or replace view `steadfast-task-363413`.`data_vault`.`v_comp_customer_orders_as_is`
  OPTIONS()
  as with
    c as
        (select customer_hk, customer_number, first_name, last_name
         from `steadfast-task-363413`.`data_vault`.`v_comp_customers_as_is`),
    o as
        (select customer_hk, order_number, order_price, createddate, lastmodifieddate
         from `steadfast-task-363413`.`data_vault`.`v_comp_orders_as_is`),
    joined as
        (select c.customer_number, c.first_name, c.last_name, o.order_number, o.order_price,
         o.createddate, o.lastmodifieddate
         from c, o
         where o.customer_hk = c.customer_hk)
select * from joined;


[0m09:16:40.107819 [debug] [Thread-5  ]: finished collecting timing info
[0m09:16:40.107819 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E57126B280>]}
[0m09:16:40.107819 [info ] [Thread-5  ]: 19 of 21 OK created view model data_vault.v_comp_customer_history .............. [[32mOK[0m in 1.30s]
[0m09:16:40.107819 [debug] [Thread-5  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_history
[0m09:16:41.029939 [debug] [Thread-2  ]: finished collecting timing info
[0m09:16:41.029939 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ecc229-02a3-4fd2-854a-09cd49318e83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FE29910>]}
[0m09:16:41.029939 [info ] [Thread-2  ]: 21 of 21 OK created view model data_vault.v_comp_customer_orders_as_is ......... [[32mOK[0m in 1.22s]
[0m09:16:41.029939 [debug] [Thread-2  ]: Finished running node model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is
[0m09:16:41.029939 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m09:16:41.029939 [info ] [MainThread]: 
[0m09:16:41.029939 [info ] [MainThread]: Finished running 12 view models, 9 incremental models in 0 hours 0 minutes and 14.67 seconds (14.67s).
[0m09:16:41.029939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:41.029939 [debug] [MainThread]: Connection 'list_steadfast-task-363413' was properly closed.
[0m09:16:41.029939 [debug] [MainThread]: Connection 'list_steadfast-task-363413_data_vault' was properly closed.
[0m09:16:41.029939 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.link_customer_wealth_bracket_customer' was properly closed.
[0m09:16:41.029939 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_orders_as_is' was properly closed.
[0m09:16:41.029939 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_orders_as_is' was properly closed.
[0m09:16:41.029939 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customer_history' was properly closed.
[0m09:16:41.029939 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_US_customer' was properly closed.
[0m09:16:41.045573 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_UK_customer' was properly closed.
[0m09:16:41.045573 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.v_comp_customers_as_is' was properly closed.
[0m09:16:41.045573 [debug] [MainThread]: Connection 'model.dbtvault_bigquery_demo.sat_customer_wealth_bracket' was properly closed.
[0m09:16:41.108091 [info ] [MainThread]: 
[0m09:16:41.108091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:16:41.108091 [info ] [MainThread]: 
[0m09:16:41.108091 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=0 SKIP=0 TOTAL=21
[0m09:16:41.108091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E571251BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E56FDD6EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E5700FAFA0>]}
[0m09:16:41.108091 [debug] [MainThread]: Flushing usage events
